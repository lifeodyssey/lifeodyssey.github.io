document.addEventListener("DOMContentLoaded",(()=>{const{indexName:e,appID:t,apiKey:a,hits:s}=CONFIG.algolia,n=window["algoliasearch/lite"].liteClient(t,a),r=document.querySelector(".search-input"),i=document.querySelector(".search-result-container"),c=e=>{const{title:t,excerpt:a,excerptStrip:s,contentStripTruncate:n}=e._highlightResult;let r=`<li><a href="${e.permalink}" class="search-result-title">${t.value}</a>`;const i=a?.value||s?.value||n?.value;if(i){const t=document.createElement("div");t.innerHTML=i,r+=`<a href="${e.permalink}"><p class="search-result">${t.textContent.substring(0,100)}...</p></a></li>`}return r};let l=!1,o=null;const u=async(t,a=0)=>{if(l)return void(o={searchText:t,page:a});l=!0;const r=Date.now(),d=(await n.search({requests:[{indexName:e,page:a,query:t,hitsPerPage:s.per_page||10,attributesToRetrieve:["permalink"],attributesToHighlight:["title","excerpt","excerptStrip","contentStripTruncate"],highlightPreTag:'<mark class="search-keyword">',highlightPostTag:"</mark>"}]})).results[0];if(0===d.nbHits)i.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>';else{const e=CONFIG.i18n.hits_time.replace("${hits}",d.nbHits).replace("${time}",Date.now()-r);let s="";if(d.nbPages>1){s+='<nav class="pagination algolia-pagination">';for(let e=0;e<d.nbPages;e++)s+=e===a?`<span class="page-number current">${e+1}</span>`:`<a class="page-number" href="#" data-index=${e}>${e+1}</a>`;s+="</nav>"}i.innerHTML=`<div class="search-stats">\n          <span>${e}</span>\n          <img src="${CONFIG.images}/logo-algolia-nebula-blue-full.svg" alt="Algolia">\n        </div>\n        <hr>\n        <ul class="search-result-list">${d.hits.map(c).join("")}</ul>\n        ${s}`,"object"==typeof pjax&&pjax.refresh(i),i.querySelectorAll(".page-number").forEach((e=>{e.addEventListener("click",(async a=>{a.preventDefault(),await u(t,Number(e.dataset.index))}))}))}if(l=!1,null!==o&&(o.searchText!==t||o.page!==a)){const{searchText:e,page:t}=o;o=null,u(e,t)}},d=NexT.utils.debounce((async()=>{const e=r.value.trim();""!==e?await u(e,0):i.innerHTML='<div class="search-result-icon"><i class="fab fa-algolia fa-5x"></i></div>'}),500);r.addEventListener("input",d),document.querySelectorAll(".popup-trigger").forEach((e=>{e.addEventListener("click",(()=>{NexT.utils.setGutter(),document.body.classList.add("search-active"),setTimeout((()=>r.focus()),500)}))}));const p=()=>{NexT.utils.setGutter("0"),document.body.classList.remove("search-active")};document.querySelector(".search-pop-overlay").addEventListener("click",(e=>{e.target===document.querySelector(".search-pop-overlay")&&p()})),document.querySelector(".popup-btn-close").addEventListener("click",p),document.addEventListener("pjax:success",p),window.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),NexT.utils.setGutter(),document.body.classList.add("search-active"),setTimeout((()=>r.focus()),500))})),window.addEventListener("keyup",(e=>{"Escape"===e.key&&p()}))}));
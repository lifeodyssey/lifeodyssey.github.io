<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color media="(prefers-color-scheme: light)"><meta content=#222 name=theme-color media="(prefers-color-scheme: dark)"><meta content="Hexo 8.0.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link href=/images/logo.svg rel=mask-icon color=#222><link href=/css/main.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet crossorigin=anonymous integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM="><link href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet crossorigin=anonymous integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE="><script class=next-config data-name=main type=application/json>{"hostname":"lifeodyssey.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.25.0","exturl":true,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"base16/tomorrow-night"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"max"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src=/js/config.js defer=defer></script><meta content=自己前几天一直在跟mask斗争，中文网站上也没什么好的资料，就索性自己整理一下。 name=description><meta content=article property=og:type><meta content=np.ma.mask property=og:title><meta content=https://lifeodyssey.github.io/posts/39e89397.html property=og:url><meta content=乔克叔叔的床边故事 property=og:site_name><meta content=自己前几天一直在跟mask斗争，中文网站上也没什么好的资料，就索性自己整理一下。 property=og:description><meta content=en_US property=og:locale><meta content=2020-11-10T02:08:30.000Z property=article:published_time><meta content=2025-09-30T10:12:48.222Z property=article:modified_time><meta content=周大侠 property=article:author><meta content=Research property=article:tag><meta content=python property=article:tag><meta content=summary name=twitter:card><link href=https://lifeodyssey.github.io/posts/39e89397.html rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://lifeodyssey.github.io/posts/39e89397.html","path":"posts/39e89397.html","title":"np.ma.mask"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>np.ma.mask | 乔克叔叔的床边故事</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-135697820-1" async></script><script class=next-config data-name=google_analytics type=application/json>{"tracking_id":"UA-135697820-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src=/js/third-party/analytics/google-analytics.js defer=defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js defer=defer crossorigin=anonymous integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY="></script><script src=/js/utils.js defer=defer></script><script src=/js/motion.js defer=defer></script><script src=/js/sidebar.js defer=defer></script><script src=/js/next-boot.js defer=defer></script><script src=/js/bookmark.js defer=defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js defer=defer crossorigin=anonymous integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg="></script><script src=/js/third-party/search/local-search.js defer=defer></script><script class=next-config data-name=pdf type=application/json>{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script><script src=/js/third-party/tags/pdf.js defer=defer></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":"forest","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script src=/js/third-party/tags/mermaid.js defer=defer></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src=/js/third-party/math/mathjax.js defer=defer></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><link href=/atom.xml rel=alternate type=application/atom+xml title=乔克叔叔的床边故事></head><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button aria-label="Toggle navigation bar"><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ rel=start class=brand><i class=logo-line></i><p class=site-title>乔克叔叔的床边故事</p><i class=logo-line></i></a></div><div class=site-nav-right><div class="toggle popup-trigger" role=button aria-label=Search><i class="fa fa-fw fa-search fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-fw fa-home"></i>Home</a></li><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-fw fa-user"></i>About</a></li><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-fw fa-tags"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-fw fa-th"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-fw fa-archive"></i>Archives</a></li><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-fw fa-search"></i>Search</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-5x fa-pulse fa-spinner"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents</li><li class=sidebar-nav-overview>Overview</li></ul><div class=sidebar-panel-container><div class="sidebar-panel post-toc-wrap"><div class="animated post-toc"><ol class=nav><li class="nav-item nav-level-1"><a href=#%E5%88%9B%E5%BB%BA class=nav-link><span class=nav-number>1.</span> <span class=nav-text>创建</span></a></li><li class="nav-item nav-level-1"><a href=#%E7%B4%A2%E5%BC%95 class=nav-link><span class=nav-number>2.</span> <span class=nav-text>索引</span></a></li><li class="nav-item nav-level-1"><a href=#%E5%8F%96%E6%B6%88 class=nav-link><span class=nav-number>3.</span> <span class=nav-text>取消</span></a></li><li class="nav-item nav-level-1"><a href=#%E5%8F%82%E8%80%83 class=nav-link><span class=nav-number>4.</span> <span class=nav-text>参考</span></a></li></ol></div></div><!--/noindex--><div class="sidebar-panel site-overview-wrap"><div class="animated site-author" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>周大侠</p><div class=site-description itemprop=description></div></div><div class="animated site-state-wrap"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>165</span> <span class=site-state-item-name>posts</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>17</span> <span class=site-state-item-name>categories</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>97</span> <span class=site-state-item-name>tags</span></a></div></nav></div><div class="animated links-of-author"><span class=links-of-author-item><span class=exturl data-url=aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5 title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lifeodyssey"><i class="fa-fw fab fa-github"></i>GitHub</span> </span><span class=links-of-author-item><span class=exturl data-url="bWFpbHRvOnpoZW5qaWF6aG91MDEyN0BnbWFpbC5jb20=" title="E-Mail → mailto:zhenjiazhou0127@gmail.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span> </span><span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL1poZW5qaWFfWmhvdQ==" title="Researchgate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Zhenjia_Zhou"><i class="fa fa-fw fa-researchgate"></i>Researchgate</span> </span><span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3poZW5qaWEtemhvdS8=" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;zhenjia-zhou&#x2F;"><i class="fa fa-fw fa-Linkedin"></i>Linkedin</span> </span><span class=links-of-author-item><a href=/atom.xml rel="noopener me" title="RSS → &#x2F;atom.xml"><i class="fa-fw rss"></i>RSS</a></span></div><div class="animated cc-license" itemprop=license><span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://lifeodyssey.github.io/posts/39e89397.html itemprop=mainEntityOfPage><span itemprop=author itemscope itemtype=http://schema.org/Person hidden><meta content=/images/avatar.gif itemprop=image><meta content=周大侠 itemprop=name></span><span itemprop=publisher itemscope itemtype=http://schema.org/Organization hidden><meta content=乔克叔叔的床边故事 itemprop=name><meta content="" itemprop=description></span><span itemprop=post itemscope itemtype=http://schema.org/CreativeWork hidden><meta content="np.ma.mask | 乔克叔叔的床边故事" itemprop=name><meta content="" itemprop=description></span><header class=post-header><h1 class=post-title itemprop="name headline">np.ma.mask</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>Posted on</span> <time datetime=2020-11-10T10:08:30+08:00 itemprop="dateCreated datePublished" title="Created: 2020-11-10 10:08:30">2020-11-10</time> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder"></i> </span><span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/ rel=index itemprop=url><span itemprop=name>学习笔记</span></a> </span></span><span class=post-meta-break></span> <span class=post-meta-item title="Word count in article"><span class=post-meta-item-icon><i class="far fa-file-word"></i> </span><span class=post-meta-item-text>Word count in article: </span><span>3.9k</span> </span><span class=post-meta-item title="Reading time"><span class=post-meta-item-icon><i class="far fa-clock"></i> </span><span class=post-meta-item-text>Reading time &asymp;</span> <span>14 mins.</span></span></div></div></header><div class=post-body itemprop=articleBody><p>自己前几天一直在跟mask斗争，中文网站上也没什么好的资料，就索性自己整理一下。</p><span id=more></span><h1 id=创建>创建</h1><p>官方提供了三种方法来创建mask，第一种是直接指定mask的位置</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>import</span> numpy <span class=keyword>as</span> np</span><br><span class=line><span class=keyword>import</span> numpy.ma <span class=keyword>as</span> ma</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>y = ma.array([<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>], mask = [<span class=number>0</span>, <span class=number>1</span>, <span class=number>0</span>])</span><br><span class=line>y</span><br></pre></td></tr></table></figure><pre><code>masked_array(data=[1, --, 3],
             mask=[False,  True, False],
       fill_value=999999)</code></pre><p>第二种是用ma.MaskedArray类，这个不是很常用</p><p>x = MaskedArray(data, mask=nomask, dtype=None, copy=False, subok=True, ndmin=0, fill_value=None, keep_mask=True, hard_mask=None, shrink=True, order=None)</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>data = np.arange(<span class=number>6</span>).reshape((<span class=number>2</span>, <span class=number>3</span>))</span><br><span class=line>np.ma.MaskedArray(data, mask=[[<span class=literal>False</span>, <span class=literal>True</span>, <span class=literal>False</span>],</span><br><span class=line>                              [<span class=literal>False</span>, <span class=literal>False</span>, <span class=literal>True</span>]])</span><br></pre></td></tr></table></figure><pre><code>masked_array(
  data=[[0, --, 2],
        [3, 4, --]],
  mask=[[False,  True, False],
        [False, False,  True]],
  fill_value=999999)</code></pre><p>这种方法可以直接给整个数组上mask</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>np.ma.MaskedArray(data, mask=<span class=literal>False</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line>masked_array(</span><br><span class=line>  data=[[<span class=number>0</span>, <span class=number>1</span>, <span class=number>2</span>],</span><br><span class=line>        [<span class=number>3</span>, <span class=number>4</span>, <span class=number>5</span>]],</span><br><span class=line>  mask=[[<span class=literal>False</span>, <span class=literal>False</span>, <span class=literal>False</span>],</span><br><span class=line>        [<span class=literal>False</span>, <span class=literal>False</span>, <span class=literal>False</span>]],</span><br><span class=line>  fill_value=<span class=number>999999</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>np.ma.MaskedArray(data, mask=<span class=literal>True</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre></td><td class=code><pre><span class=line>masked_array(</span><br><span class=line>  data=[[--, --, --],</span><br><span class=line>        [--, --, --]],</span><br><span class=line>  mask=[[ <span class=literal>True</span>,  <span class=literal>True</span>,  <span class=literal>True</span>],</span><br><span class=line>        [ <span class=literal>True</span>,  <span class=literal>True</span>,  <span class=literal>True</span>]],</span><br><span class=line>  fill_value=<span class=number>999999</span>,</span><br><span class=line>  dtype=int64)</span><br></pre></td></tr></table></figure><p>官方给出的第三种原文和事例如下，但是我始终没有特别理解</p><p>A third option is to take the view of an existing array. In that case, the mask of the view is set to nomask if the array has no named fields, or an array of boolean with the same structure as the array otherwise.</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>x = np.array([<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>x.view(ma.MaskedArray)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>masked_array(data=[<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>],</span><br><span class=line>             mask=<span class=literal>False</span>,</span><br><span class=line>       fill_value=<span class=number>999999</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>x = np.array([(<span class=number>1</span>, <span class=number>1.</span>), (<span class=number>2</span>, <span class=number>2.</span>)], dtype=[(<span class=string>&#x27;a&#x27;</span>,<span class=built_in>int</span>), (<span class=string>&#x27;b&#x27;</span>, <span class=built_in>float</span>)])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>x.view(ma.MaskedArray)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line>masked_array(data=[(<span class=number>1</span>, <span class=number>1.0</span>), (<span class=number>2</span>, <span class=number>2.0</span>)],</span><br><span class=line>             mask=[(<span class=literal>False</span>, <span class=literal>False</span>), (<span class=literal>False</span>, <span class=literal>False</span>)],</span><br><span class=line>       fill_value=(<span class=number>999999</span>, <span class=number>1.e+20</span>),</span><br><span class=line>            dtype=[(<span class=string>&#x27;a&#x27;</span>, <span class=string>&#x27;&lt;i8&#x27;</span>), (<span class=string>&#x27;b&#x27;</span>, <span class=string>&#x27;&lt;f8&#x27;</span>)])</span><br></pre></td></tr></table></figure><p>对于我来说我的需求基本就是构造一个和已有mask array相同的数组，对我来说可以用以下方法得到</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ma.array(np.zeros_like(y),mask=y.mask)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>masked_array(data=[<span class=number>0</span>, --, <span class=number>0</span>],</span><br><span class=line>             mask=[<span class=literal>False</span>,  <span class=literal>True</span>, <span class=literal>False</span>],</span><br><span class=line>       fill_value=<span class=number>999999</span>)</span><br></pre></td></tr></table></figure><p>除此之外，还有一些函数可以完成效果，比较常用的是这几个</p><p>masked_equal(x, value[, copy])</p><p>masked_greater(x, value[, copy])</p><p>masked_greater_equal(x, value[, copy])</p><p>masked_invalid(a[, copy])</p><p>masked_less(x, value[, copy])</p><p>masked_less_equal(x, value[, copy])</p><p>masked_not_equal(x, value[, copy])</p><p>masked_where(condition, a[, copy])</p><p>这里masked_where()和masked_invalid()最好用</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>a = np.arange(<span class=number>4</span>)</span><br><span class=line>ma.masked_where(a &lt;= <span class=number>2</span>, a)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>masked_array(data=[--, --, --, <span class=number>3</span>],</span><br><span class=line>             mask=[ <span class=literal>True</span>,  <span class=literal>True</span>,  <span class=literal>True</span>, <span class=literal>False</span>],</span><br><span class=line>       fill_value=<span class=number>999999</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>a=np.asarray([<span class=number>1</span>,<span class=number>2</span>,<span class=number>3</span>,np.inf,np.nan])</span><br><span class=line>ma.masked_invalid(a)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>masked_array(data=[<span class=number>1.0</span>, <span class=number>2.0</span>, <span class=number>3.0</span>, --, --],</span><br><span class=line>             mask=[<span class=literal>False</span>, <span class=literal>False</span>, <span class=literal>False</span>,  <span class=literal>True</span>,  <span class=literal>True</span>],</span><br><span class=line>       fill_value=<span class=number>1e+20</span>)</span><br></pre></td></tr></table></figure><p>在创建里面还有一个事情是比较重要的，那就是fill_value</p><p>在创建的时候可以指定fill_value，除此之外，可以通过这个函数来查看fill_value</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line>x = np.ma.array([<span class=number>0</span>, <span class=number>1.</span>], fill_value=-np.inf)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x.fill_value</span><br><span class=line>-inf</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x.fill_value = np.pi</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x.fill_value</span><br><span class=line><span class=number>3.1415926535897931</span> <span class=comment># may vary</span></span><br></pre></td></tr></table></figure><p>对于已经设置好fill_value的，可以用这个函数来改变fill_value</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>import</span> numpy.ma <span class=keyword>as</span> ma</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a = np.arange(<span class=number>5</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>array([<span class=number>0</span>, <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>])</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a = ma.masked_where(a &lt; <span class=number>3</span>, a)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>masked_array(data=[--, --, --, <span class=number>3</span>, <span class=number>4</span>],</span><br><span class=line>             mask=[ <span class=literal>True</span>,  <span class=literal>True</span>,  <span class=literal>True</span>, <span class=literal>False</span>, <span class=literal>False</span>],</span><br><span class=line>       fill_value=<span class=number>999999</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>ma.set_fill_value(a, -<span class=number>999</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>masked_array(data=[--, --, --, <span class=number>3</span>, <span class=number>4</span>],</span><br><span class=line>             mask=[ <span class=literal>True</span>,  <span class=literal>True</span>,  <span class=literal>True</span>, <span class=literal>False</span>, <span class=literal>False</span>],</span><br><span class=line>       fill_value=-<span class=number>999</span>)</span><br></pre></td></tr></table></figure><p>Nothing happens if a is a not masked array</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre></td><td class=code><pre><span class=line>a = <span class=built_in>list</span>(<span class=built_in>range</span>(<span class=number>5</span>))</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>[<span class=number>0</span>, <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>]</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>ma.set_fill_value(a, <span class=number>100</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>[<span class=number>0</span>, <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>]</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a = np.arange(<span class=number>5</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>array([<span class=number>0</span>, <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>])</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>ma.set_fill_value(a, <span class=number>100</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>a</span><br><span class=line>array([<span class=number>0</span>, <span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>])</span><br></pre></td></tr></table></figure><p>在创建完之后，大部分运算都只会针对没有被mask的地方。一些函数可能会出问题，所以像min/max/average这种函数推荐使用np里的函数而不是python内置函数</p><h1 id=索引>索引</h1><p>如果索引的地方没有被mask的话，返回值和普通的array一样。</p><p>如果是被masked，返回值是masked。</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre></td><td class=code><pre><span class=line><span class=meta>&gt;&gt;&gt; </span>x = ma.array([<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>], mask=[<span class=number>0</span>, <span class=number>0</span>, <span class=number>1</span>])</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x[<span class=number>0</span>]</span><br><span class=line><span class=number>1</span></span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x[-<span class=number>1</span>]</span><br><span class=line>masked</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x[-<span class=number>1</span>] <span class=keyword>is</span> ma.masked</span><br><span class=line><span class=literal>True</span></span><br></pre></td></tr></table></figure><h1 id=取消>取消</h1><p>常用的是这个</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre></td><td class=code><pre><span class=line><span class=meta>&gt;&gt;&gt; </span>x = ma.array([<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>], mask=[<span class=number>0</span>, <span class=number>0</span>, <span class=number>1</span>])</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x</span><br><span class=line>masked_array(data=[<span class=number>1</span>, <span class=number>2</span>, --],</span><br><span class=line>             mask=[<span class=literal>False</span>, <span class=literal>False</span>,  <span class=literal>True</span>],</span><br><span class=line>       fill_value=<span class=number>999999</span>)</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x.mask = ma.nomask</span><br><span class=line><span class=meta>&gt;&gt;&gt; </span>x</span><br><span class=line>masked_array(data=[<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>],</span><br><span class=line>             mask=[<span class=literal>False</span>, <span class=literal>False</span>, <span class=literal>False</span>],</span><br><span class=line>       fill_value=<span class=number>999999</span>)</span><br></pre></td></tr></table></figure><p>这样就可以获取被mask地方的值了，但是要注意的是其实这个返回的array还是带mask的，就是mask全是False罢了，想让他完全变成nomask可以用</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>x.data                                                                                                              </span><br><span class=line>Out[<span class=number>6</span>]: array([<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>])</span><br></pre></td></tr></table></figure><p>这个 返回值就是只有array</p><h1 id=参考>参考</h1><p>https://numpy.org/doc/stable/reference/maskedarray.generic.html</p><p>https://www.numpy.org.cn/reference/arrays/maskedarray.html</p></div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>Post author: </strong>周大侠</li><li class=post-copyright-link><strong>Post link: </strong><a href=https://lifeodyssey.github.io/posts/39e89397.html title=np.ma.mask>https://lifeodyssey.github.io/posts/39e89397.html</a></li><li class=post-copyright-license><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class=exturl data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><i class="fa-fw fab fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.</li></ul></div><div class=post-tags><a href=/tags/Research/ rel=tag># Research</a> <a href=/tags/python/ rel=tag># python</a></div><div class=post-nav><div class=post-nav-item><a href=/posts/f4af350.html rel=prev title=kriging><i class="fa fa-angle-left"></i> kriging</a></div><div class=post-nav-item><a href=/posts/3da0aceb.html rel=next title="Note in writing and presentation">Note in writing and presentation <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2016 – <span itemprop=copyrightYear>2025</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>周大侠</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i> </span><span title="Word count total">794k</span> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i> </span><span title="Reading time total">48:07</span></span></div><div class=powered-by>Powered by <span class=exturl data-url=aHR0cHM6Ly9oZXhvLmlv>Hexo</span> & <span class=exturl data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><div class=sidebar-dimmer></div><div class=back-to-top role=button aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class=reading-progress-bar></div><a class="book-mark-link book-mark-link-fixed" role=button></a> <span class="exturl github-corner" data-url=aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5 title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg aria-hidden=true height=80 viewBox="0 0 250 250" width=80><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" class=octo-arm fill=currentColor style="transform-origin:130px 106px"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" class=octo-body fill=currentColor></path></svg></span><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript></body></html>
<!DOCTYPE html><html class="font-sans scroll-smooth" lang=zh-CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/favicon.svg rel=icon type=image/svg+xml><title>Water Classification for Inversion/Retrieval | 乔克叔叔的床边故事</title><meta content="A hybrid algorithm for estimating the chlorophyll-a concentration across different trophic states in Asian inland waters..." name=description><meta content=周大侠 name=author><meta content="Astro v5.13.7" name=generator><meta content="oklch(96% 0.005 298)" name=theme-color><link href=/fonts/EarlySummer-VF-Split/EarlySummer-VF-Subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Black-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Bold-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-Italic-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=https://lifeodyssey.github.io/posts/696b3f33.html.html rel=canonical><link href=/sitemap-index.xml rel=sitemap><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=https://lifeodyssey.github.io rel=alternate hreflang=zh><link href=https://lifeodyssey.github.io/en/ rel=alternate hreflang=en><link href=https://lifeodyssey.github.io/ja/ rel=alternate hreflang=ja><meta content=article property=og:type><meta content=https://lifeodyssey.github.io/posts/696b3f33.html.html property=og:url><meta content="Water Classification for Inversion/Retrieval | 乔克叔叔的床边故事" property=og:title><meta content="A hybrid algorithm for estimating the chlorophyll-a concentration across different trophic states in Asian inland waters..." property=og:description><meta content=https://lifeodyssey.github.io/og/696b3f33.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.1k2cUud7.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!!e&&"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",t?"oklch(22% 0.005 298)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t)}document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),e(),t()}()</script><link href=/_astro/_about_.Dzb1Me_E.css rel=stylesheet><link href=/_astro/_posts_slug_.CM85RmC-.css rel=stylesheet><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const tp={preserveBehavior:!1},ep=t=>{if("string"==typeof t)return[t,tp];const[e,n=tp]=t;return[e,{...tp,...n}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,e,r,o,i,a,s,c,d,p,l=t,u){function f(){u||(u=1,"/"==(s=(a.lib||"/~partytown/")+(a.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),o!=t?o.dispatchEvent(new CustomEvent("pt1",{detail:t})):(c=setTimeout(w,(null==a?void 0:a.fallbackTimeout)||1e4),e.addEventListener("pt0",h),i?y(1):r.serviceWorker?r.serviceWorker.register(s+(a.swPath||"partytown-sw.js"),{scope:s}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):w())))}function y(n){p=e.createElement(n?"script":"iframe"),t._pttab=Date.now(),n||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=s+"partytown-"+(n?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),e.querySelector(a.sandboxParent||"body").appendChild(p)}function w(n,r){for(h(),o==t&&(a.forward||[]).map((function(e){const[n]=ep(e);delete t[n.split(".")[0]]})),n=0;n<d.length;n++)(r=e.createElement("script")).innerHTML=d[n].innerHTML,r.nonce=a.nonce,e.head.appendChild(r);p&&p.parentNode.removeChild(p)}function h(){clearTimeout(c)}a=t.partytown||{},o==t&&(a.forward||[]).map((function(e){const[r,{preserveBehavior:o}]=ep(e);l=t,r.split(".").map((function(e,r,i){var a;l=l[i[r]]=r+1<i.length?l[i[r]]||(a=i[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(o){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,i);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(i,arguments),n}})()}))})),"complete"==e.readyState?f():(t.addEventListener("DOMContentLoaded",f),t.addEventListener("load",f))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-696b3f33-zh}@layer astro{::view-transition-old(post-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-696b3f33-zh}@layer astro{::view-transition-old(time-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-696b3f33-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-wif6pdce-3]{view-transition-name:site-title-zh}@layer astro{::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><body><div class="w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><header class="cjk:tracking-0.02em lg:uno-desktop-column lg:top-20 mb-10.8"><h2 class="font-bold c-secondary font-title lg:c-primary lg:mb-1.8 lg:mt-0 lg:text-9 mb-2.8 mt-3 text-5.375"><div class="inline-block box-content pr-1" data-astro-transition-scope=astro-wif6pdce-3 data-disable-theme-transition><a href=/ id=site-title-link>乔克叔叔的床边故事</a></div></h2></header><nav aria-label="Site Navigation" class="hidden cjk:tracking-0.02em font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,12.5rem)] lg:text-4 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">文章</a></li><li><a href=/tags/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">标签</a></li><li><a href=/about/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">关于</a></li><li><a href=/search/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Search</a></li></ul></nav><main class=mb-10><article class=heti><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function e(t){if(!(t.target instanceof Element?t.target:null)?.closest("#back-button"))return;if(window.history.length>1)return void window.history.back();const e=document.getElementById("site-title-link");e&&e.click()}document.addEventListener("click",e,{passive:!0})</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>Water Classification for Inversion/Retrieval</span></h1></div><div class="c-primary block font-time mb-17.2" data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition id=post-date><time datetime=2021-01-15>2021-01-15 </time><span class=ml-1.75>14 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="w-full h-12 relative" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>目录</span><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor class="aspect-square 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center hidden ml-4 w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#water-classification class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Water Classification</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#quantitatively-measurement class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Quantitatively measurement</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#result class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Result</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#code class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Code</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#annotation class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Annotation</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#a-global-approach-for-chlorophyll-a-retrieval-across-optically-complex-inland-waters-based-on-optical-water-type class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>A global approach for chlorophyll-a retrieval across optically complex inland waters based on optical water type</a></li></ul></nav></div></div><script type=module>let s=null,i=null;function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",c=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&c.set(e,t)}));let r=null;function l(t){t!==r&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),r=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}s=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=c.get(e);t&&l(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]}),Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>s?.observe(t)));const a=document.getElementById("post-copyright");a&&(i=new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),r=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}),i?.observe(a),n.length>0&&l(n[0]))}function m(){s?.disconnect(),i?.disconnect(),s=null,i=null}document.addEventListener("astro:after-swap",g),document.addEventListener("astro:before-swap",m),g()</script><div id=post-content><p>A hybrid algorithm for estimating the chlorophyll-<em>a</em> concentration across different trophic states in Asian inland waters</p><p>Optical water type discrimination and tuning remote sensing band-ratio algorithms: application to retrieval of chlorophyll and kd (490) in the Irish and Celtic seas</p><p>Influence of a red band-based water classification approach on chlorophyll algorithms for optically complex estuaries</p><p>A soft-classification-based chlorophyll-a estimation method using MERIS data in the highly turbid and eutrophic Taihu Lake</p><p>A system to measure the data quality of spectral remote-sensing reflectance of aquatic environments</p><p>An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications</p><h1 id=a-system-to-measure-the-data-quality-of-spectral-remote-sensing-reflectance-of-aquatic-environments>A system to measure the data quality of spectral remote-sensing reflectance of aquatic environments<a href=#a-system-to-measure-the-data-quality-of-spectral-remote-sensing-reflectance-of-aquatic-environments class=heading-anchor-link aria-label="Link to A system to measure the data quality of spectral remote-sensing reflectance of aquatic environments"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><h2 id=water-classification>Water Classification<a href=#water-classification class=heading-anchor-link aria-label="Link to Water Classification"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>The reference Rrs spectra were first normalized by their respective root of sum of squares (RSS),</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mrow><mo stretchy=false>[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>i</mi></msub><msup><mo stretchy=false>)</mo><mn>2</mn></msup><msup><mo stretchy=false>]</mo><mrow><mn>1</mn><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda)=\frac{R_{rs}}{[\sum^N_{i=1}R_{rs}(\lambda_i)^2]^{1/2}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.5313em;vertical-align:-1.1709em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3603em><span style=top:-2.1288em><span class=pstrut style=height:3em></span><span class=mord><span class=mopen>[</span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7401em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.814em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1/2</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1709em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>where the index N represents the total number of wavelengths, varying from 1 to 9 and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\lambda_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8444em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> corresponds to the wavelengths of 412, 443, 488, 510, 531, 547, 555, 667, and 678 nm. The nRrs spectra vary over the range between 0 and 1, while it retains the ‘‘shapes’’ pertaining to the original Rrs spectra, i.e., the band ratios of nRrs(<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\lambda_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8444em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>) remain the same as Rrs(<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\lambda_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8444em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>).</p><p>The number of data clusters k was evaluated using the gap method [Tibshirani et al., 2001]. The gap value is defined as:</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>G</mi><mi>A</mi><msub><mi>P</mi><mi>n</mi></msub><mo stretchy=false>(</mo><mi>k</mi><mo stretchy=false>)</mo><mo>=</mo><msubsup><mi>E</mi><mi>n</mi><mo>∗</mo></msubsup><mo stretchy=false>[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=false>(</mo><msub><mi>W</mi><mi>k</mi></msub><mo stretchy=false>)</mo><mo stretchy=false>]</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=false>(</mo><msub><mi>W</mi><mi>k</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>GAP_n(k)=E_n^*[log(W_k)]-log(W_k)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">G</span><span class="mord mathnormal">A</span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03148em>k</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7387em><span style=top:-2.453em;margin-left:-.0576em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">n</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style=margin-right:.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)]</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style=margin-right:.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>where n is the sample size, k is the number of clusters being evaluated, and Wk is the pooled within-cluster dispersion measurement, with</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><msub><mi>W</mi><mi>k</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mfrac><mn>1</mn><mrow><mn>2</mn><msub><mi>n</mi><mi>r</mi></msub></mrow></mfrac><msub><mi>D</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>W_k=\sum_{r=1}^k\frac{1}{2n_r}D_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:3.1032em;vertical-align:-1.2671em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8361em><span style=top:-1.8829em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=top:-4.3em;margin-left:0><span class=pstrut style=height:3.05em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span><span class=mord><span class="mord mathnormal">n</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.836em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0278em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span><p>where nr is the number of data points in cluster r, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>D</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>D_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>D</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0278em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is the sum of the pair-wise distances for all points in cluster r.</p><p>The expected value <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>E</mi><mi>n</mi><mo>∗</mo></msubsup><mo stretchy=false>[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=false>(</mo><msub><mi>W</mi><mi>k</mi></msub><mo stretchy=false>)</mo><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>E_n^*[log(W_k)]</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0576em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">n</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style=margin-right:.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)]</span></span></span></span> is determined by Monte Carlo sampling from a reference distri- bution, and $log(Wk) is computed from the sample data. According to the gap method, the optimum cluster number of the nRrs data is determined as 23. Interestingly, this number is nearly the same as that of Forel- Ule water type classes developed 100 years ago [Arnone et al., 2004].</p><p>The unsupervised method, K-means clustering technique, was further used to group the nRrs spectra.</p><figure><img alt=image-00030115135501466 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115135501466.png><figcaption>image-00030115135501466</figcaption></figure><figure><img alt=image-00030115140950759 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115140950759.png><figcaption>image-00030115140950759</figcaption></figure><figure><img alt=image-00030115141023265 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115141023265.png><figcaption>image-00030115141023265</figcaption></figure><p>This is a very detailed classification.</p><p>But what i want to do is just”Case1, Case2, and Case2 into slightly turbid, moderet turbid and highly turbid”</p><p>Anyway, I’m gonna to read it over as I also need it to do the verification/validation.</p><h2 id=quantitatively-measurement>Quantitatively measurement<a href=#quantitatively-measurement class=heading-anchor-link aria-label="Link to Quantitatively measurement"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><ol><li><p>match up <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>R_{rs}^*(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span></span></span></span> with regard to the wavelengths. If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>R^*_{rs}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> has more spectral bands than that of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span></span></span></span>, we will only choose the same wavelengths with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span></span></span></span> for further analysis. If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>R^*_{rs}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> has fewer wavelengths than the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span></span></span></span> spectra (i.e., <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>N</mi><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo><mo>&#x3C;</mo><mn>9</mn></mrow><annotation encoding=application/x-tex>N(\lambda^{'})&#x3C;9</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.10903em>N</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&#x3C;</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>9</span></span></span></span>), a subset of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> and associated upper boundary spectra <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>U</mi></msubsup><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}^U(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> and lower boundary spectra <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>L</mi></msubsup><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}^L(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">L</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> will be extrated first for <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup></mrow><annotation encoding=application/x-tex>\lambda^{'}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9425em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>.</p></li><li><p>the normalization of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>R_{rs}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> spectra following equation (1). For the case of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>N</mi><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo><mo>&#x3C;</mo><mn>9</mn></mrow><annotation encoding=application/x-tex>N(\lambda^{'})&#x3C;9</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.10903em>N</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&#x3C;</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>9</span></span></span></span>, the new <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> specta will be rescaled through the normalization procedure of eq(1) so that the RSS of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> is equal to 1 (<strong>?</strong>). Further, the new upper and lower boundary spectra <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>U</mi></msubsup><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}^{U}(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>L</mi></msubsup><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}^{L}(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> will also be rescaled by the newly rescaled <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msup><mi>λ</mi><msup><mrow></mrow><mo lspace=0em rspace=0em mathvariant=normal>′</mo></msup></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nR_{rs}(\lambda^{'})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1925em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9425em><span style=top:-2.9425em;margin-right:.05em><span class=pstrut style=height:2.5795em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278em><span style=top:-2.931em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> spectra as below</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>U</mi></msubsup><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>U</mi></msubsup><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo></mrow><mrow><mo stretchy=false>[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>i</mi></msub><msup><mo stretchy=false>)</mo><mn>2</mn></msup><msup><mo stretchy=false>]</mo><mrow><mn>1</mn><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>nR_{rs}^{U}(\lambda)=\frac{nR_{rs}^{U}(\lambda)}{[\sum_{i=1}^NnR_{rs}(\lambda_i)^2]^{1/2}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1413em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.6893em;vertical-align:-1.1709em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.5183em><span style=top:-2.1288em><span class=pstrut style=height:3em></span><span class=mord><span class=mopen>[</span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7401em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.814em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1/2</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1709em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>L</mi></msubsup><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mi>L</mi></msubsup><mo stretchy=false>(</mo><mi>λ</mi><mo stretchy=false>)</mo></mrow><mrow><mo stretchy=false>[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>i</mi></msub><msup><mo stretchy=false>)</mo><mn>2</mn></msup><msup><mo stretchy=false>]</mo><mrow><mn>1</mn><mi mathvariant=normal>/</mi><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding=application/x-tex>nR_{rs}^{L}(\lambda)=\frac{nR_{rs}^{L}(\lambda)}{[\sum_{i=1}^NnR_{rs}(\lambda_i)^2]^{1/2}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1413em;vertical-align:-.25em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.6893em;vertical-align:-1.1709em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.5183em><span style=top:-2.1288em><span class=pstrut style=height:3em></span><span class=mord><span class=mopen>[</span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7401em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.814em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">1/2</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1709em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li><p>assign a water type to the target spectrum by comparing it with the reference nRrs spectra. The spectra similarity between the target spectrum <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>nR_{rs}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> and refference spectra nRrs are estimated using a spectral angle mapper(SAM)[Kruse et al., 1993],</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mtext> </mtext><mi>α</mi><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=false>[</mo><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup><mo>∗</mo><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>]</mo></mrow><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=false>[</mo><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo lspace=0em rspace=0em>∗</mo></msubsup><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy=false>)</mo><msup><mo stretchy=false>]</mo><mn>2</mn></msup><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=false>[</mo><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy=false>)</mo><msup><mo stretchy=false>]</mo><mn>2</mn></msup></mrow></msqrt></mfrac></mrow><annotation encoding=application/x-tex>cos\ \alpha=\frac{\sum_{i=1}^{N}[nR_{rs}^**nR_{rs}]}{\sqrt{\sum_{i=1}^{N}[nR_{rs}^{*}(\lambda_i)]^2\sum_{i=1}^{N}[nR_{rs}(\lambda_i)]^2}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">cos</span><span class=mspace> </span><span class="mord mathnormal" style=margin-right:.0037em>α</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:3.4009em;vertical-align:-1.73em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.6709em><span style=top:-2.11em><span class=pstrut style=height:3.3258em></span><span class=mord><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3258em><span class=svg-align style=top:-3.8em><span class=pstrut style=height:3.8em></span><span class=mord style=padding-left:1em><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6147em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7401em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7401em><span style=top:-2.989em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style=top:-3.2858em><span class=pstrut style=height:3.8em></span><span class=hide-tail style=min-width:1.02em;height:1.88em><svg viewBox="0 0 400000 1944" height=1.88em preserveAspectRatio="xMinYMin slice" width=400em xmlns=http://www.w3.org/2000/svg><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5142em><span></span></span></span></span></span></span></span><span style=top:-3.5558em><span class=pstrut style=height:3.3258em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-4.0155em><span class=pstrut style=height:3.3258em></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>]</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.73em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>Where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>α</mi></mrow><annotation encoding=application/x-tex>\alpha</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.0037em>α</span></span></span></span> is the angle formed between the refference spectrum nRrs and the normalized target spectrum <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>nR_{rs}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span>. As a spectral classifier, SAM is able to determine the spectral similarity by treating them as vertors in a space with dimensionality equal to the number of bands, N. The water type of the target spectrum <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>nR_{rs}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> is identified as one with the largest cosine values (equivalent to the smllest angles).</p></li><li><p>the computation of QA scores by comparing the target spectrum <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mi>R</mi><mi>r</mi><mi>s</mi></mrow><annotation encoding=application/x-tex>nRrs</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">rs</span></span></span></span> with the upper and lower boundaries (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mi>R</mi><mi>r</mi><msup><mi>s</mi><mi>U</mi></msup></mrow><annotation encoding=application/x-tex>nRrs^U</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8413em></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mi>R</mi><mi>r</mi><msup><mi>s</mi><mi>L</mi></msup></mrow><annotation encoding=application/x-tex>nRrs^L</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8413em></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span>) of the corresponding water type. The number of wavelengths where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>nR_{rs}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> falling within the boundaries is counted, and used to derive the total score (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>C</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>C_{tot}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=top:-2.55em;margin-left:-.0715em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>) for the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><msub><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=application/x-tex>nR_{rs}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> spectrum,</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><msub><mi>C</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>C</mi><mo stretchy=false>(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy=false>)</mo><mo>+</mo><mi>C</mi><mo stretchy=false>(</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy=false>)</mo><mo>+</mo><mo>…</mo><mo>+</mo><mi>C</mi><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>N</mi></msub><mo stretchy=false>)</mo></mrow><mi>N</mi></mfrac></mrow><annotation encoding=application/x-tex>C_{tot}=\frac{C(\lambda_1)+C(\lambda_2)+\ldots+C(\lambda_N)}{N}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=top:-2.55em;margin-left:-.0715em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:2.113em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.427em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>N</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=minner>…</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li></ol><p>Where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>C_{i}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:-.0715em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is the wavelength-specific score with N the total number of wavelengths for both <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=application/x-tex>R_{rs}^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.9357em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msubsup></mrow><annotation encoding=application/x-tex>R_{rs}^{ref}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0961em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8491em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight" style=margin-right:.10764em>f</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span>. At wavelength <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\lambda_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8444em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> , for example, if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>R</mi><mrow><mi>r</mi><mi>s</mi></mrow><mo>∗</mo></msubsup><mo stretchy=false>(</mo><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>R_{rs}^*(\lambda_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-2.453em;margin-left:-.0077em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mtight mbin">∗</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> is found beyond either the upper or lower boundary of nRrs, a score of 0 will be assigned to this wavelength; otherwise score=1. As suggested by equation (7), the total score <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>C</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>C_{tot}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=top:-2.55em;margin-left:-.0715em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> will vary within the range of [0, 1]. A higher score indicates higher data quality.</p><p>To account for the measurement uncertainty and possible data-processing errors and likely insufficient data coverage, the original upper boundary and lower boundary are slightly modified by <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>±</mo><mn>0.5</mn></mrow><annotation encoding=application/x-tex>\pm0.5%</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7278em;vertical-align:-.0833em></span><span class=mord>±</span><span class=mord>0.5</span></span></span></span>,<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mi>R</mi><mi>r</mi><msup><mi>s</mi><mi>U</mi></msup><mo>=</mo><mi>n</mi><mi>R</mi><mi>r</mi><msup><mi>s</mi><mi>U</mi></msup><mo>×</mo><mo stretchy=false>(</mo><mn>1</mn><mo>+</mo><mn>0.005</mn><mo stretchy=false>)</mo><mtext> </mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mi>R</mi><mi>r</mi><msup><mi>s</mi><mi>L</mi></msup><mo>=</mo><mi>n</mi><mi>R</mi><mi>r</mi><msup><mi>s</mi><mi>L</mi></msup><mo>×</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><mn>0.005</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>nRrs^U=nRrs^U\times(1+0.005)\ and\ nRrs^L=nRrs^L\times(1-0.005)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8413em></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.9247em;vertical-align:-.0833em></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.10903em>U</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1.0913em;vertical-align:-.25em></span><span class=mord>0.005</span><span class=mclose>)</span><span class=mspace> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class=mspace> </span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.9247em;vertical-align:-.0833em></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>0.005</span><span class=mclose>)</span></span></span></span>, respectively. Note that this added range of 0.5% is one order of magnitude smaller than the projected accuracy for radiance measurement [Hooker et al., 1992].</p><figure><img alt=image-00030115182324282 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115182324282.png><figcaption>image-00030115182324282</figcaption></figure><h2 id=result>Result<a href=#result class=heading-anchor-link aria-label="Link to Result"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>Because all field measurements are discrete, it is likely that the database used here does not cover every water types and/or there are situations where the range of Rrs variability goes beyond the domains defined here. Such a limitation can be updated or revised when more high-quality in situ measurements are avail- able. A MATLABVR script is made available (<a href=http://oceanoptics.umb.edu/score_metric/ rel="nofollow noopener noreferrer external" target=_blank>http://oceanoptics.umb.edu/score_metric/</a>) to facilitate the evaluation and refinement of the score metrics. Nevertheless, this QA scheme provides an easily applicable system to quantitatively evaluate the quality of individual Rrs spectra.</p><h2 id=code>Code<a href=#code class=heading-anchor-link aria-label="Link to Code"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=matlab style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>function</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#e36209;--shiki-dark:#FFAB70>maxCos</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>cos</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>clusterID</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>totScore</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] = </span><span style=color:#6f42c1;--shiki-dark:#B392F0>QAscores_matrix</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#e36209;--shiki-dark:#FFAB70>test_Rrs</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>test_lambda</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Quality assurance system for Rrs spectra (version 1)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Author: Jianwei Wei, University of Massachusetts Boston</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Email: Jianwei.Wei@umb.edu</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Nov-01-2016</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% ------------------------------------------------------------------------------</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% KNOWN VARIABLES :   ref_nRrs   -- Normalized Rrs spectra per-determined from water clustering (23x9 matrix)  </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%                     ref_lambda -- Wavelengths for ref_nRrs (1x9 matrix)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%                     upB        -- Upper boundary (23x9 matrix)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%                     lowB       -- Lower boundary (23x9 matrix)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% INPUTS:            test_Rrs   -- Rrs spectra for testing (units: sr^-1);</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%                                  a row vector</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%                    test_lambda-- Wavelengths for test_Rrs</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% OUTPUTS:  maxCos     -- maximum cosine values</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%           cos        -- cosine values for every ref_nRrs spectra</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%           clusterID  -- idenfification of water types (from 1-23)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%           totScore   -- total score assigned to test_Rrs</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% ------------------------------------------------------------------------------</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% NOTE:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         1) Nine wavelengths (412, 443, 488, 510, 531, 547, 555, 667, 678nm) are assumed in the model</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         2) If your Rrs data were measured at other wavelength, e.g. 440nm, you may want to change 440 to 443 before the model run;</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%             or modify the code below to find a cloest wavelength from the nine bands.</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         3) The latest version may be found online at HTTP://oceanoptics.umb.edu/score_metric</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Reference:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         Wei, Jianwei; Lee, Zhongping; Shang, Shaoling (2016). A system</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         to measure the data quality of spectral remote sensing</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         reflectance of aquatic environments. Journal of Geophysical Research, </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         121, doi:10.1002/2016JC012126</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%         </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% ------------------------------------------------------------------------------</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Apr. 5 2017, Keping Du</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     1) Vectorize code</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     2) totScore takes account of NaN bands</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     3) add input data check</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Apr. 11, 2017</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     4) compatible with previous matlab version (tested on v2014a)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% INPUTS:            </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%           test_Rrs -- matrix (inRow*inCol), each row represents one Rrs spectrum</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% OUTPUTS:  </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%           maxCos,clusterID,totScore -- row vector (1*inRow)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%           cos -- matrix (refRow[23]*inRow) </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% Note:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     1) nanmean, nansum need statistics toolbox</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     2) on less memory and multi-core system, it may further speedup using</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%        parfor</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% ------------------------------------------------------------------------------</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% check input data</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[row_lam, len] = size(test_lambda);</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8>( row_lam </span><span style=color:#d73a49;--shiki-dark:#F97583>~=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span><span style=color:#24292e;--shiki-dark:#E1E4E8> )</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    test_lambda = test_lambda</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [row_lam, len] = size(test_lambda);</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>end</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[row, col] = size(test_Rrs);</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8>( len~=col </span><span style=color:#d73a49;--shiki-dark:#F97583>&#x26;&#x26;</span><span style=color:#24292e;--shiki-dark:#E1E4E8> len~=row)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    error(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Rrs and lambda size mismatch, please check the input data!'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>);</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>elseif</span><span style=color:#24292e;--shiki-dark:#E1E4E8>( len </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#24292e;--shiki-dark:#E1E4E8> row )</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    test_Rrs = test_Rrs</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>end</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_lambda = [</span><span style=color:#d73a49;--shiki-dark:#F97583>...</span><span style=color:#6a737d;--shiki-dark:#6A737D> </span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.1200000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4300000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8800000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.1000000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.3100000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.4700000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.5500000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.6700000e+02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.7800000e+02</span><span style=color:#24292e;--shiki-dark:#E1E4E8>];</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs = [</span><span style=color:#d73a49;--shiki-dark:#F97583>...</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>7.3796683e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.3537883e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3492125e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6941114e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1182662e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   8.4361643e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.2175090e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.2722859e-03</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.0353728e-03</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>6.7701882e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.3387929e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9394438e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.2455653e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.5599408e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2008708e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0354070e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0933735e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0455480e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>6.0833086e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2121439e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3584243e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7962783e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0377847e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6110758e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4032775e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6391579e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6652716e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>5.0963646e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7791625e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6164394e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4802439e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7862610e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3009577e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0608914e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8730802e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1444642e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.2964691e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3556598e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7152369e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8584748e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2599050e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7815421e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5272485e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7857754e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0848963e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.6333623e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8706313e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5815748e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0800274e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6779296e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2800639e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0440341e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2053379e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6881488e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.0946099e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5491575e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5120901e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1874143e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9159654e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5624518e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3479154e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7772121e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2270007e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.7592997e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1479809e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1544764e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1498609e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1372468e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9362850e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7826076e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.1949978e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.7485875e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.4894221e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3506487e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9141989e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8562158e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8741043e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8162021e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7750529e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.0297871e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1765683e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.2772731e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7529725e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8286839e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0702216e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2986184e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2741518e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2034636e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.8973961e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   8.2281945e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.9144133e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7609677e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4217459e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6720207e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0137560e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2429030e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3706779e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2861174e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8141021e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.8746813e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4076435e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4198541e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8187091e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2690383e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5020436e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6108232e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4677497e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.5051459e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.7255536e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.2029128e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4230960e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9321173e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4659383e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6240583e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6390040e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.2807580e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.5738816e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.8841854e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3450346e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1896860e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6310347e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1160987e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4466363e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6280653e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1459148e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1401522e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4302269e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9142029e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0575515e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6501150e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3375853e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7213469e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9178025e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6955637e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7983785e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.8122161e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0034662e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6123587e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0652476e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6505277e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1049611e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3692672e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5885777e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7375096e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.7376760e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0335076e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8260384e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3433902e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9927549e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4616335e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7240007e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7161480e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8030883e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4172683e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6884314e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7937007e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4856431e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3857605e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9800156e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2526881e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2057525e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3119104e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.9762118e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2646476e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1885211e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7695980e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3962502e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9232585e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2293225e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5168610e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4940869e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.1664824e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.5255979e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5801235e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2411839e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1170366e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7713532e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.1451309e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4308012e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5948949e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.6300080e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7545808e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4907066e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0835049e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0042169e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9006514e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.4422570e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8971850e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1691957e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.1144977e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3489716e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.2644205e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9215646e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8536483e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6326561e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.1087974e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0960602e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2932847e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4502528e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3256756e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7550282e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1469996e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8639896e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2323996e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.4785581e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4123619e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4889669e-01</span><span style=color:#24292e;--shiki-dark:#E1E4E8>];</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>upB = [</span><span style=color:#d73a49;--shiki-dark:#F97583>...</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>7.7969936e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.5909264e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6692096e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0292753e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3779175e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0873357e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.5895728e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5695335e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6623543e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>7.1135851e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.5483793e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2431975e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5442939e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8182569e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4088103e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2594384e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7945457e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7482701e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>6.4636996e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.4024177e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7082785e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2199848e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4284402e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9718059e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7318334e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.7007986e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.1761903e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>5.6956355e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.1481217e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2762943e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7374247e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1163845e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6467090e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3993224e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.1840977e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.1595171e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.7766327e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8771143e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.4753295e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1775156e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5180203e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1410390e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0074757e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.8916601e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.8223557e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.2349058e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1629204e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0574462e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2702700e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8954221e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5793655e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4536165e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.5299946e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.0929396e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.6203259e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8603916e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8546366e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3877038e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1263302e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7826776e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6026748e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   8.9755079e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.6484956e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.2810264e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4343461e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6353434e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4890674e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4108569e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1758379e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1232286e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.4401188e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4021177e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.2855883e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6912183e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3403075e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1270429e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1160816e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0289362e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1035327e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6615177e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7528681e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.8324712e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1754972e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7084893e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5098695e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5149446e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5357177e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5236036e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2816675e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2540729e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.5991344e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1914376e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7307732e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9984107e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2745720e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5149720e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7720363e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6995977e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8445448e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.5323148e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8678090e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7399254e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0526187e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3921995e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7516031e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0687105e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8317200e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8818901e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.3499754e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5303395e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9213672e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2364082e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7335481e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8597037e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8826847e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.2800547e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3376144e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.6334872e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6326210e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4983739e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8201315e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2907348e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6056025e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0704621e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6195191e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7603537e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.0165686e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1944496e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3293904e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8081387e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4757827e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9268537e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2092931e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0348242e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.2378780e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.2950692e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.2362822e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9607108e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3929798e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8191277e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3237136e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6462834e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9304042e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1905293e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.3208516e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4386127e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1588427e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5480624e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1530756e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6339021e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0286163e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0237661e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1290136e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.0171262e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0441871e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0892189e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7634368e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5467828e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2197132e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.6041815e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6311236e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6976942e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>6.5661340e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4690487e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3551261e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9595427e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6727210e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1473807e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3942630e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.7896558e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9313138e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.5923700e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8447802e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9637570e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5554446e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2928965e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0010046e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.7076206e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9044526e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9315569e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.3467705e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3694940e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9291331e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3603937e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4272385e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.1506755e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.0505783e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4064496e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8576387e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.5917155e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6716117e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5081075e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1848061e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0755621e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8220009e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.7294813e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5104257e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8328993e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.8025311e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6668715e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9757519e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3256976e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0993604e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5188827e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.7836256e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7903370e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0856220e-01</span><span style=color:#24292e;--shiki-dark:#E1E4E8>];</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lowB = [</span><span style=color:#d73a49;--shiki-dark:#F97583>...</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>7.0944028e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.1166101e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7132138e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1925057e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.3117696e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.2517151e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.4424250e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3244358e-03</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7280789e-03</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>6.3840139e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0883522e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6351047e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9833316e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3181697e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0045892e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   8.4327293e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7526552e-03</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0136510e-03</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>5.5332832e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9738169e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1160489e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4634336e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7860486e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3952599e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1925864e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.1624892e-03</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.7813256e-03</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>4.3575142e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3822012e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1917290e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1017788e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4134878e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9276253e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6873340e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0336969e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0575256e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.6482973e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9039153e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1720917e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6595976e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8660924e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3234012e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0247522e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.5868207e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.5286574e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.0704995e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6020020e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0499850e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8743491e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4744031e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9691113e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7164222e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8723854e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8095758e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.5106498e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1479600e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1503769e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0334518e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7325697e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3395352e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0649812e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6409266e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1277292e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.9524320e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6645927e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7459566e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8648689e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8966056e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7107656e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4536957e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3468373e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5248160e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.9510963e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1603431e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6697675e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6241475e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5891532e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5210964e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4139078e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.8341191e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   6.6080536e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.3127870e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3383370e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3563122e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8054666e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0677434e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8957954e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7636462e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1549732e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2454227e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>2.4706327e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4040986e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1094797e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4504382e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6604542e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.6960554e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7735013e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   8.4929835e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1753899e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4757789e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0726071e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0160822e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3610868e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0871602e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2488320e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2659628e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.0951814e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1484183e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>9.1742158e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6100841e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1322179e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7490499e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2297563e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3757985e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3639722e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4259065e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.3478356e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.5838339e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9960855e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6513370e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.1086089e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8179041e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.2671191e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3813226e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.5437250e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7919256e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>6.5751115e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4872663e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.7329740e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3440351e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1829544e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5463364e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6632118e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.3489346e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4272407e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.5596873e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.6063788e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.2583023e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.8187737e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.5551812e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9392236e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1661845e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2762330e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3207209e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.3658524e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7620400e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.5184514e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0981985e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8772491e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1841560e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.3663895e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4409767e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4335830e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>5.7943169e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.1577971e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4910978e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2064774e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1928998e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8032887e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9879067e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9669377e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.4213979e-02</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.2114597e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   7.9563157e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.8250239e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4567895e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.2360944e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.7846671e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1099745e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.1683471e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.0913583e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>3.5790266e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.6338446e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1754001e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9267040e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.9487537e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6406111e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.9047457e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0439610e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.1684389e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>1.0724044e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4052739e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9880290e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4646929e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.4713330e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.6406216e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   5.0762214e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4872355e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.7132289e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>7.3193803e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.8029772e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.0015322e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.4913266e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.3016201e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.5041635e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8460783e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6383395e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.9161859e-01</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>9.3197327e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   9.4502428e-02</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.4641494e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   1.9385761e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   2.6497912e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8223376e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   4.8516910e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.0135913e-01</span><span style=color:#005cc5;--shiki-dark:#79B8FF>   3.8303801e-01</span><span style=color:#24292e;--shiki-dark:#E1E4E8>];</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[refRow,refCol]=size(ref_nRrs);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% match the ref_lambda and test_lambda</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>idx0 = []; </span><span style=color:#6a737d;--shiki-dark:#6A737D>% for ref_lambda </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>idx1 = []; </span><span style=color:#6a737d;--shiki-dark:#6A737D>% for test_lambda</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> i = </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#d73a49;--shiki-dark:#F97583> :</span><span style=color:#24292e;--shiki-dark:#E1E4E8> length(test_lambda)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    pos = find(ref_lambda==test_lambda(i));</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> isempty(pos)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        idx1(i) = </span><span style=color:#005cc5;--shiki-dark:#79B8FF>NaN</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    else</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        idx0(i) = pos;</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        idx1(i) = i;</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    end</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>end</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>pos = isnan(idx1);  idx1(pos) = [];</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>test_lambda = test_lambda(idx1); test_Rrs = test_Rrs(:,idx1);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_lambda = ref_lambda(idx0); ref_nRrs = ref_nRrs(:,idx0); </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>upB = upB(:,idx0); lowB = lowB(:,idx0); </span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% match the ref_nRrs and test_Rrs</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% keep the original value</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>test_Rrs_orig = test_Rrs;</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% nromalization</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[inRow, inCol] = size(test_Rrs);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% transform spectrum to column, inCol*inRow</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>test_Rrs = test_Rrs</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>test_Rrs_orig = test_Rrs_orig</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*inRow</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs_denom=sqrt(nansum(test_Rrs.^2));</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs_denom = repmat(nRrs_denom,[inCol,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs = test_Rrs./nRrs_denom;  </span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% SAM input, inCol*inRow*refRow </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>test_Rrs2 = repmat(test_Rrs_orig,[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,refRow]);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%for ref Rrs, inCol*refRow*inRow </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>test_Rrs2p = permute(test_Rrs2,[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*inRow*refRow  </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs2_denom=sqrt(nansum(test_Rrs2.^2));</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs2_denom = repmat(nRrs2_denom,[inCol,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs2 = test_Rrs2./nRrs2_denom;  </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*refRow*inRow  </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nRrs2 = permute(nRrs2,[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% adjust the ref_nRrs, according to the matched wavebands</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%[row, ~] = size(ref_nRrs);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%%%% re-normalize the ref_adjusted</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs = ref_nRrs</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*refRow*inRow </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs2 = repmat(ref_nRrs,[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,inRow]);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*refRow*inRow </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs2_denom=sqrt(nansum(ref_nRrs2.^2));</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs2_denom = repmat(ref_nRrs2_denom,[inCol,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs_corr2 = ref_nRrs2./ref_nRrs2_denom;</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% Classification </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%%%% calculate the Spectral angle mapper</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*refRow*inRow </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>cos_denom=sqrt(nansum(ref_nRrs_corr2.^2).*nansum(nRrs2.^2));</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>cos_denom = repmat(cos_denom,[inCol,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>cos = (ref_nRrs_corr2.*nRrs2)./cos_denom; </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% 1*refRow*inRow </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>cos = sum(cos);</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% refRow*inRow</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>cos = permute(cos,[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% 1*inRow</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[maxCos,clusterID] = max(cos);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>posClusterID = isnan(maxCos);</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%potential bug for vectorized code</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%clusterID(pos) = NaN;</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% if isnan(cos)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     clusterID = NaN;</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% else</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%     clusterID = find(cos==maxCos);</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% end</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% scoring</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>upB_corr = upB</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>; </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lowB_corr = lowB</span><span style=color:#d73a49;--shiki-dark:#F97583>'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>; </span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%% comparison</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>% inCol*inRow</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>upB_corr2 = upB_corr(:,clusterID).*(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>+</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.005</span><span style=color:#24292e;--shiki-dark:#E1E4E8>);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lowB_corr2 = lowB_corr(:,clusterID).*(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.005</span><span style=color:#24292e;--shiki-dark:#E1E4E8>);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs2 = ref_nRrs(:,clusterID);</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%normalization</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs2_denom=sqrt(nansum(ref_nRrs2.^2));</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ref_nRrs2_denom = repmat(ref_nRrs2_denom,[inCol,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>upB_corr2 = upB_corr2 </span><span style=color:#d73a49;--shiki-dark:#F97583>./</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ref_nRrs2_denom;</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lowB_corr2 = lowB_corr2 </span><span style=color:#d73a49;--shiki-dark:#F97583>./</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ref_nRrs2_denom;</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>upB_diff = upB_corr2 </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nRrs;</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lowB_diff = nRrs </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8> lowB_corr2;</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>C = zeros(inCol,inRow);</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>pos = find( upB_diff>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#d73a49;--shiki-dark:#F97583> &#x26;</span><span style=color:#24292e;--shiki-dark:#E1E4E8> lowB_diff>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8> );</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>C(pos) = </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>%process all NaN spectral </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>C(:,posClusterID)=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>NaN</span><span style=color:#24292e;--shiki-dark:#E1E4E8>;                                               </span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>totScore = nanmean(C) ;  </span></span></code></pre></div><h2 id=annotation>Annotation<a href=#annotation class=heading-anchor-link aria-label="Link to Annotation"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>I believe this is actually not the true evaluation that do not need any ‘in-situ’ data.</p><p>It should met a lot of problem when applied it to other regions and sensors.</p><p>I need to modify the former code if I want to use it in the evaluation of fusion result.</p><h1 id=a-hybrid-algorithm-for-estimating-the-chlorophyll-a-concentration-across-different-trophic-states-in-asian-inland-waters>A hybrid algorithm for estimating the chlorophyll-<em>a</em> concentration across different trophic states in Asian inland waters<a href=#a-hybrid-algorithm-for-estimating-the-chlorophyll-a-concentration-across-different-trophic-states-in-asian-inland-waters class=heading-anchor-link aria-label="Link to A hybrid algorithm for estimating the chlorophyll-a concentration across different trophic states in Asian inland waters"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><figure><img alt=image-00030115201801830 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115201801830.png><figcaption>image-00030115201801830</figcaption></figure><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>M</mi><mi>C</mi><mi>I</mi><mo>≤</mo><mn>0.001</mn></mrow><annotation encoding=application/x-tex>MCI\le0.001</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8193em;vertical-align:-.136em></span><span class="mord mathnormal" style=margin-right:.07153em>MC</span><span class="mord mathnormal" style=margin-right:.07847em>I</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>0.001</span></span></span></span> Slightly turbid</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0.001</mn><mo>&#x3C;</mo><mi>M</mi><mi>C</mi><mi>I</mi><mo>≤</mo><mn>0.0016</mn></mrow><annotation encoding=application/x-tex>0.001&#x3C;MCI\le0.0016</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6835em;vertical-align:-.0391em></span><span class=mord>0.001</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&#x3C;</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.8193em;vertical-align:-.136em></span><span class="mord mathnormal" style=margin-right:.07153em>MC</span><span class="mord mathnormal" style=margin-right:.07847em>I</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>0.0016</span></span></span></span> Moderate turbid</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>M</mi><mi>C</mi><mi>I</mi><mo>></mo><mn>0.0016</mn></mrow><annotation encoding=application/x-tex>MCI>0.0016</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7224em;vertical-align:-.0391em></span><span class="mord mathnormal" style=margin-right:.07153em>MC</span><span class="mord mathnormal" style=margin-right:.07847em>I</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>0.0016</span></span></span></span> Highly turbid</p><h1 id=optical-water-type-discrimination-and-tuning-remote-sensing-band-ratio-algorithms-application-to-retrieval-of-chlorophyll-and-kd490-in-the-irish-and-celtic-seas>Optical water type discrimination and tuning remote sensing band-ratio algorithms: Application to retrieval of chlorophyll and <em>K</em>d(490) in the Irish and Celtic Seas<a href=#optical-water-type-discrimination-and-tuning-remote-sensing-band-ratio-algorithms-application-to-retrieval-of-chlorophyll-and-kd490-in-the-irish-and-celtic-seas class=heading-anchor-link aria-label="Link to Optical water type discrimination and tuning remote sensing band-ratio algorithms: Application to retrieval of chlorophyll and Kd(490) in the Irish and Celtic Seas"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><figure><img alt=image-00030115202628690 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115202628690.png><figcaption>image-00030115202628690</figcaption></figure><p>This is a very very emprical classification.</p><h1 id=influence-of-a-red-band-based-water-classification-approach-on-chlorophyll-algorithms-for-optically-complex-estuarie>Influence of a red band-based water classification approach on chlorophyll algorithms for optically complex estuarie<a href=#influence-of-a-red-band-based-water-classification-approach-on-chlorophyll-algorithms-for-optically-complex-estuarie class=heading-anchor-link aria-label="Link to Influence of a red band-based water classification approach on chlorophyll algorithms for optically complex estuarie"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><figure><img alt=image-00030115202825460 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115202825460.png><figcaption>image-00030115202825460</figcaption></figure><p>I can try this. Along with the Chia/TSM ratio</p><h1 id=a-soft-classification-based-chlorophyll-a-estimation-method-using-meris-data-in-the-highly-turbid-and-eutrophic-taihu-lake>A soft-classification-based chlorophyll-<em>a</em> estimation method using MERIS data in the highly turbid and eutrophic Taihu Lake<a href=#a-soft-classification-based-chlorophyll-a-estimation-method-using-meris-data-in-the-highly-turbid-and-eutrophic-taihu-lake class=heading-anchor-link aria-label="Link to A soft-classification-based chlorophyll-a estimation method using MERIS data in the highly turbid and eutrophic Taihu Lake"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p><img alt="" src=https://ars.els-cdn.com/content/image/1-s2.0-S0303243417303148-gr2_lrg.jpg></p><p>SGLI didn’t have red edge wavelength, which introduced a lot of problem in this work.</p><p><a href=https://www.sciencedirect.com/topics/earth-and-planetary-sciences/phytoplankton rel="nofollow noopener noreferrer external" target=_blank>Phytoplankton</a> pigments cause high reflectance in red edge wavelengths (<em>e.g.</em> 709 nm), and low reflectance in red wavelengths (<em>e.g.</em> 681 nm) because of the phytoplankton pigment absorption peak around 681 nm.</p><h1 id=an-improved-optical-classification-scheme-for-the-ocean-colour-essential-climate-variable-and-its-applications>An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications<a href=#an-improved-optical-classification-scheme-for-the-ocean-colour-essential-climate-variable-and-its-applications class=heading-anchor-link aria-label="Link to An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>其实这个并不能算是OWT->inversion/estimation</p><p>只是先用FCM划分了分类，然后假定模型在每类的error是一样的，最后通过每一类的error来给一个error estimation</p><h1 id=optical-types-of-inland-and-coastal-waters>Optical types of inland and coastal waters<a href=#optical-types-of-inland-and-coastal-waters class=heading-anchor-link aria-label="Link to Optical types of inland and coastal waters"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>这篇文章真的是我感觉非常理想的文章了，因为他们非常理想的讲了OWT里面都是由什么构成的</p><figure><img alt=image-00030402161611706 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402161611706.png><figcaption>image-00030402161611706</figcaption></figure><figure><img alt=image-00030402162450657 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402162450657.png><figcaption>image-00030402162450657</figcaption></figure><p>这个13是按照给Inland water分类的，所以会有很严重的蓝藻的东西，</p><p>然后Coastal他们分了9类，但是没有给出解释之类的。</p><figure><img alt=image-00030402162603375 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402162603375.png><figcaption>image-00030402162603375</figcaption></figure><p>讲了给提供数据，但是链接打不开。</p><figure><img alt=image-00030402164934583 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402164934583.png><figcaption>image-00030402164934583</figcaption></figure><p>这个地方是讲怎么Match的</p><p>L2 norm distance 是基于Vector 的Euclidean distance</p><figure><img alt=image-00030402172203229 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172203229.png><figcaption>image-00030402172203229</figcaption></figure><p>至于这个Norm?我查了查似乎并不是规范化的意思。</p><p>然后这个是全Dataset的Cluster结果。</p><figure><img alt=image-00030402172450000 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172450000.png><figcaption>image-00030402172450000</figcaption></figure><p>这个其实也害不错，但是就是没有讲这个大类里面每一种到底是什么样的。</p><figure><img alt=image-00030402172636127 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172636127.png><figcaption>image-00030402172636127</figcaption></figure><h2 id=a-global-approach-for-chlorophyll-a-retrieval-across-optically-complex-inland-waters-based-on-optical-water-type>A global approach for chlorophyll-a retrieval across optically complex inland waters based on optical water type<a href=#a-global-approach-for-chlorophyll-a-retrieval-across-optically-complex-inland-waters-based-on-optical-water-type class=heading-anchor-link aria-label="Link to A global approach for chlorophyll-a retrieval across optically complex inland waters based on optical water type"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>这个是根据上一篇的结果做出来的。</p><figure><img alt=image-00030402172912120 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172912120.png><figcaption>image-00030402172912120</figcaption></figure><p>然后在ACIX-Aqua李只选用了其中几个。</p><h1 id=remote-estimation-of-chlorophyll-a-concentrations-over-a-wide-range-of-optical-conditions-based-on-water-classification-from-viirs-observations>Remote estimation of chlorophyll a concentrations over a wide range of optical conditions based on water classification from VIIRS observations<a href=#remote-estimation-of-chlorophyll-a-concentrations-over-a-wide-range-of-optical-conditions-based-on-water-classification-from-viirs-observations class=heading-anchor-link aria-label="Link to Remote estimation of chlorophyll a concentrations over a wide range of optical conditions based on water classification from VIIRS observations"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>这个是算Chla的，但是好的地方在于这个文章给了一个非常清晰的怎么分类的过程。</p><figure><img alt=image-00030402173332530 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173332530.png><figcaption>image-00030402173332530</figcaption></figure><figure><img alt=image-00030402173357960 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173357960.png><figcaption>image-00030402173357960</figcaption></figure><figure><img alt=image-00030402173419427 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173419427.png><figcaption>image-00030402173419427</figcaption></figure><p>An absorption-related optical classification approach was developed by considering the contributions of different particle sources, aph(443)/ ad(443) (Table 3), to divide the study sites into three water classes, i.e., detritus-dominated waters (aph(443)/ad(443) &#x3C; 0.2, Wd), pigment- dominated waters (aph(443)/ad(443) ≥ 1.0, Wp) and intermediate waters (0.2 ≤ aph(443)/ad(443) &#x3C; 1.0, Wm),</p><p>自己可以尝试一下。</p><h1 id=remotely-estimating-total-suspended-solids-concentration-in-clear-to-extremely-turbid-waters-using-a-novel-semi-analytical-method>Remotely estimating total suspended solids concentration in clear to extremely turbid waters using a novel semi-analytical method<a href=#remotely-estimating-total-suspended-solids-concentration-in-clear-to-extremely-turbid-waters-using-a-novel-semi-analytical-method class=heading-anchor-link aria-label="Link to Remotely estimating total suspended solids concentration in clear to extremely turbid waters using a novel semi-analytical method"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>这个是我最近特别喜欢的一篇文章。</p><p>果然还是中国人理解中国人。</p><p>而且这个用的是QAA</p><p>他的做Simulation和Rrs correction的过程也特别值得一看。</p><figure><img alt=image-00030402173740967 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173740967.png><figcaption>image-00030402173740967</figcaption></figure><p>I 560</p><p>II 665</p><p>III 754</p><p>IV 865</p><p>这个可以保证算出来的bbp是准确的</p><figure><img alt=image-00030402173903360 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173903360.png><figcaption>image-00030402173903360</figcaption></figure><p>虽然没有提到bbp shape的事情。</p><div id=post-copyright></div><div class="mt-12.6 uno-decorative-line"></div><div class="flex flex-wrap gap-x-3 gap-y-3.2 no-heti"><a href="/tags/Inherent Optical Properties/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Inherent Optical Properties </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Inherent Optical Properties </span></a><a href="/tags/Ocean Color/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Ocean Color </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Ocean Color </span></a><a href="/tags/Ocean Optics/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Ocean Optics </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Ocean Optics </span></a><a href="/tags/Research Basis/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Research Basis </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Research Basis</span></a></div></div></article></main><footer class="leading-1.25em font-navbar lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=/atom.xml/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>RSS</a>&nbsp;/ <a href=https://github.com/lifeodyssey class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:email@radishzz.cc class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;</p><p>© 2025-2026 周大侠</p><p>Powered by <a href=https://astro.build/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><div class="flex absolute gap-6 lg:bottom-[min(10.27rem+1.92vw,12rem)] lg:fixed lg:right-[max(5rem,calc(50vw-35rem))] lg:top-auto lg:w-14rem min-[823px]:max-lg:right-[calc(50vw-22rem)] right-7.25vw top-14.6"><a href=/posts/696b3f33.html.html/ class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" aria-label="Switch website language" id=language-switcher><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M19.18 21.1 12.4 1.89h-1.21L4.52 21.1l-2.53.2v.81h6.37v-.81l-2.83-.2 2.02-5.97h7.58l2.02 5.97-3.34.2v.81H22v-.81l-2.83-.2zM7.85 14.33l3.44-10.21 3.54 10.21z"/></svg> </a><button aria-label="Switch light/dark theme" class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" id=theme-toggle-button><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M12.06.61C5.66.61.46 5.71.46 12.11s5.1 11.5 11.6 11.5 11.5-5.1 11.5-11.5S18.46.61 12.06.61m0 21c-6.07 0-10.94-4.2-10.94-9.5s4.87-9.4 10.94-9.4S23 6.91 23 12.21s-4.88 9.4-10.94 9.4"/></svg></button></div><script>!function(){const e="oklch(96% 0.005 298)",t="oklch(22% 0.005 298)";function n(n){document.documentElement.classList.toggle("dark",n);const o=document.head.querySelector('meta[name="theme-color"]');o&&e&&t&&o.setAttribute("content",n?t:e),localStorage.setItem("theme",n?"dark":"light"),document.dispatchEvent(new Event("theme-changed"))}function o(){n(!document.documentElement.classList.contains("dark"))}document.addEventListener("click",(function(e){const t=e.target instanceof Element?e.target:null,n=t?.closest("#theme-toggle-button");if(!n)return;if(document.documentElement.classList.contains("reduce-motion"))return void o();document.documentElement.style.setProperty("view-transition-name","animation-theme-toggle"),document.documentElement.setAttribute("data-theme-changing",""),document.startViewTransition(o).finished.then((()=>{document.documentElement.style.removeProperty("view-transition-name"),document.documentElement.removeAttribute("data-theme-changing")}))}),{passive:!0}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{n(e.matches)}))}()</script><script type=module>const o={click:"tap",typing:"type"},l={[o.click]:.8,[o.typing]:.4},d=["#language-switcher","#theme-toggle-button"],f=[".el-input__inner",".el-textarea__inner","#wl-nick","#wl-mail","#wl-link","#wl-edit"],h=new Set(["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"]),p=d.join(","),g=f.join(",");function r(){return window.matchMedia("(max-width: 1023px)").matches}function w(){return document.head.querySelector('link[rel="sitemap"]')?.getAttribute("href")?.replace("/sitemap-index.xml","")||""}class y{audioContext=null;audioBuffers={[o.click]:[],[o.typing]:[]};initPromise=null;async fetchAndCacheSound(t,e){if(!this.audioContext)throw new Error("Audio context not initialized");const n=`${t}_0${e+1}`,i=await(await fetch(`${w()}/sounds/${n}.wav`)).arrayBuffer(),a=await this.audioContext.decodeAudioData(i);this.audioBuffers[t].push(a)}async preloadAllSounds(){const t=Object.values(o).flatMap((t=>Array.from({length:5},((e,n)=>this.fetchAndCacheSound(t,n)))));await Promise.allSettled(t)}async initialize(){return this.initPromise??=(async()=>{const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,await this.preloadAllSounds()})()}async playSound(t){try{if(await this.initialize(),!this.audioContext)return;"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=this.audioBuffers[t];if(0===e.length)return;const n=this.audioContext.createBufferSource();n.buffer=e[Math.floor(Math.random()*e.length)];const i=this.audioContext.createGain();i.gain.value=l[t],n.connect(i).connect(this.audioContext.destination),n.start(0)}catch(t){console.warn("Sound playback failed:",t)}}}const c=new y;function m(t){r()||!t.target?.closest(p)||c.playSound(o.click)}function x(t){r()||t.ctrlKey||t.altKey||t.metaKey||h.has(t.key)||!t.target?.closest(g)||c.playSound(o.typing)}document.addEventListener("click",m,{passive:!0}),document.addEventListener("keydown",x,{passive:!0})</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},o=new WeakMap;function r(){const e=document.querySelectorAll(".code-copy-button");0!==e.length&&e.forEach((e=>{e.innerHTML=s.copy}))}async function a(e){if(e.classList.contains("copy-success"))return;const t=e.parentElement?.querySelector("pre code"),n=t?.textContent??"";if(t&&n)try{await navigator.clipboard.writeText(n);const t=o.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const c=setTimeout((()=>{e.isConnected&&(e.innerHTML=s.copy,e.classList.remove("copy-success"),o.delete(e))}),1500);o.set(e,c)}catch(e){console.error("Failed to copy code",e)}}function l(e){const t=e.target instanceof Element&&e.target.closest(".code-copy-button");t&&a(t)}document.addEventListener("astro:page-load",r),document.addEventListener("click",l,{passive:!0}),r()</script><script type=module>async function p(t){const e=t.dataset.repo;if(!e)return;const o=t.getElementsByClassName("gc-owner-avatar")[0],n=t.getElementsByClassName("gc-repo-description")[0],s=t.getElementsByClassName("gc-stars-count")[0],a=t.getElementsByClassName("gc-forks-count")[0],r=t.getElementsByClassName("gc-license-info")[0];function c(t){const e=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1});o&&t.owner?.avatar_url&&(o.style.backgroundImage=`url(${t.owner.avatar_url})`),n&&(n.textContent=t.description??"No description"),s&&(s.textContent=e.format(t.stargazers_count??0)),a&&(a.textContent=e.format(t.forks_count??0)),r&&(r.textContent=t.license?.spdx_id??"No License")}const i=`github-repo-${e}`,m=sessionStorage.getItem(i);if(m){c(JSON.parse(m))}else try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok){if(n){const e=404===t.status?"Repository not found":"Failed to load repository data";n.textContent=e}return}const o=await t.json();sessionStorage.setItem(i,JSON.stringify(o)),c(o)}catch(t){console.error(`Failed to fetch ${e}:`,t)}}function f(){const t=document.getElementsByClassName("gc-container");0!==t.length&&Array.from(t).forEach((t=>{p(t)}))}document.addEventListener("astro:page-load",f),f()</script><script type=module src=/_astro/MediaEmbed.astro_astro_type_script_index_0_lang.wKrCMCCr.js></script><script type=module>const n={overlay:document.querySelector(".zoom-overlay"),zoomedImg:null,originalImg:null,createOverlay(){this.overlay&&this.overlay.isConnected||(this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-label","Image Viewer"),this.overlay.setAttribute("tabindex","-1"),Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",backgroundColor:"oklch(var(--un-preset-theme-colors-background) / 0.95)",opacity:"0",transition:"opacity 300ms cubic-bezier(0.4, 0, 0.2, 1)",cursor:"zoom-out",display:"none"}),document.body.appendChild(this.overlay))},zoomImg(e){if(!this.overlay)return;document.body.style.overflow="hidden";const t=e.getBoundingClientRect();this.originalImg=e,this.zoomedImg=e.cloneNode(),Object.assign(this.zoomedImg.style,{position:"fixed",top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",zIndex:"1000",cursor:"zoom-out"}),document.body.appendChild(this.zoomedImg),this.overlay.style.display="block",this.overlay.focus();const o=window.innerWidth,i=window.innerHeight,s=window.innerWidth<768?1:.8,l=Math.min(o*s/t.width,i*s/t.height),a=(-t.left+(o-t.width)/2)/l,n=(-t.top+(i-t.height)/2)/l;requestAnimationFrame((()=>{this.overlay&&(this.overlay.style.opacity="1"),this.zoomedImg&&(this.zoomedImg.style.transform=`scale(${l}) translate3d(${a}px, ${n}px, 0)`)}))},close(){!this.overlay||!this.zoomedImg||!this.originalImg||(this.zoomedImg.style.transform="",this.overlay.style.opacity="0",document.body.style.overflow="",setTimeout((()=>{this.zoomedImg&&this.zoomedImg.parentNode&&document.body.removeChild(this.zoomedImg),this.zoomedImg=null,this.overlay&&(this.overlay.style.display="none"),this.originalImg&&this.originalImg.focus(),this.originalImg=null}),300))},setupOverlay(){this.createOverlay(),this.zoomedImg=null,this.originalImg=null},handleClick(e){if(this.zoomedImg)return void this.close();const t=e.target;t instanceof HTMLImageElement&&t.complete&&t.naturalWidth>=100&&t.naturalHeight>=100&&this.zoomImg(t)},handleResize(){this.zoomedImg&&this.close()},init(){this.createOverlay(),document.addEventListener("astro:page-load",(()=>this.setupOverlay())),document.addEventListener("click",(e=>this.handleClick(e)),{passive:!0}),window.addEventListener("resize",(()=>this.handleResize()),{passive:!0})}};n.init()</script></body></html>
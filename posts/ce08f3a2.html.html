<!DOCTYPE html><html class="font-sans scroll-smooth" lang=zh-CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/favicon.svg rel=icon type=image/svg+xml><title>MODIS水色数据处理教程 | 乔克叔叔的床边故事</title><meta content="这个教程主要分为两部分：应用python分析MODIS水色遥感数据 SeaDAS OCSSW的安装与应用 2021.8.12更新SNAP相关 （最近来看这篇文章的小伙伴好多，可以跟我打个招呼让我认识一下同行么哈哈。邮箱zhenjiazhou..." name=description><meta content=周大侠 name=author><meta content="Astro v5.13.7" name=generator><meta content="oklch(96% 0.005 298)" name=theme-color><link href=/fonts/EarlySummer-VF-Split/EarlySummer-VF-Subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Black-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Bold-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-Italic-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=https://lifeodyssey.github.io/posts/ce08f3a2.html.html rel=canonical><link href=/sitemap-index.xml rel=sitemap><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=https://lifeodyssey.github.io rel=alternate hreflang=zh><link href=https://lifeodyssey.github.io/en/ rel=alternate hreflang=en><link href=https://lifeodyssey.github.io/ja/ rel=alternate hreflang=ja><meta content=article property=og:type><meta content=https://lifeodyssey.github.io/posts/ce08f3a2.html.html property=og:url><meta content="MODIS水色数据处理教程 | 乔克叔叔的床边故事" property=og:title><meta content="这个教程主要分为两部分：应用python分析MODIS水色遥感数据 SeaDAS OCSSW的安装与应用 2021.8.12更新SNAP相关 （最近来看这篇文章的小伙伴好多，可以跟我打个招呼让我认识一下同行么哈哈。邮箱zhenjiazhou..." property=og:description><meta content=https://lifeodyssey.github.io/og/ce08f3a2.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.1k2cUud7.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!!e&&"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",t?"oklch(22% 0.005 298)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t)}document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),e(),t()}()</script><link href=/_astro/_about_.Dzb1Me_E.css rel=stylesheet><link href=/_astro/_posts_slug_.CM85RmC-.css rel=stylesheet><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const tp={preserveBehavior:!1},ep=t=>{if("string"==typeof t)return[t,tp];const[e,n=tp]=t;return[e,{...tp,...n}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,e,r,o,i,a,s,c,d,p,l=t,u){function f(){u||(u=1,"/"==(s=(a.lib||"/~partytown/")+(a.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),o!=t?o.dispatchEvent(new CustomEvent("pt1",{detail:t})):(c=setTimeout(w,(null==a?void 0:a.fallbackTimeout)||1e4),e.addEventListener("pt0",h),i?y(1):r.serviceWorker?r.serviceWorker.register(s+(a.swPath||"partytown-sw.js"),{scope:s}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):w())))}function y(n){p=e.createElement(n?"script":"iframe"),t._pttab=Date.now(),n||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=s+"partytown-"+(n?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),e.querySelector(a.sandboxParent||"body").appendChild(p)}function w(n,r){for(h(),o==t&&(a.forward||[]).map((function(e){const[n]=ep(e);delete t[n.split(".")[0]]})),n=0;n<d.length;n++)(r=e.createElement("script")).innerHTML=d[n].innerHTML,r.nonce=a.nonce,e.head.appendChild(r);p&&p.parentNode.removeChild(p)}function h(){clearTimeout(c)}a=t.partytown||{},o==t&&(a.forward||[]).map((function(e){const[r,{preserveBehavior:o}]=ep(e);l=t,r.split(".").map((function(e,r,i){var a;l=l[i[r]]=r+1<i.length?l[i[r]]||(a=i[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(o){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,i);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(i,arguments),n}})()}))})),"complete"==e.readyState?f():(t.addEventListener("DOMContentLoaded",f),t.addEventListener("load",f))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-ce08f3a2-zh}@layer astro{::view-transition-old(post-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-ce08f3a2-zh}@layer astro{::view-transition-old(time-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-ce08f3a2-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-wif6pdce-3]{view-transition-name:site-title-zh}@layer astro{::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><body><div class="w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><header class="cjk:tracking-0.02em lg:uno-desktop-column lg:top-20 mb-10.8"><h2 class="c-secondary font-bold font-title lg:c-primary lg:mb-1.8 lg:mt-0 lg:text-9 mb-2.8 mt-3 text-5.375"><div class="inline-block box-content pr-1" data-astro-transition-scope=astro-wif6pdce-3 data-disable-theme-transition><a href=/ id=site-title-link>乔克叔叔的床边故事</a></div></h2></header><nav aria-label="Site Navigation" class="hidden cjk:tracking-0.02em font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,12.5rem)] lg:text-4 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">文章</a></li><li><a href=/tags/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">标签</a></li><li><a href=/about/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">关于</a></li><li><a href=/search/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Search</a></li></ul></nav><main class=mb-10><article class=heti><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function e(t){if(!(t.target instanceof Element?t.target:null)?.closest("#back-button"))return;if(window.history.length>1)return void window.history.back();const e=document.getElementById("site-title-link");e&&e.click()}document.addEventListener("click",e,{passive:!0})</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>MODIS水色数据处理教程</span></h1></div><div class="c-primary block font-time mb-17.2" data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition id=post-date><time datetime=2020-04-12>2020-04-12 </time><span class=ml-1.75>18 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="w-full h-12 relative" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>目录</span><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24" class="ml-4 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center aspect-square hidden w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#程序包及工作环境 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>程序包及工作环境</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#anaconda和-pycharm class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>Anaconda和 pycharm</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#环境创建 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>环境创建</a></li><li class=ml-8 data-astro-cid-v5otsao3><a href=#地理信息数据分析环境 class="highlight-hover no-heti toc-links-h4" data-astro-cid-v5otsao3>地理信息数据分析环境</a></li><li class=ml-8 data-astro-cid-v5otsao3><a href=#pycharm及jupyter插件 class="highlight-hover no-heti toc-links-h4" data-astro-cid-v5otsao3>pycharm及Jupyter插件</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#modis-数据读取重投影及绘图 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>MODIS 数据读取、重投影及绘图</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#程序加速 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>程序加速</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#安装 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>安装</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#seadas-安装 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>SeaDAS 安装</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#ocssw安装 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>OCSSW安装</a></li><li class=ml-8 data-astro-cid-v5otsao3><a href=#python环境设置 class="highlight-hover no-heti toc-links-h4" data-astro-cid-v5otsao3>Python环境设置</a></li><li class=ml-8 data-astro-cid-v5otsao3><a href=#安装-1 class="highlight-hover no-heti toc-links-h4" data-astro-cid-v5otsao3>安装</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#应用 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>应用</a></li></ul></nav></div></div><script type=module>let s=null,i=null;function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",c=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&c.set(e,t)}));let r=null;function l(t){t!==r&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),r=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}s=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=c.get(e);t&&l(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]}),Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>s?.observe(t)));const a=document.getElementById("post-copyright");a&&(i=new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),r=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}),i?.observe(a),n.length>0&&l(n[0]))}function m(){s?.disconnect(),i?.disconnect(),s=null,i=null}document.addEventListener("astro:after-swap",g),document.addEventListener("astro:before-swap",m),g()</script><div id=post-content><p>这个教程主要分为两部分：</p><ol><li>应用python分析MODIS水色遥感数据</li><li>SeaDAS OCSSW的安装与应用</li></ol><p>2021.8.12更新SNAP相关</p><p>（最近来看这篇文章的小伙伴好多，可以跟我打个招呼让我认识一下同行么哈哈。</p><p>邮箱<a href=mailto:zhenjiazhou0127@outlook.com>zhenjiazhou0127@outlook.com</a>，任何问题都可以，欢迎交流）</p><p>2022.2.11更新<a href=https://lifeodyssey.github.io/posts/182a5f48.html rel="nofollow noopener noreferrer external" target=_blank>后续</a></p><h1 id=应用python分析modis水色遥感数据>应用python分析MODIS水色遥感数据<a href=#应用python分析modis水色遥感数据 class=heading-anchor-link aria-label="Link to 应用python分析MODIS水色遥感数据"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><h2 id=程序包及工作环境>程序包及工作环境<a href=#程序包及工作环境 class=heading-anchor-link aria-label="Link to 程序包及工作环境"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>如果这个步骤你花了很久才搞定的话，去用R吧，我朋友想跟我学python的都让我劝退学R了。</p><h3 id=anaconda和-pycharm>Anaconda和 pycharm<a href=#anaconda和-pycharm class=heading-anchor-link aria-label="Link to Anaconda和 pycharm"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>Anaconda里涵盖了很多科学计算要用到的包，同时也给了一个很好用的包管理工具。下载地址<a href=https://www.anaconda.com/%EF%BC%9B%E5%A6%82%E6%9E%9C%E5%9C%A8%E5%9B%BD%E5%86%85%E7%9A%84%E8%AF%9D%EF%BC%8C%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%E6%B8%85%E5%8D%8E%E9%95%9C%E5%83%8F%E8%BF%9B%E8%A1%8C%E4%B8%8B%E8%BD%BDhttps://mirror.tuna.tsinghua.edu.cn/help/anaconda/%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E6%9B%B4%E6%8D%A2%E4%B8%BA%E5%9B%BD%E5%86%85%E6%BA%90https://www.cnblogs.com/yikemogutou/p/11396045.html%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://www.anaconda.com/；如果在国内的话，推荐使用清华镜像进行下载https://mirror.tuna.tsinghua.edu.cn/help/anaconda/，然后再更换为国内源https://www.cnblogs.com/yikemogutou/p/11396045.html。</a></p><p>下载完anaconda之后，打开anaconda navigator把Jupyter notebook(或者Jupyter lab)安装好，我个人通常会用这个用一张遥感数据进行程序的调试，然后在pycharm里改成批处理。</p><p>pycharm是一个编辑器，同时支持python,R和markdown。对于本菜鸡来说，这个编辑器可以很方便的打开Terminal和python console，添加TODO和利用git备份，最重要的是管理环境方便，不用每次都active啥啥啥。下载地址<a href=https://www.jetbrains.com/pycharm/%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://www.jetbrains.com/pycharm/。</a></p><h3 id=环境创建>环境创建<a href=#环境创建 class=heading-anchor-link aria-label="Link to 环境创建"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><h4 id=地理信息数据分析环境>地理信息数据分析环境<a href=#地理信息数据分析环境 class=heading-anchor-link aria-label="Link to 地理信息数据分析环境"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h4><p>打开pycharm，新建一个项目或者打开你之前的项目，然后preference-project interpreter-show all，右下角小加号添加一个python interpreter，选择Conda Environment，用你刚刚安装好的anaconda来创建一个新的环境。</p><p>结束之后回到编辑器界面，最下面有四个选项 TODO,Version Control,Terminal,Python Console。这四个东西和刚才那个project interpreter基本是我平时比较喜欢用pycharm的最主要原因了。在写程序时#TODO然后写上要做的事情，就可以在下面TODO页面里看到要做的东西;Version Control 可以提供本地或者github的版本控制，具体设置方法可以参考<a href=https://www.jetbrains.com/help/pycharm/manage-projects-hosted-on-github.html%EF%BC%9BTerminal%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AF%E4%B8%80%E4%B8%AAbash%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%98%AF%E5%9C%A8%E4%BD%A0%E5%88%9A%E6%89%8D%E5%88%9B%E5%BB%BA%E7%9A%84%E7%8E%AF%E5%A2%83%E9%87%8C%E9%9D%A2%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E5%8E%BB%E7%A1%AE%E8%AE%A4%E7%8E%AF%E5%A2%83%E5%95%A5%E7%9A%84%EF%BC%8C%E4%B9%9F%E4%B8%8D%E7%94%A8%E6%B7%BB%E5%8A%A0%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%EF%BC%8C%E5%B0%B1%E7%9B%B8%E5%BD%93%E4%BA%8E%E4%B8%80%E4%B8%AAanaconda rel="nofollow noopener noreferrer external" target=_blank>https://www.jetbrains.com/help/pycharm/manage-projects-hosted-on-github.html；Terminal其实就是一个bash，并且是在你刚才创建的环境里面，不需要去确认环境啥的，也不用添加全局变量，就相当于一个anaconda</a> prompt; python console就相当于一个命令行的python，在右上角绿色小三角附近点下拉菜单Edit configuration，然后选择run in python console，就可以在右边框里看到变量，比较适合我这种从matlab迁移过来的人。</p><p>先打开Terminal，依次运行</p><p><code>conda install -c conda-forge numpy h5py netcd4 opencv-python requests matplotlib pandas scipy scikit-learn</code></p><p><code>conda update -all</code></p><p>在这里一般不会出问题，-c conda-forge可以安装由大佬在开源社区里上传的程序包</p><p><code>conda install -c conda-forge pyresample</code></p><p>这里可能会遇到问题，这里有可能有两种问题，一个是C语言编译器的问题，下载安装Microsoft Visual Studio Community 2017然后再运行一下这句话就好了；另一种就是GDAL的问题。</p><p>GDAL(Geospatial Data Abstraction Library)是一个在X/MIT许可协议下的开源栅格空间数据转换库，可以参考大佬翻译的这份中文教程<a href=https://www.osgeo.cn/python_gdal_utah_tutorial/index.html%E6%9D%A5%E5%AD%A6%E4%B9%A0%E4%B8%80%E4%B8%8B%E3%80%82%E4%B9%8B%E5%89%8D%E7%94%B5%E8%84%91%E4%B8%8A%E6%B2%A1%E6%9C%89%E5%AE%89%E8%A3%85%E8%BF%87python%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%9C%E8%A5%BF%E7%9A%84%E8%AF%9D%E4%B8%80%E8%88%AC%E4%B8%8D%E4%BC%9A%E9%81%87%E5%88%B0%E8%BF%99%E4%B8%AA%E9%97%AE%E9%A2%98%E3%80%82%E5%A6%82%E6%9E%9C%E4%BD%A0%E6%98%AF%E5%9C%A8windows%E5%B9%B3%E5%8F%B0%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E6%8E%A8%E8%8D%90%E4%BD%A0%E6%9D%A5%E5%AE%89%E8%A3%85OSGeo4W%E6%9D%A5%E6%90%9E%E5%AE%9A%E8%BF%99%E4%B8%AA%E9%97%AE%E9%A2%98https://trac.osgeo.org/osgeo4w/%EF%BC%9B%E9%99%A4%E6%AD%A4%E4%B9%8B%E5%A4%96%EF%BC%8C%E8%BF%98%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%EF%BC%8C%E4%B8%80%E4%B8%AA%E6%98%AF%E4%BD%A0%E9%87%8D%E6%96%B0%E6%90%9E%E4%B8%AA%E7%8E%AF%E5%A2%83%EF%BC%8C%E4%B8%8D%E8%A6%81%E5%8A%A0%E5%85%A5%E4%B9%8B%E5%89%8D%E7%9A%84%E5%8C%85%E5%86%8D%E6%9D%A5%E5%AE%89%E8%A3%85%E4%B8%80%E6%AC%A1%EF%BC%8C%E5%8F%A6%E4%B8%80%E4%B8%AA%E6%98%AF%E4%B8%8B%E8%BD%BDwhl%E6%96%87%E4%BB%B6%E6%9D%A5%E5%AE%89%E8%A3%85%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://www.osgeo.cn/python_gdal_utah_tutorial/index.html来学习一下。之前电脑上没有安装过python相关的东西的话一般不会遇到这个问题。如果你是在windows平台，那么我推荐你来安装OSGeo4W来搞定这个问题https://trac.osgeo.org/osgeo4w/；除此之外，还有两种方法，一个是你重新搞个环境，不要加入之前的包再来安装一次，另一个是下载whl文件来安装。</a></p><p>记得每次装完新的都来个conda update -all。</p><p>最后</p><p><code>conda install -c conda-forge basemap basemape-data-hires</code></p><p><code>conda install -c conda-forge gdal</code></p><p><code>conda update -all</code></p><p>如果一切顺利，恭喜你完成了最麻烦的一步。</p><p>之后可以参照我之前写过的这篇文章里面的python包，<a href=https://lifeodyssey.github.io/post/3aa0ed1a.html rel="nofollow noopener noreferrer external" target=_blank>https://lifeodyssey.github.io/post/3aa0ed1a.html</a> ,这些包都安装之后基本够用了。</p><p>其实环境这个问题可以用Docker来解决，之前有看到过这个大佬<a href=https://zhuanlan.zhihu.com/p/108012664%E7%9A%84%E6%96%87%E7%AB%A0%EF%BC%8C%E6%88%91%E4%B9%9F%E8%BF%98%E5%9C%A8%E7%A0%94%E7%A9%B6%EF%BC%8C%E4%BA%89%E5%8F%96%E5%B0%BD%E5%BF%AB%E6%90%9E%E5%87%BA%E6%9D%A5%E4%B8%80%E4%B8%AA%E6%B0%B4%E8%89%B2%E4%BA%BA%E7%9A%84Docker%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://zhuanlan.zhihu.com/p/108012664的文章，我也还在研究，争取尽快搞出来一个水色人的Docker。</a></p><h4 id=pycharm及jupyter插件>pycharm及Jupyter插件<a href=#pycharm及jupyter插件 class=heading-anchor-link aria-label="Link to pycharm及Jupyter插件"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h4><p>这个是属于个人喜好。</p><p>在pycharm-preference-plugins里可以安装插件，我安装了.*ignore,Dart,Kite和Material Theme UI，因为我有的时候还会用R，虽然R studio更好用，但是我也装了R Language for IntelliJ这个，来进行一些小的调试。</p><p>Jupyter个人一般只用来学习新的知识、调试和改bug，或者用来教别人的时候用，所以我这里用的还是Jupyter notebook,没有升级到Jupyterlab，安装教程可见<a href=https://github.com/ipython-contrib/jupyter_contrib_nbextensions%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://github.com/ipython-contrib/jupyter_contrib_nbextensions。</a></p><p>在Terminal里依次输入</p><p><code>conda install -c conda-forge jupyter_contrib_nbextensions</code></p><p><code>jupyter contrib nbextension install --user</code></p><p><code>conda update -all</code></p><p>然后在Terminal里输入</p><p><code>Jupyter notebook</code></p><p>就可以看到浏览器里蹦出来一个Jupyter notebook</p><p>点开Configurable nbextensions中勾选variable inspector，然后随便新建一个notebook，点开那个小瞄准镜就可以看到变量了。我平时没事就只用这个了。</p><h2 id=modis-数据读取重投影及绘图>MODIS 数据读取、重投影及绘图<a href=#modis-数据读取重投影及绘图 class=heading-anchor-link aria-label="Link to MODIS 数据读取、重投影及绘图"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>数据的下载可以参考<a href=https://lifeodyssey.github.io/post/8636bca2.html rel="nofollow noopener noreferrer external" target=_blank>https://lifeodyssey.github.io/post/8636bca2.html</a></p><p>直接上我写的代码，造福千万家，但是希望你直接用的时候能够知其然也知其所以然。感谢实验室之前毕业的前辈给我提供的代码样本</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> netCDF4 </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nc4</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> numpy </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> collections </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> OrderedDict</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> geo_Collection </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> geo_web </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> gs</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#005cc5;--shiki-dark:#79B8FF> QAAV6</span><span style=color:#d73a49;--shiki-dark:#F97583> import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> QAAv6</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>minlat </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 32.5</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>minlon </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 130.5</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>maxlat </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 35</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>maxlon </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 136</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># area of full seto-inland sea</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.arange(minlon, maxlon, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.01</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)  </span><span style=color:#6a737d;--shiki-dark:#6A737D># 1 km grid,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>y </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.arange(maxlat, minlat, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.01</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>nc_file </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nc4.Dataset(filename, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'r'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lon </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nc_file.groups[</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'navigation_data'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].variables[</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'longitude'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>][:]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lat </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nc_file.groups[</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'navigation_data'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].variables[</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'latitude'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>][:]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>variables </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nc_file.groups[</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'geophysical_data'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].variables</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> i </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#24292e;--shiki-dark:#E1E4E8> variables:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    var </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> variables[i][:]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    np.where(var </span><span style=color:#d73a49;--shiki-dark:#F97583>&#x3C;=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, var, np.nan)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> i </span><span style=color:#d73a49;--shiki-dark:#F97583>!=</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'l2_flags'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        var_re, grid </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> gs.swath_resampling(var, lon, lat, x, y, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>5000</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)  </span><span style=color:#6a737d;--shiki-dark:#6A737D># 1 km grid</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        # var_re=var_re.filled()</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ma.is_mask(var_re):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            var_re.mask</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.ma.nomask</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            var_re[var_re</span><span style=color:#d73a49;--shiki-dark:#F97583>==-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>32767.0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.nan</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>         variables[i] </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var_re</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>     else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>            # var_re = var_re.filled()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          variables[i] </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lons </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> grid.lons</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>lats </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> grid.lats</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#以叶绿素为例</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>chl </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> variables[</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'chlor_a'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>plot_geo_image(chl, lon, lat, </span><span style=color:#e36209;--shiki-dark:#FFAB70>label</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'CHL [mg/m$^3$]'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>               title</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>os.path.basename(</span><span style=color:#e36209;--shiki-dark:#FFAB70>file</span><span style=color:#24292e;--shiki-dark:#E1E4E8>))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>ncfile.close()</span><span style=color:#6a737d;--shiki-dark:#6A737D>#一定要记得这句</span></span>
<span class=line></span>
<span class=line></span>
<span class=line></span></code></pre></div><p>同时给出这里面用到的两个子函数和QAA的代码。</p><p>（QAA的代码还需要一些改进）</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> pyresample</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> numpy </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> mpl_toolkits.basemap </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Basemap</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> matplotlib.pyplot </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> plt</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> matplotlib </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> colors</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> math</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> scipy.interpolate </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> RectSphereBivariateSpline</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> matplotlib.colors </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> LogNorm</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#from  deco import *</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> swath_resampling</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(src_data: np.ma.array, src_lon: np.array, src_lat: np.array,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                     trg_lon: np.array, trg_lat: np.array, search_radius: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>float</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#005cc5;--shiki-dark:#79B8FF> len</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(trg_lon.shape) </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        grid_def </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> pyresample.geometry.SwathDefinition(</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.meshgrid(trg_lon, trg_lat))</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        grid_def </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> pyresample.geometry.SwathDefinition(</span><span style=color:#e36209;--shiki-dark:#FFAB70>lons</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>trg_lon, </span><span style=color:#e36209;--shiki-dark:#FFAB70>lats</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>trg_lat)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #source grid with original swath data</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # if len(src_lon.shape) == 1:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #     swath_def = pyresample.geometry.SwathDefinition(*np.meshgrid(src_lon, src_lat,sparse=True))</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # else:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #     swath_def = pyresample.geometry.SwathDefinition(lons=src_lon, lats=src_lat)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    swath_def </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> pyresample.geometry.SwathDefinition(</span><span style=color:#e36209;--shiki-dark:#FFAB70>lons</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>src_lon, </span><span style=color:#e36209;--shiki-dark:#FFAB70>lats</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>src_lat)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # resample (here we use nearest. Bilinear, gaussian and custom defined methods are available)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # for more, visit https://pyresample.readthedocs.io/en/latest/</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    result </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> pyresample.kd_tree.resample_nearest(swath_def, src_data, grid_def, </span><span style=color:#e36209;--shiki-dark:#FFAB70>epsilon</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>                                                 fill_value</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.nan, </span><span style=color:#e36209;--shiki-dark:#FFAB70>radius_of_influence</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>search_radius)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> result, grid_def</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#@concurrent</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> plot_geo_image</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(sds: np.ma.array, lon: np.ndarray, lat: np.ndarray, log10: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>bool</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, title: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>str</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                   label: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>str</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                   caxis: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>list</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, lon_range: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>list</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, lat_range: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>list</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, save_image: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>str</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                   dpi: </span><span style=color:#005cc5;--shiki-dark:#79B8FF>int</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 400</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#005cc5;--shiki-dark:#79B8FF> len</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lon.shape) </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'MeshGridding...'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        lon, lat </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.meshgrid(lon, lat)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    lon_0 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (lon.min() </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> lon.max()) </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 2</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    lat_0 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (lat.min() </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> lat.max()) </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 2</span></span>
<span class=line></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#d73a49;--shiki-dark:#F97583>f</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Lat: [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>{</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lat.min()</span><span style=color:#d73a49;--shiki-dark:#F97583>:.3f</span><span style=color:#005cc5;--shiki-dark:#79B8FF>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>{</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lat.max()</span><span style=color:#d73a49;--shiki-dark:#F97583>:.3f</span><span style=color:#005cc5;--shiki-dark:#79B8FF>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>] | '</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>          f</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Lon: [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>{</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lon.min()</span><span style=color:#d73a49;--shiki-dark:#F97583>:.3f</span><span style=color:#005cc5;--shiki-dark:#79B8FF>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>{</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lon.max()</span><span style=color:#d73a49;--shiki-dark:#F97583>:.3f</span><span style=color:#005cc5;--shiki-dark:#79B8FF>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>] | '</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>          f</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'SDS: [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>{</span><span style=color:#24292e;--shiki-dark:#E1E4E8>sds.min()</span><span style=color:#d73a49;--shiki-dark:#F97583>:.3f</span><span style=color:#005cc5;--shiki-dark:#79B8FF>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>{</span><span style=color:#24292e;--shiki-dark:#E1E4E8>sds.max()</span><span style=color:#d73a49;--shiki-dark:#F97583>:.3f</span><span style=color:#005cc5;--shiki-dark:#79B8FF>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>]'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (lon_range </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>and</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (lat_range </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        m </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Basemap(</span><span style=color:#e36209;--shiki-dark:#FFAB70>llcrnrlon</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>min</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lon_range), </span><span style=color:#e36209;--shiki-dark:#FFAB70>llcrnrlat</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>min</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lat_range),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>                    urcrnrlon</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>max</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lon_range), </span><span style=color:#e36209;--shiki-dark:#FFAB70>urcrnrlat</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>max</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lat_range),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>                    resolution</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'f'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>lon_0</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lon_0, </span><span style=color:#e36209;--shiki-dark:#FFAB70>lat_0</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lat_0, </span><span style=color:#e36209;--shiki-dark:#FFAB70>projection</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'tmerc'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        m </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Basemap(</span><span style=color:#e36209;--shiki-dark:#FFAB70>llcrnrlon</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lon.min(), </span><span style=color:#e36209;--shiki-dark:#FFAB70>llcrnrlat</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lat.min(),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>                    urcrnrlon</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lon.max(), </span><span style=color:#e36209;--shiki-dark:#FFAB70>urcrnrlat</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lat.max(),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>                    resolution</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'f'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>lon_0</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lon_0, </span><span style=color:#e36209;--shiki-dark:#FFAB70>lat_0</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>lat_0, </span><span style=color:#e36209;--shiki-dark:#FFAB70>projection</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'tmerc'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    x2d, y2d </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> m(lon, lat)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    fig </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> plt.figure(</span><span style=color:#e36209;--shiki-dark:#FFAB70>figsize</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> m.aspect))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    ax </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> fig.add_axes([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.08</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7</span><span style=color:#24292e;--shiki-dark:#E1E4E8>], </span><span style=color:#e36209;--shiki-dark:#FFAB70>facecolor</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'white'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # changed to facecolor 8 October 2019</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (lon_range </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>and</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (lat_range </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        parallels </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.arange(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>min</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lat_range), </span><span style=color:#005cc5;--shiki-dark:#79B8FF>max</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lat_range), </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        meridians </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.arange(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>min</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lon_range), </span><span style=color:#005cc5;--shiki-dark:#79B8FF>max</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lon_range), </span><span style=color:#005cc5;--shiki-dark:#79B8FF>4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        parallels </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> meridians </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> caxis </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        cmn, cmx </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> min</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(caxis), </span><span style=color:#005cc5;--shiki-dark:#79B8FF>max</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(caxis)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        cmn, cmx </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> sds.min(), sds.max()</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # m.drawparallels(parallels, fontsize=10, linewidth=0.25, dashes=[7, 15],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #                  color='k', labels=[1, 0, 1, 1])</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # m.drawmeridians(meridians, fontsize=10, dashes=[7, 15],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #                  linewidth=0.3, color='k', labels=[1, 1, 0, 1])</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #ncl = 150</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #if log10 is True:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #    norm = colors.LogNorm(vmin=cmn, vmax=cmx)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #else:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>     #   bounds = np.linspace(cmn, cmx, ncl)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>     #   norm = colors.BoundaryNorm(boundaries=bounds, ncolors=ncl)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    p </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> m.pcolor(x2d, y2d, sds, </span><span style=color:#e36209;--shiki-dark:#FFAB70>vmin</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>cmn,</span><span style=color:#e36209;--shiki-dark:#FFAB70>vmax</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>cmx, </span><span style=color:#e36209;--shiki-dark:#FFAB70>cmap</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'jet'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> title </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        plt.title(title)</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # divider = make_axes_locatable(ax)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # cax = divider.append_axes('vertical', size="3%", pad=0.05)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #cax = plt.axes([cmn, 0, cmx])  # setup colorbar axes</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    cb </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> m.colorbar(p,</span><span style=color:#e36209;--shiki-dark:#FFAB70>location</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"right"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#e36209;--shiki-dark:#FFAB70>size</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"5%"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#e36209;--shiki-dark:#FFAB70>pad</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)  </span><span style=color:#6a737d;--shiki-dark:#6A737D># draw colorbar</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #if label is not None:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # cb.set_label("%s" % label)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # plt.sca(ax)  # make the original axes current again</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # plt.clim(cmn, cmx)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #unit='Elevation to the sea level'</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #cb.set_label(unit, rotation=270, labelpad=10.0, fontsize=10)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    cb.ax.tick_params(</span><span style=color:#e36209;--shiki-dark:#FFAB70>labelsize</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    m.drawcoastlines()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    m.drawcountries()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    m.fillcontinents()</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #plt.show()</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> save_image </span><span style=color:#d73a49;--shiki-dark:#F97583>is</span><span style=color:#d73a49;--shiki-dark:#F97583> not</span><span style=color:#005cc5;--shiki-dark:#79B8FF> None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        plt.savefig(save_image, </span><span style=color:#e36209;--shiki-dark:#FFAB70>dpi</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>dpi, </span><span style=color:#e36209;--shiki-dark:#FFAB70>facecolor</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'w'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>edgecolor</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'w'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>orientation</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'portrait'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        plt.show()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        plt.close()</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> creategrid</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(min_lon, max_lon, min_lat, max_lat, cell_size_deg, mesh</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#Output grid within geobounds and specifice cell size</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#cell_size_deg should be in decimal degrees’’’</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    min_lon </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> math.floor(min_lon)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    max_lon </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> math.ceil(max_lon)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    min_lat </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> math.floor(min_lat)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    max_lat </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> math.ceil(max_lat)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    lon_num </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (max_lon </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8> min_lon)</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>cell_size_deg</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    lat_num </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (max_lat </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8> min_lat)</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>cell_size_deg</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lons </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.zeros(lon_num) </span><span style=color:#6a737d;--shiki-dark:#6A737D># fill with lon_min</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lats </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.zeros(lat_num) </span><span style=color:#6a737d;--shiki-dark:#6A737D># fill with lon_max</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lons </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> grid_lons </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (np.assary(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>range</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lon_num))</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>cell_size_deg)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lats </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> grid_lats </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (np.assary(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>range</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(lat_num))</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>cell_size_deg)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lons, grid_lats </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.meshgrid(grid_lons, grid_lats)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lons </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ravel(grid_lons)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    grid_lats </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ravel(grid_lats)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #if mesh = True:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # grid_lons = grid_lons</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # grid_lats = grid_lats</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> grid_lons, grid_lats</span></span></code></pre></div><p>QAAv6</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> scipy.interpolate </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Akima1DInterpolator </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Akima</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> numpy </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> deco </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> math </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> m</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># wavelengths = {</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'OLI'   : [442.98, 482.49, 561.33, 654.61],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'MSI'   : [443.93, 496.54, 560.01, 664.45],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'OLCI'  : [411.3999939, 442.63000488, 490.07998657, 510.07000732, 560.05999756, 619.97998047, 664.85998535, 673.61999512, 681.15002441], # 9 band insitu</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'OLCI2' : [400, 412.5, 442.5, 490, 510, 560, 620, 665, 673.75, 681.25, 708.75, 753.75, 761.25, 764.375, 767.5, 778.75], # 16 band LUT</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'VI'    : [412.49, 444.17, 486.81, 549.99, 670.01],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'AER'   : [412, 442, 490, 530, 551, 668],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'MOSIA' : [412, 443, 469,488,531,547,555,645,667,678],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'GOCI'  : [412, 443, 490, 555, 660, 680],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     'SGLI'  : [380,412,443,490,530,565,673.5]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#}</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#@concurrent</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> QAAv6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(Rrs):</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #acording to Lee,QAAv6</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #write by Zhou,20191130</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #Input data need to be an arrary that contain 10 bands Rrs of MODIS,from short wavelength to long wavelength in a certain station</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #Output is a tuple, first array is aph,second array is bbp</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #use as import QAAV6</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B1: 412 nm 0</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B2: 443 nm 1</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B3: 469 nm 2</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B4: 488 nm 3</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B5: 531 nm 4</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B6: 547 nm 5</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B7: 555 nm 6</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B8: 645 nm 7</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B9: 667 nm 8</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># B10: 678 nm 9</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    Lambda</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.array([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>412</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>443</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>469</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>488</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>531</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>547</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>555</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>645</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>667</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>678</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    nbands</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.shape(Lambda)[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    IOPw</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.array([[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.003344468</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.004572564</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.00244466</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.00635</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.001910803</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.010483637</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.001609567</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.014361745</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.00111757</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.043747657</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.000983055</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.053262848</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.000923288</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.0595</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.000482375</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.325</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.00041731</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.433497423</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.00038884</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.457440162</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]])</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #     if(Rrs=np.nan):</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #     return np.nan</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # else:</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # bbw from Morel (1974).aw  from Pope and Fry (1997)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    bbp </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ones(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    adg </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ones(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    if</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(np.nan </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Rrs):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        bbp[:]</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.nan</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        bw</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>IOPw[:,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#6a737d;--shiki-dark:#6A737D>#backscaterring of pure water</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        aw</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>IOPw[:,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#6a737d;--shiki-dark:#6A737D>#absorption of pure water</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        rrs </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Rrs </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.52</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1.7</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Rrs)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        g0 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.089</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        g1 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.1245</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        u </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>g0 </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ((g0 </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 4</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> g1 </span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs) </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> g1)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        aph </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ones(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span><span style=color:#6a737d;--shiki-dark:#6A737D>#adg is the absorption of CDOM and NAP</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>&#x3C;</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.0015</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#6a737d;--shiki-dark:#6A737D>#select 555 as reference</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            r</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>550</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            p1</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            p2 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 5</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (((rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)) </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.log10(p1 </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> p2)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            ar </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> aw[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.power(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, (</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.146</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1.366</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.469</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (x </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)))</span><span style=color:#6a737d;--shiki-dark:#6A737D># step 2</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            bbpr</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>((u[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>ar)</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>u[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>bw[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#6a737d;--shiki-dark:#6A737D>#step3</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        else</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            r</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>670</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            p1 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (Rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            p2 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.39</span><span style=color:#d73a49;--shiki-dark:#F97583> *</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (p1 </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1.14</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            ar </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (aw[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> p2  </span><span style=color:#6a737d;--shiki-dark:#6A737D># step2</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            bbpr </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (u[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ar </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (u[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])) </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (bw[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))  </span><span style=color:#6a737d;--shiki-dark:#6A737D># step3</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        eta</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.2</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.exp(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.9</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))) </span><span style=color:#6a737d;--shiki-dark:#6A737D>#step4</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        zeta </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.74</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.2</span><span style=color:#d73a49;--shiki-dark:#F97583> /</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span><span style=color:#6a737d;--shiki-dark:#6A737D>#step 7&#x26;8</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        S </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.015</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.002</span><span style=color:#d73a49;--shiki-dark:#F97583> /</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.6</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rrs[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        xi </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.exp(S </span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>442.5</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 415.5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>))</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> i </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#005cc5;--shiki-dark:#79B8FF> range</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(nbands):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            bbp[i]</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> bbpr </span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.power(r</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>Lambda[i], eta)</span><span style=color:#6a737d;--shiki-dark:#6A737D>#step5</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        a </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ((</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8> u) </span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (bw </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> bbp)) </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> u</span><span style=color:#6a737d;--shiki-dark:#6A737D>#step6</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> i </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#005cc5;--shiki-dark:#79B8FF> range</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(nbands):</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            ag443</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>((a[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>zeta</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>a[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(xi</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>zeta))</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>((aw[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>zeta</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>aw[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(xi</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>zeta))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            adg[i]</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>ag443</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.exp(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>S</span><span style=color:#d73a49;--shiki-dark:#F97583>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(Lambda[i]</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>443</span><span style=color:#24292e;--shiki-dark:#E1E4E8>))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            aph[i]</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>a[i]</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>adg[i]</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>aw[i]</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> bbp,a</span></span>
<span class=line></span></code></pre></div><p>QAA的代码还需要很多的改进，目前正在参考<a href=https://github.com/BrandonSmithJ/band-adjustment%E8%BF%9B%E8%A1%8C%E6%94%B9%E8%BF%9B%EF%BC%8C%E6%AC%A2%E8%BF%8E%E5%90%8C%E8%A1%8C%E4%BA%A4%E6%B5%81%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://github.com/BrandonSmithJ/band-adjustment进行改进，欢迎同行交流。</a></p><h2 id=程序加速>程序加速<a href=#程序加速 class=heading-anchor-link aria-label="Link to 程序加速"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>因为python自己的问题，如果你要处理大量遥感图像的话会很慢，这个一方面是matplotlib自己出图慢，另一方面是因为没有充分利用多核cpu。</p><p>批量出图可以参考<a href=https://cloud.tencent.com/developer/article/1584962 rel="nofollow noopener noreferrer external" target=_blank>https://cloud.tencent.com/developer/article/1584962</a> 这篇文章。</p><p>解决多核cpu最好用的方法是并行。</p><p>像上面那个程序，用并行来加速的话可以这么写：</p><ol><li>把它改写成一个函数，一般是把文件名作为输入，或者是文件在datalist之中的顺序，我用的是后面这种。</li><li>a1=np.arange(len(datalist))，创建一个list，并行的时候传入的变量只能是list</li><li>将代码改写成如下样子</li></ol><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> multiprocessing </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> mp</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> main</span><span style=color:#24292e;--shiki-dark:#E1E4E8>()</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#这里是你刚才改写的程序</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>pool</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>mp.Pool(</span><span style=color:#e36209;--shiki-dark:#FFAB70>processes</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>7</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span><span style=color:#6a737d;--shiki-dark:#6A737D>#电脑8核，给自己空余了一个核用来处理其他任务</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>pool.map(main,a1)</span></span>
<span class=line></span></code></pre></div><p>可以先不做并行查看内存占用情况，如果有很多内存没用的话，开了并行一般都会提速，我的程序需要处理140张卫星图像，缩短到原来的1/3左右。</p><h1 id=seadas-ocssw的安装与应用>SeaDAS OCSSW的安装与应用<a href=#seadas-ocssw的安装与应用 class=heading-anchor-link aria-label="Link to SeaDAS OCSSW的安装与应用"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>SeaDAS是NASA出品的一个水色遥感处理软件，其中的OCSSW更是内置了很多美国发射的卫星的标准处理流程算法（欧洲的那几个用的SNAP，韩国的GOCI用的GDPS，日本的SGLI，也许哪天我用OLCI数据的时候会把SNAP的教程搞一下），我主要是用他的l2gen这个功能。OCSSW只能在Linux或者Mac OS系统下安装。下载地址<a href=https://seadas.gsfc.nasa.gov/%EF%BC%8C%E8%BF%99%E9%87%8C%E8%AE%B2Linux%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95%EF%BC%8C%E6%88%91%E7%94%A8%E7%9A%84%E6%98%AFUbuntu rel="nofollow noopener noreferrer external" target=_blank>https://seadas.gsfc.nasa.gov/，这里讲Linux系统下的安装方法，我用的是Ubuntu</a> 18.04LTS.</p><h2 id=安装>安装<a href=#安装 class=heading-anchor-link aria-label="Link to 安装"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>如果你像我一样肉身翻墙的话，那恭喜你真的是非常方便了。</p><h3 id=seadas-安装>SeaDAS 安装<a href=#seadas-安装 class=heading-anchor-link aria-label="Link to SeaDAS 安装"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>NASA官方的tutorial在<a href=https://seadas.gsfc.nasa.gov/tutorials/installation_tutorial/ rel="nofollow noopener noreferrer external" target=_blank>https://seadas.gsfc.nasa.gov/tutorials/installation_tutorial/</a></p><p>基本按照这个来就可以了，除了Java版本，我第一次装的时候用的是最新版Java，结果SeaDAS无法作为一个独立程序运行（就是在程序页面里找不到这个程序的图标？启动器？本Ubuntu菜鸡虚心求教），最后按照如下方法安装了Java8:</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>sudo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> add-apt-repository</span><span style=color:#032f62;--shiki-dark:#9ECBFF> ppa:ts.sch.gr/ppa</span><span style=color:#24292e;--shiki-dark:#E1E4E8> </span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>sudo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> apt-get</span><span style=color:#032f62;--shiki-dark:#9ECBFF> update</span><span style=color:#24292e;--shiki-dark:#E1E4E8> </span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>sudo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> apt-get</span><span style=color:#032f62;--shiki-dark:#9ECBFF> install</span><span style=color:#032f62;--shiki-dark:#9ECBFF> oracle-java8-installer</span></span></code></pre></div><h3 id=ocssw安装>OCSSW安装<a href=#ocssw安装 class=heading-anchor-link aria-label="Link to OCSSW安装"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><h4 id=python环境设置>Python环境设置<a href=#python环境设置 class=heading-anchor-link aria-label="Link to Python环境设置"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h4><p>我们一般现在用来干活的python一般都是3版本的，但是Ubuntu系统内置的python是2版本，SeaDAS OCSSW会使用默认的内置版本，所以在这里需要搞定一些程序库的问题（如果没搞好的话后面一般会显示你没有requests这个包）。</p><p>这时候就用到我刚才安装的Pycharm来手动管理了，打开pycharm-preference-Project Interpreter,如果你没有装别的东西的话，你的电脑里应该就只有几个python的解释器，你刚才通过anacoonda安装的是3版本，在Add Python Interpreter里面，系统自带的解释器一般会在Pipenv、System或者Virtualenv这里找到，通过路径判断出来哪个是系统自带的，创建一个新环境，然后在Terminal里安装requests这个包就可以了</p><h4 id=安装-1>安装<a href=#安装-1 class=heading-anchor-link aria-label="Link to 安装"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h4><p>完成这一步之后，如果你肉身翻墙或者依靠金钱的力量翻墙的话，就可以在GUI里面手动点选安装了；如果在国内，可以按照刚才放的官方的页面，把每个Bundle都下载下来离线安装。</p><h2 id=应用>应用<a href=#应用 class=heading-anchor-link aria-label="Link to 应用"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>我这里主要用的是l2gen这个函数，这里放一个在seadas forum找到然后自己修改的脚本</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># source /Users/zhenjia/.bash_profile </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#先运行上面这个文件来搞定全局变量</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#Example script to process L1A files up to L2, put in same directory as </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># your L1A files</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># Run script by typing on Terminal Command Line: </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># bash l1a_to_l2.sh input.txt</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># input.txt contains list of files [ create by: ls -1 *L1A_LAC* > input.txt ]</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>LIST</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#e36209;--shiki-dark:#FFAB70>$1</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [ </span><span style=color:#d73a49;--shiki-dark:#F97583>-z</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$LIST</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ]</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>  then</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "No input file list supplied"</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    exit</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>fi</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [[ </span><span style=color:#d73a49;--shiki-dark:#F97583>!</span><span style=color:#d73a49;--shiki-dark:#F97583> -a</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $LIST ]]; </span><span style=color:#d73a49;--shiki-dark:#F97583>then</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$LIST</span><span style=color:#032f62;--shiki-dark:#9ECBFF> does not exist!"</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    exit</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>fi</span></span>
<span class=line></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>mkdir</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -p</span><span style=color:#032f62;--shiki-dark:#9ECBFF> done</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>mkdir</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -p</span><span style=color:#032f62;--shiki-dark:#9ECBFF> l2_lac</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> FILE </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>cat</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $LIST);</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>do</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Working on </span><span style=color:#24292e;--shiki-dark:#E1E4E8>$FILE</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ${FILE}</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # get file basename (no file extension)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    BASE</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>`</span><span style=color:#6f42c1;--shiki-dark:#B392F0>basename</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $FILE</span><span style=color:#032f62;--shiki-dark:#9ECBFF> .L1A_LAC.x.hdf`</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ${BASE}</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    GEOFILE</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>${BASE}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>.GEO</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ${GEOFILE}</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    L1BFILE</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>${BASE}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>.L1B_LAC.x.hdf</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ${L1BFILE}</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    L2FILE</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>${BASE}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>.L2_LAC.x.hdf</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ${L2FILE}</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    ancfile</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>${BASE}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>.L1A_LAC.x.hdf.anc</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Creating GEOFILE </span><span style=color:#24292e;--shiki-dark:#E1E4E8>$GEOFILE</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    modis_GEO.py</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -v</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $FILE </span><span style=color:#005cc5;--shiki-dark:#79B8FF>-o</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $GEOFILE</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Creating L1B file"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    modis_L1B.py</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -v</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $FILE $GEOFILE</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Creating anc file"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    getanc.py</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -v</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $FILE</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Create L2 file"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    l2gen</span><span style=color:#032f62;--shiki-dark:#9ECBFF> ifile=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$L1BFILE </span><span style=color:#032f62;--shiki-dark:#9ECBFF>geofile=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$GEOFILE </span><span style=color:#032f62;--shiki-dark:#9ECBFF>ofile=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$L2FILE </span><span style=color:#032f62;--shiki-dark:#9ECBFF>par=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$ancfile </span><span style=color:#032f62;--shiki-dark:#9ECBFF>l2prod="Kd_490 Rrs_nnn angstrom aot_869 chlor_a ipar nLw_nnn nflh par pic poc rhos_nnn"</span><span style=color:#032f62;--shiki-dark:#9ECBFF> aer_opt=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>-2</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    echo</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Cleaning up"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    rm</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -v</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ${BASE}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>.L1B</span><span style=color:#005cc5;--shiki-dark:#79B8FF>*</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $GEOFILE $ancfile</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #mv -v $FILE done/</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    mv</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -v</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $L2FILE </span><span style=color:#032f62;--shiki-dark:#9ECBFF>l2_lac/</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>done</span></span>
<span class=line></span>
<span class=line></span></code></pre></div><h1 id=snap>SNAP<a href=#snap class=heading-anchor-link aria-label="Link to SNAP"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>最近ESA的SNAP宣布了对SeaDAS OCSSW的支持，这个不需要搞Linux系统啥的了，用起来方便很多。</p><p>下载地址：<a href=https://step.esa.int/main/download/snap-download/ rel="nofollow noopener noreferrer external" target=_blank>https://step.esa.int/main/download/snap-download/</a></p><p>下载安装之后在<a href=https://seadas.gsfc.nasa.gov/installers/snap-seadas-toolbox/ rel="nofollow noopener noreferrer external" target=_blank>这里</a>下载SeaDAS的插件。然后打开SNAP，打开Plugin Manager，在菜单中依次选择Tools —> Plugins—>Downloaded—> Add Plugins，定位到你解压好的插件的位置，选择好之后点Open，然后Install->finish即可。</p><p>顺带一提，SNAP还支持最近几个比较新的大气校正和IOP反演的算法插件，比如<a href=http://www.rtatmocn.com/oc-smart/ rel="nofollow noopener noreferrer external" target=_blank>OC-SMART</a>, <a href=https://gitlab.eumetsat.int/eumetlab/oceans/ocean-science-studies/olci-iop-processor/-/tree/master rel="nofollow noopener noreferrer external" target=_blank>3SAA</a>。</p><div id=post-copyright></div><div class="mt-12.6 uno-decorative-line"></div><div class="no-heti flex flex-wrap gap-x-3 gap-y-3.2"><a href=/tags/Research/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Research </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Research </span></a><a href="/tags/Ocean Color/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Ocean Color </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Ocean Color </span></a><a href=/tags/Oceanography/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Oceanography </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Oceanography </span></a><a href=/tags/MODIS/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">MODIS </span><span class="inline-block font-medium opacity-0" aria-hidden=true>MODIS </span></a><a href=/tags/大气校正/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">大气校正 </span><span class="inline-block font-medium opacity-0" aria-hidden=true>大气校正</span></a></div></div></article></main><footer class="leading-1.25em font-navbar lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=/atom.xml/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>RSS</a>&nbsp;/ <a href=https://github.com/lifeodyssey class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:email@radishzz.cc class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;</p><p>© 2025-2026 周大侠</p><p>Powered by <a href=https://astro.build/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><div class="flex absolute gap-6 lg:bottom-[min(10.27rem+1.92vw,12rem)] lg:fixed lg:right-[max(5rem,calc(50vw-35rem))] lg:top-auto lg:w-14rem min-[823px]:max-lg:right-[calc(50vw-22rem)] right-7.25vw top-14.6"><a href=/posts/ce08f3a2.html.html/ class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" aria-label="Switch website language" id=language-switcher><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M19.18 21.1 12.4 1.89h-1.21L4.52 21.1l-2.53.2v.81h6.37v-.81l-2.83-.2 2.02-5.97h7.58l2.02 5.97-3.34.2v.81H22v-.81l-2.83-.2zM7.85 14.33l3.44-10.21 3.54 10.21z"/></svg> </a><button aria-label="Switch light/dark theme" class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" id=theme-toggle-button><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M12.06.61C5.66.61.46 5.71.46 12.11s5.1 11.5 11.6 11.5 11.5-5.1 11.5-11.5S18.46.61 12.06.61m0 21c-6.07 0-10.94-4.2-10.94-9.5s4.87-9.4 10.94-9.4S23 6.91 23 12.21s-4.88 9.4-10.94 9.4"/></svg></button></div><script>!function(){const e="oklch(96% 0.005 298)",t="oklch(22% 0.005 298)";function n(n){document.documentElement.classList.toggle("dark",n);const o=document.head.querySelector('meta[name="theme-color"]');o&&e&&t&&o.setAttribute("content",n?t:e),localStorage.setItem("theme",n?"dark":"light"),document.dispatchEvent(new Event("theme-changed"))}function o(){n(!document.documentElement.classList.contains("dark"))}document.addEventListener("click",(function(e){const t=e.target instanceof Element?e.target:null,n=t?.closest("#theme-toggle-button");if(!n)return;if(document.documentElement.classList.contains("reduce-motion"))return void o();document.documentElement.style.setProperty("view-transition-name","animation-theme-toggle"),document.documentElement.setAttribute("data-theme-changing",""),document.startViewTransition(o).finished.then((()=>{document.documentElement.style.removeProperty("view-transition-name"),document.documentElement.removeAttribute("data-theme-changing")}))}),{passive:!0}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{n(e.matches)}))}()</script><script type=module>const o={click:"tap",typing:"type"},l={[o.click]:.8,[o.typing]:.4},d=["#language-switcher","#theme-toggle-button"],f=[".el-input__inner",".el-textarea__inner","#wl-nick","#wl-mail","#wl-link","#wl-edit"],h=new Set(["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"]),p=d.join(","),g=f.join(",");function r(){return window.matchMedia("(max-width: 1023px)").matches}function w(){return document.head.querySelector('link[rel="sitemap"]')?.getAttribute("href")?.replace("/sitemap-index.xml","")||""}class y{audioContext=null;audioBuffers={[o.click]:[],[o.typing]:[]};initPromise=null;async fetchAndCacheSound(t,e){if(!this.audioContext)throw new Error("Audio context not initialized");const n=`${t}_0${e+1}`,i=await(await fetch(`${w()}/sounds/${n}.wav`)).arrayBuffer(),a=await this.audioContext.decodeAudioData(i);this.audioBuffers[t].push(a)}async preloadAllSounds(){const t=Object.values(o).flatMap((t=>Array.from({length:5},((e,n)=>this.fetchAndCacheSound(t,n)))));await Promise.allSettled(t)}async initialize(){return this.initPromise??=(async()=>{const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,await this.preloadAllSounds()})()}async playSound(t){try{if(await this.initialize(),!this.audioContext)return;"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=this.audioBuffers[t];if(0===e.length)return;const n=this.audioContext.createBufferSource();n.buffer=e[Math.floor(Math.random()*e.length)];const i=this.audioContext.createGain();i.gain.value=l[t],n.connect(i).connect(this.audioContext.destination),n.start(0)}catch(t){console.warn("Sound playback failed:",t)}}}const c=new y;function m(t){r()||!t.target?.closest(p)||c.playSound(o.click)}function x(t){r()||t.ctrlKey||t.altKey||t.metaKey||h.has(t.key)||!t.target?.closest(g)||c.playSound(o.typing)}document.addEventListener("click",m,{passive:!0}),document.addEventListener("keydown",x,{passive:!0})</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},o=new WeakMap;function r(){const e=document.querySelectorAll(".code-copy-button");0!==e.length&&e.forEach((e=>{e.innerHTML=s.copy}))}async function a(e){if(e.classList.contains("copy-success"))return;const t=e.parentElement?.querySelector("pre code"),n=t?.textContent??"";if(t&&n)try{await navigator.clipboard.writeText(n);const t=o.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const c=setTimeout((()=>{e.isConnected&&(e.innerHTML=s.copy,e.classList.remove("copy-success"),o.delete(e))}),1500);o.set(e,c)}catch(e){console.error("Failed to copy code",e)}}function l(e){const t=e.target instanceof Element&&e.target.closest(".code-copy-button");t&&a(t)}document.addEventListener("astro:page-load",r),document.addEventListener("click",l,{passive:!0}),r()</script><script type=module>async function p(t){const e=t.dataset.repo;if(!e)return;const o=t.getElementsByClassName("gc-owner-avatar")[0],n=t.getElementsByClassName("gc-repo-description")[0],s=t.getElementsByClassName("gc-stars-count")[0],a=t.getElementsByClassName("gc-forks-count")[0],r=t.getElementsByClassName("gc-license-info")[0];function c(t){const e=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1});o&&t.owner?.avatar_url&&(o.style.backgroundImage=`url(${t.owner.avatar_url})`),n&&(n.textContent=t.description??"No description"),s&&(s.textContent=e.format(t.stargazers_count??0)),a&&(a.textContent=e.format(t.forks_count??0)),r&&(r.textContent=t.license?.spdx_id??"No License")}const i=`github-repo-${e}`,m=sessionStorage.getItem(i);if(m){c(JSON.parse(m))}else try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok){if(n){const e=404===t.status?"Repository not found":"Failed to load repository data";n.textContent=e}return}const o=await t.json();sessionStorage.setItem(i,JSON.stringify(o)),c(o)}catch(t){console.error(`Failed to fetch ${e}:`,t)}}function f(){const t=document.getElementsByClassName("gc-container");0!==t.length&&Array.from(t).forEach((t=>{p(t)}))}document.addEventListener("astro:page-load",f),f()</script><script type=module src=/_astro/MediaEmbed.astro_astro_type_script_index_0_lang.wKrCMCCr.js></script><script type=module>const n={overlay:document.querySelector(".zoom-overlay"),zoomedImg:null,originalImg:null,createOverlay(){this.overlay&&this.overlay.isConnected||(this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-label","Image Viewer"),this.overlay.setAttribute("tabindex","-1"),Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",backgroundColor:"oklch(var(--un-preset-theme-colors-background) / 0.95)",opacity:"0",transition:"opacity 300ms cubic-bezier(0.4, 0, 0.2, 1)",cursor:"zoom-out",display:"none"}),document.body.appendChild(this.overlay))},zoomImg(e){if(!this.overlay)return;document.body.style.overflow="hidden";const t=e.getBoundingClientRect();this.originalImg=e,this.zoomedImg=e.cloneNode(),Object.assign(this.zoomedImg.style,{position:"fixed",top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",zIndex:"1000",cursor:"zoom-out"}),document.body.appendChild(this.zoomedImg),this.overlay.style.display="block",this.overlay.focus();const o=window.innerWidth,i=window.innerHeight,s=window.innerWidth<768?1:.8,l=Math.min(o*s/t.width,i*s/t.height),a=(-t.left+(o-t.width)/2)/l,n=(-t.top+(i-t.height)/2)/l;requestAnimationFrame((()=>{this.overlay&&(this.overlay.style.opacity="1"),this.zoomedImg&&(this.zoomedImg.style.transform=`scale(${l}) translate3d(${a}px, ${n}px, 0)`)}))},close(){!this.overlay||!this.zoomedImg||!this.originalImg||(this.zoomedImg.style.transform="",this.overlay.style.opacity="0",document.body.style.overflow="",setTimeout((()=>{this.zoomedImg&&this.zoomedImg.parentNode&&document.body.removeChild(this.zoomedImg),this.zoomedImg=null,this.overlay&&(this.overlay.style.display="none"),this.originalImg&&this.originalImg.focus(),this.originalImg=null}),300))},setupOverlay(){this.createOverlay(),this.zoomedImg=null,this.originalImg=null},handleClick(e){if(this.zoomedImg)return void this.close();const t=e.target;t instanceof HTMLImageElement&&t.complete&&t.naturalWidth>=100&&t.naturalHeight>=100&&this.zoomImg(t)},handleResize(){this.zoomedImg&&this.close()},init(){this.createOverlay(),document.addEventListener("astro:page-load",(()=>this.setupOverlay())),document.addEventListener("click",(e=>this.handleClick(e)),{passive:!0}),window.addEventListener("resize",(()=>this.handleResize()),{passive:!0})}};n.init()</script></body></html>
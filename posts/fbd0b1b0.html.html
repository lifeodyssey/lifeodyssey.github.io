<!DOCTYPE html><html class="font-sans scroll-smooth" lang=zh-CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/favicon.svg rel=icon type=image/svg+xml><title>Mixture Density Network(1) | 乔克叔叔的床边故事</title><meta content="之前在IOP的那篇论文里提到过，反演问题的数学本质是一个病态问题。而机器学习和深度学习本质上解决的都是分类和回归问题，并不能直接解决病态问题。最近重新查看一些论文，终于想起了之前看过的一些东西。&#34;Seamless retrievals of..." name=description><meta content=周大侠 name=author><meta content="Astro v5.13.7" name=generator><meta content="oklch(96% 0.005 298)" name=theme-color><link href=/fonts/EarlySummer-VF-Split/EarlySummer-VF-Subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Black-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Bold-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-Italic-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=https://lifeodyssey.github.io/posts/fbd0b1b0.html.html rel=canonical><link href=/sitemap-index.xml rel=sitemap><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=https://lifeodyssey.github.io rel=alternate hreflang=zh><link href=https://lifeodyssey.github.io/en/ rel=alternate hreflang=en><link href=https://lifeodyssey.github.io/ja/ rel=alternate hreflang=ja><meta content=article property=og:type><meta content=https://lifeodyssey.github.io/posts/fbd0b1b0.html.html property=og:url><meta content="Mixture Density Network(1) | 乔克叔叔的床边故事" property=og:title><meta content="之前在IOP的那篇论文里提到过，反演问题的数学本质是一个病态问题。而机器学习和深度学习本质上解决的都是分类和回归问题，并不能直接解决病态问题。最近重新查看一些论文，终于想起了之前看过的一些东西。&#34;Seamless retrievals of..." property=og:description><meta content=https://lifeodyssey.github.io/og/fbd0b1b0.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.1k2cUud7.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!!e&&"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",t?"oklch(22% 0.005 298)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t)}document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),e(),t()}()</script><link href=/_astro/_about_.Dzb1Me_E.css rel=stylesheet><link href=/_astro/_posts_slug_.CM85RmC-.css rel=stylesheet><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const tp={preserveBehavior:!1},ep=t=>{if("string"==typeof t)return[t,tp];const[e,n=tp]=t;return[e,{...tp,...n}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,e,r,o,i,a,s,c,d,p,l=t,u){function f(){u||(u=1,"/"==(s=(a.lib||"/~partytown/")+(a.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),o!=t?o.dispatchEvent(new CustomEvent("pt1",{detail:t})):(c=setTimeout(w,(null==a?void 0:a.fallbackTimeout)||1e4),e.addEventListener("pt0",h),i?y(1):r.serviceWorker?r.serviceWorker.register(s+(a.swPath||"partytown-sw.js"),{scope:s}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):w())))}function y(n){p=e.createElement(n?"script":"iframe"),t._pttab=Date.now(),n||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=s+"partytown-"+(n?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),e.querySelector(a.sandboxParent||"body").appendChild(p)}function w(n,r){for(h(),o==t&&(a.forward||[]).map((function(e){const[n]=ep(e);delete t[n.split(".")[0]]})),n=0;n<d.length;n++)(r=e.createElement("script")).innerHTML=d[n].innerHTML,r.nonce=a.nonce,e.head.appendChild(r);p&&p.parentNode.removeChild(p)}function h(){clearTimeout(c)}a=t.partytown||{},o==t&&(a.forward||[]).map((function(e){const[r,{preserveBehavior:o}]=ep(e);l=t,r.split(".").map((function(e,r,i){var a;l=l[i[r]]=r+1<i.length?l[i[r]]||(a=i[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(o){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,i);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(i,arguments),n}})()}))})),"complete"==e.readyState?f():(t.addEventListener("DOMContentLoaded",f),t.addEventListener("load",f))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-fbd0b1b0-zh}@layer astro{::view-transition-old(post-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-fbd0b1b0-zh}@layer astro{::view-transition-old(time-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-fbd0b1b0-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-wif6pdce-3]{view-transition-name:site-title-zh}@layer astro{::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><body><div class="w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><header class="cjk:tracking-0.02em lg:uno-desktop-column lg:top-20 mb-10.8"><h2 class="c-secondary font-bold font-title lg:c-primary lg:mb-1.8 lg:mt-0 lg:text-9 mb-2.8 mt-3 text-5.375"><div class="inline-block box-content pr-1" data-astro-transition-scope=astro-wif6pdce-3 data-disable-theme-transition><a href=/ id=site-title-link>乔克叔叔的床边故事</a></div></h2></header><nav aria-label="Site Navigation" class="hidden cjk:tracking-0.02em font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,12.5rem)] lg:text-4 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">文章</a></li><li><a href=/tags/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">标签</a></li><li><a href=/about/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">关于</a></li><li><a href=/search/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Search</a></li></ul></nav><main class=mb-10><article class=heti><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function e(t){if(!(t.target instanceof Element?t.target:null)?.closest("#back-button"))return;if(window.history.length>1)return void window.history.back();const e=document.getElementById("site-title-link");e&&e.click()}document.addEventListener("click",e,{passive:!0})</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>Mixture Density Network(1)</span></h1></div><div class="c-primary block font-time mb-17.2" data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition id=post-date><time datetime=2021-12-28>2021-12-28 </time><span class=ml-1.75>20 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="w-full h-12 relative" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>目录</span><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24" class="ml-4 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center aspect-square hidden w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#seamless-retrievals-of-chlorophyll-a-from-sentinel-2-msi-and-sentinel-3-olci-in-inland-and-coastal-waters-a-machine-learning-approach class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Seamless retrievals of chlorophyll-a from Sentinel-2 (MSI) and Sentinel-3 (OLCI) in inland and coastal waters: A machine-learning approach</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#训练过程 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>训练过程</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#robust-algorithm-for-estimating-total-suspended-solids-tss-in-inland-and-nearshore-coastal-waters class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Robust algorithm for estimating total suspended solids (TSS) in inland and nearshore coastal waters</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#hyperspectral-retrievals-of-phytoplankton-absorption-and-chlorophyll-a-in-inland-and-nearshore-coastal-waters class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Hyperspectral retrievals of phytoplankton absorption and chlorophyll-a in inland and nearshore coastal waters</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#a-chlorophyll-a-algorithm-for-landsat-8-based-on-mixture-density-networks class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>A Chlorophyll-a Algorithm for Landsat-8 Based on Mixture Density Networks</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#类的继承和多态 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>类的继承和多态</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#iterator class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>iterator</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#访问限制 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>访问限制</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#模块的调用 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>模块的调用</a></li></ul></nav></div></div><script type=module>let s=null,i=null;function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",c=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&c.set(e,t)}));let r=null;function l(t){t!==r&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),r=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}s=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=c.get(e);t&&l(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]}),Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>s?.observe(t)));const a=document.getElementById("post-copyright");a&&(i=new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),r=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}),i?.observe(a),n.length>0&&l(n[0]))}function m(){s?.disconnect(),i?.disconnect(),s=null,i=null}document.addEventListener("astro:after-swap",g),document.addEventListener("astro:before-swap",m),g()</script><div id=post-content><p>之前在IOP的那篇论文里提到过，反演问题的数学本质是一个病态问题。而机器学习和深度学习本质上解决的都是分类和回归问题，并不能直接解决病态问题。最近重新查看一些论文，终于想起了之前看过的一些东西。</p><h1 id=几篇论文>几篇论文、<a href=#几篇论文 class=heading-anchor-link aria-label="Link to 几篇论文、"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><ul><li>“Seamless retrievals of chlorophyll-a from Sentinel-2 (MSI) and Sentinel-3 (OLCI) in inland and coastal waters: A machine-learning approach”. N. Pahlevan, et al. (2020). Remote Sensing of Environment. 111604. 10.1016/j.rse.2019.111604.</li><li>“Robust algorithm for estimating total suspended solids (TSS) in inland and nearshore coastal waters”. S.V. Balasubramanian, et al. (2020). Remote Sensing of Environment. 111768. 10.1016/j.rse.2020.111768. Code.</li><li>“Hyperspectral retrievals of phytoplankton absorption and chlorophyll-a in inland and nearshore coastal waters”. N. Pahlevan, et al. (2021). Remote Sensing of Environment. 112200. 10.1016/j.rse.2020.112200.</li><li>“A Chlorophyll-a Algorithm for Landsat-8 Based on Mixture Density Networks”. B. Smith, et al. (2021). Frontiers in Remote Sensing. 623678. 10.3389/frsen.2020.623678.</li></ul><p>这几篇论文都是Pahlevan搞的，代码都放在<a href=https://github.com/BrandonSmithJ/MDN%EF%BC%8C%E4%BD%86%E6%98%AF%E8%B7%9F%E6%80%95%E5%88%AB%E4%BA%BA%E5%81%B7%E8%B5%B0%E4%B8%80%E6%A0%B7%EF%BC%8C%E5%AF%B9%E4%BA%8E%E6%80%8E%E4%B9%88%E9%87%8D%E6%96%B0%E5%BA%94%E7%94%A8%E5%8F%AA%E5%8F%A3%E4%B8%8D%E6%8F%90%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://github.com/BrandonSmithJ/MDN，但是跟怕别人偷走一样，对于怎么重新应用只口不提。</a></p><p>一篇篇来看吧</p><h2 id=seamless-retrievals-of-chlorophyll-a-from-sentinel-2-msi-and-sentinel-3-olci-in-inland-and-coastal-waters-a-machine-learning-approach>Seamless retrievals of chlorophyll-a from Sentinel-2 (MSI) and Sentinel-3 (OLCI) in inland and coastal waters: A machine-learning approach<a href=#seamless-retrievals-of-chlorophyll-a-from-sentinel-2-msi-and-sentinel-3-olci-in-inland-and-coastal-waters-a-machine-learning-approach class=heading-anchor-link aria-label="Link to Seamless retrievals of chlorophyll-a from Sentinel-2 (MSI) and Sentinel-3 (OLCI) in inland and coastal waters: A machine-learning approach"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>这篇论文是Pahlevan搞得第一篇，重点来看看他的这个网络是怎么做的，MDN的原理回合后面实现一起讲</p><h3 id=训练过程>训练过程<a href=#训练过程 class=heading-anchor-link aria-label="Link to 训练过程"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>因为他们的数据足够多，所以只用了1/3，大概1000个数据来训练。</p><p>输入数据只有400-800的Rrs.</p><p>所有的feature都log-transformed, normalized based on median centering and interquartile scaling, and then scaled to the range (0,1);</p><p>这个步骤是咋做的呢，我去翻了翻他们的源代码，对于传进来的data，会利用from .transformers import TransformerPipeline, generate_scalers 这个scalers来做变换。</p><p>然后</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> sklearn </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> preprocessing</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>args.x_scalers </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>			serialize(preprocessing.RobustScaler),</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>	]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>	args.y_scalers </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>		serialize(LogTransformer),</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>		serialize(preprocessing.MinMaxScaler, [(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)]),</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>	]</span></span></code></pre></div><p>?不是说的0-1吗？</p><p>具体用的应该是这一个<a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html%EF%BC%8C%E7%84%B6%E5%90%8E%E5%AF%B9y%E5%81%9A%E7%9A%84%E5%B0%B1%E6%98%AFMinMaxScaler%E4%BA%86%E3%80%82 rel="nofollow noopener noreferrer external" target=_blank>https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html，然后对y做的就是MinMaxScaler了。</a></p><p>然后应该是把这个参数存下来，等到后面在做的时候重新来弄，不然一个单独的数哪儿来的IQR。</p><p>等到后面具体实现的时候可以认真看下。</p><p>输出的数据output variables are subject to the same normalization method</p><figure><img alt="Fig. 3" src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewin1-s2.0-S0034425719306248-gr3.jpg><figcaption>Fig. 3</figcaption></figure><p>然后放了这么一张图上来。</p><p>不是，我也没见你哪里有做feature engineering啊。</p><p>再看后面几个论文的时候发现把feature engineering给去掉了hhh，果然顶刊也是很容易出问题的啊。</p><p>然后对于调参</p><blockquote><p>These choices appear to be fairly robust to changes within the current implementation, especially with regard to the MDN-specific parameters. Following experimenting with several architectures, we found that the model is very robust to changes in various hyperparameters.</p></blockquote><p>在这种情况下他们就只用了一个a five-layer neural network with 100 neurons per layer, which is trained to output the parameters of five Gaussians.</p><p>The median estimates from the MDN model taken over ten trials of random network initializations are the predicted Chl<em>a</em> for a given <em>R**rs</em> spectrum. Here, the same training data are used for all trials.</p><p>这篇论文关于网络的部分基本就这么结了，看下一个</p><h2 id=robust-algorithm-for-estimating-total-suspended-solids-tss-in-inland-and-nearshore-coastal-waters>Robust algorithm for estimating total suspended solids (TSS) in inland and nearshore coastal waters<a href=#robust-algorithm-for-estimating-total-suspended-solids-tss-in-inland-and-nearshore-coastal-waters class=heading-anchor-link aria-label="Link to Robust algorithm for estimating total suspended solids (TSS) in inland and nearshore coastal waters"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>直接跳到训练过程</p><p>其实有点想吐槽，这么直接的复制粘贴，好多地方都一样，真的不会被判抄袭吗，这篇论文有意思的地方是结合了MDN，QAA，水体光学分类，来做TSS。</p><p>和上一篇论文不同的地方只有</p><blockquote><p>. The current default model uses a five-layer neural network with 25 neurons per layer, which is trained to output the parameters of five Gaussians. From this mixture model, the overall estimate is selected via the Gaussian with the maximum prior likelihood. The described model is trained a number of times with random initializations of the underlying neural network, in order to ensure a stable final output of the estimates. The median estimate is taken as the final result of these trials, with convergence occurring within some small margin of error after approximately ten trials</p></blockquote><h2 id=hyperspectral-retrievals-of-phytoplankton-absorption-and-chlorophyll-a-in-inland-and-nearshore-coastal-waters>Hyperspectral retrievals of phytoplankton absorption and chlorophyll-a in inland and nearshore coastal waters<a href=#hyperspectral-retrievals-of-phytoplankton-absorption-and-chlorophyll-a-in-inland-and-nearshore-coastal-waters class=heading-anchor-link aria-label="Link to Hyperspectral retrievals of phytoplankton absorption and chlorophyll-a in inland and nearshore coastal waters"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>没有任何其他的区别。</p><p>真要说的话就是他们训练了俩模型，也不太懂为什么要训练俩。</p><h2 id=a-chlorophyll-a-algorithm-for-landsat-8-based-on-mixture-density-networks>A Chlorophyll-a Algorithm for Landsat-8 Based on Mixture Density Networks<a href=#a-chlorophyll-a-algorithm-for-landsat-8-based-on-mixture-density-networks class=heading-anchor-link aria-label="Link to A Chlorophyll-a Algorithm for Landsat-8 Based on Mixture Density Networks"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>这个是这么说的</p><blockquote><p>. All models examined in this study have simply used ‘reasonable’ default values for their hyperparameters (Glorot and Bengio 2010; Hinton 1990; Kingma and Ba 2014) namely: a five layer neural network with 100 nodes per layer, learning a mixture of five gaussians; a learning rate, L2 normalization rate, and <img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewinclip_image002.png> value all set to 0.001; and with training performed via Adam optimization over a set of 10,000 stochastic mini-batch iterations, using a mini-batch size of 128 samples.</p></blockquote><p>这篇论文其实很有意思。</p><p>这篇论文的一个主要目的是证明MDN这个专门针对反演问题的网络架构和其他的神经网络架构相比的优越性。具体结果可以看这几张图。</p><figure><img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewinfrsen-01-623678-g004.jpg><figcaption>img</figcaption></figure><figure><img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewinfrsen-01-623678-g005.jpg><figcaption>img</figcaption></figure><figure><img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewinfrsen-01-623678-g006.jpg><figcaption>img</figcaption></figure><p>还比较了我之前想试着用的cao 2020用过的XGBoost</p><p>这篇论文的补充材料里的讨论也写的贼有意思，感觉这个讨论是用来怼某个审稿人的。我来翻译一下这个讨论。</p><p>审稿人问：你为啥不改你模型的参数啊</p><blockquote><p>While no hyperparameter optimization has taken place over the course of this work, it is an important step to ensure optimal performance and generality.</p><p>These choices are mostly arbitrary, as the goal of this study was to present the feasibility and theoretical backing of the MDN model</p><p>These choices are mostly arbitrary, as the goal of this study was to present the feasibility and theoretical backing of the MDN model. A full optimality demonstration, on the other hand, would require a significantly longer study than already presented.</p></blockquote><p>回答：第一，重点不在这，第二，没空，先水一个论文再说。</p><p>审稿人：不行，你得证明你这个模型参数不重要。</p><blockquote><p>Nevertheless, we would be remiss to exclude any discussion which examines the hyperparameter choices, and so what follows is a (very) brief look at how select parameters affect performance.</p></blockquote><p>回答：行吧，既然你不懂，我们就稍微给你讲一下，而且我们觉得你听不懂，我们给你们讲个最简单的。</p><blockquote><p>First, some terminology must be defined in order to make it clear what is being examined. Normally in hyperparameter optimization, and machine learning in general, the dataset is split into three parts: training, validation, and testing. The training set is of course used to train the model on; the validation set is used to optimize the model using data unseen during training; and the testing set is used only at the end, in order to benchmark performance.</p></blockquote><p>回答：爷来给你们讲一下定义。</p><blockquote><p>As mentioned, no explicit hyperparameter optimizations have taken place thus far in the study. Default values were chosen based on those commonly used in literature and in available libraries (e.g. scikit-learn), and as will be seen, do not represent the optimal values for our specific data. As such, no separate validation set was set aside for the purposes of such an exercise.</p></blockquote><p>因为我们没有做一个精确的超参数调整，所以我们就没做val那一部分的数据集，只做了train test</p><blockquote><p>One of the main questions any reader may have is, “how large is the model?”.</p></blockquote><p>我知道你们不是这行的，提不出来啥专业问题，我来提一个。</p><p>然后给了两张图看layer和node的影响</p><figure><img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewinclip_image003.png><figcaption>img</figcaption></figure><p>接着给看了learning curve</p><figure><img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewin202112302311329.png><figcaption>img</figcaption></figure><figure><img alt=img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewin202112302311329.png><figcaption>img</figcaption></figure><p>怼的真的很好哈哈哈</p><h1 id=看源代码之前补充一些知识>看源代码之前补充一些知识<a href=#看源代码之前补充一些知识 class=heading-anchor-link aria-label="Link to 看源代码之前补充一些知识"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>不想看可以直接跳过</p><p>###　class的一些知识补充</p><p>自己之前逃的课都会以另一种方式回来，面向对象，这不就又来了。</p><p>类包括同时包括valuable 和function，前者是类的属性，后者是类的方法。</p><p>比如一个人的身高和体重就是属性，说话吃饭是他的方法</p><p>定义的方法</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> ClassName</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>   '类的帮助信息'</span><span style=color:#6a737d;--shiki-dark:#6A737D>   #类文档字符串</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   class_suite  </span><span style=color:#6a737d;--shiki-dark:#6A737D>#类体</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 一个例子</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Employee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>   '所有员工的基类'</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   empCount </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#6a737d;--shiki-dark:#6A737D># 属性</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, name, salary):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.name </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> name</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.salary </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> salary</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      Employee.empCount </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> displayCount</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span><span style=color:#6a737d;--shiki-dark:#6A737D>#方法</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>     print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Total Employee </span><span style=color:#005cc5;--shiki-dark:#79B8FF>%d</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span><span style=color:#d73a49;--shiki-dark:#F97583> %</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Employee.empCount</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> displayEmployee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Name : "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.name,  </span><span style=color:#032f62;--shiki-dark:#9ECBFF>", Salary: "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.salary</span></span></code></pre></div><p>在这里面呢，empCount变量是一个类变量，这个值在所有的实例之间共享，访问方法为Employee.empCount</p><p>第一种方法 <strong>init</strong>() 方法是一种特殊的方法，被称为类的构造函数或初始化方法，当创建了这个类的实例时就会调用该方法。意思就是每次创建一个类的实例，就会给name和salary赋值，然后Employee.empCount+1</p><p>这里面self代表的是实例，意思比如你定义了一个李华进去，这个self就代表了李华，可以理解为你定义一个fun(x,y,z),然后调用的时候用的是fun(a,b,c), self只是他在类内部的名字而已，调用的使用不需要传入相应的参数。</p><p>这就是类和函数一个特别的区别，类必须由一个额外的第一个参数名称。</p><p>更具体一点的区别可以看这里</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Test</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> prt</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__class__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>t </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Test()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>t.prt()</span></span></code></pre></div><p>执行结果为</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>&#x3C;</span><span style=color:#24292e;--shiki-dark:#E1E4E8>__main__.Test instance at 0x10d</span><span style=color:#d73a49;--shiki-dark:#F97583>066878></span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>__main__.Test</span></span></code></pre></div><p>第一行输出的是instance，代表一个实例，第二行是这个类本身。</p><p>self不是关键词，可以改成akb48。</p><p>想要调用必须创建一个实例</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#"创建 Employee 类的第一个对象"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>emp1 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Employee(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"Zara"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2000</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#"创建 Employee 类的第二个对象"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>emp2 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Employee(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"Manni"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>5000</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><p>这些参数是通过init来接收的</p><p>和函数很类似，可以修改和访问实例里面的属性</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>emp1.displayEmployee()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>emp2.displayEmployee()</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Total Employee </span><span style=color:#005cc5;--shiki-dark:#79B8FF>%d</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span><span style=color:#d73a49;--shiki-dark:#F97583> %</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Employee.empCount</span></span></code></pre></div><p>这个结果是</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=plaintext style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>Name :  Zara ,Salary:  2000</span></span>
<span class=line><span>Name :  Manni ,Salary:  5000</span></span>
<span class=line><span>Total Employee 2</span></span></code></pre></div><p>同时也可以添加、删除、修改类的属性。</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>emp1.age </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 7</span><span style=color:#6a737d;--shiki-dark:#6A737D>  # 添加一个 'age' 属性</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>emp1.age </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 8</span><span style=color:#6a737d;--shiki-dark:#6A737D>  # 修改 'age' 属性</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>del</span><span style=color:#24292e;--shiki-dark:#E1E4E8> emp1.age  </span><span style=color:#6a737d;--shiki-dark:#6A737D># 删除 'age' 属性</span></span></code></pre></div><p>也可以使用这些函数来访问属性</p><ul><li><strong>getattr(obj, name[, default]) : 访问对象的属性。</strong></li><li><strong>hasattr(obj,name) : 检查是否存在一个属性。</strong></li><li><strong>setattr(obj,name,value) : 设置一个属性。如果属性不存在，会创建一个新属性。</strong></li><li><strong>delattr(obj, name) : 删除属性</strong></li></ul><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>hasattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(emp1, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'age'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)    </span><span style=color:#6a737d;--shiki-dark:#6A737D># 如果存在 'age' 属性返回 True。</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>getattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(emp1, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'age'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)    </span><span style=color:#6a737d;--shiki-dark:#6A737D># 返回 'age' 属性的值</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>setattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(emp1, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'age'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 添加属性 'age' 值为 8</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>delattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(empl, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'age'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)    </span><span style=color:#6a737d;--shiki-dark:#6A737D># 删除属性 'age'</span></span></code></pre></div><p>python有一些内置的类属性，意思是你创建这个类的时候就有这些属性。包括：</p><ul><li><strong>dict</strong> : 类的属性（包含一个字典，由类的数据属性组成）</li><li><strong>doc</strong><div></div></li><li><strong>name</strong>: 类名</li><li><strong>module</strong>: 类定义所在的模块（类的全名是’<strong>main</strong>.className’，如果类位于一个导入模块 mymod 中，那么 className.<strong>module</strong> 等于 mymod）</li><li><strong>bases</strong> : 类的所有父类构成元素（包含了以个由所有父类组成的元组）</li></ul><p>调用方式为</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Employee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>   '所有员工的基类'</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   empCount </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, name, salary):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.name </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> name</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.salary </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> salary</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      Employee.empCount </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> displayCount</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>     print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Total Employee </span><span style=color:#005cc5;--shiki-dark:#79B8FF>%d</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span><span style=color:#d73a49;--shiki-dark:#F97583> %</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Employee.empCount</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> displayEmployee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Name : "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.name,  </span><span style=color:#032f62;--shiki-dark:#9ECBFF>", Salary: "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.salary</span></span>
<span class=line></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Employee.__doc__:"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, Employee.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__doc__</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Employee.__name__:"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, Employee.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__name__</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Employee.__module__:"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, Employee.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__module__</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Employee.__bases__:"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, Employee.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__bases__</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Employee.__dict__:"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, Employee.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__dict__</span></span></code></pre></div><p>这个输出的结果是</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Employee.__doc__:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 所有员工的基类</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Employee.__name__:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> Employee</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Employee.__module__:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> __main__</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Employee.__bases__:</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ()</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Employee.__dict__:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> {'__module__':</span><span style=color:#032f62;--shiki-dark:#9ECBFF> '__main__',</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'displayCount':</span><span style=color:#d73a49;--shiki-dark:#F97583> &#x3C;</span><span style=color:#032f62;--shiki-dark:#9ECBFF>function</span><span style=color:#032f62;--shiki-dark:#9ECBFF> displayCount</span><span style=color:#032f62;--shiki-dark:#9ECBFF> at</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x10a939c8</span><span style=color:#d73a49;--shiki-dark:#F97583>0></span><span style=color:#032f62;--shiki-dark:#9ECBFF>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'empCount':</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 0,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'displayEmployee':</span><span style=color:#d73a49;--shiki-dark:#F97583> &#x3C;</span><span style=color:#032f62;--shiki-dark:#9ECBFF>function</span><span style=color:#032f62;--shiki-dark:#9ECBFF> displayEmployee</span><span style=color:#032f62;--shiki-dark:#9ECBFF> at</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x10a93caa</span><span style=color:#d73a49;--shiki-dark:#F97583>0></span><span style=color:#032f62;--shiki-dark:#9ECBFF>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> '__doc__':</span><span style=color:#032f62;--shiki-dark:#9ECBFF> '\xe6\x89\x80\xe6\x9c\x89\xe5\x91\x98\xe5\xb7\xa5\xe7\x9a\x84\xe5\x9f\xba\xe7\xb1\xbb',</span><span style=color:#032f62;--shiki-dark:#9ECBFF> '__init__':</span><span style=color:#d73a49;--shiki-dark:#F97583> &#x3C;</span><span style=color:#032f62;--shiki-dark:#9ECBFF>function</span><span style=color:#032f62;--shiki-dark:#9ECBFF> __init__</span><span style=color:#032f62;--shiki-dark:#9ECBFF> at</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x10a93957</span><span style=color:#d73a49;--shiki-dark:#F97583>8></span><span style=color:#032f62;--shiki-dark:#9ECBFF>}</span></span></code></pre></div><h3 id=类的继承和多态>类的继承和多态<a href=#类的继承和多态 class=heading-anchor-link aria-label="Link to 类的继承和多态"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>面向对象最大的好处是代码的重用。</p><p>还是看代码更容易理解一些</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Parent</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:        </span><span style=color:#6a737d;--shiki-dark:#6A737D># 定义父类</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   parentAttr </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 100</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "调用父类构造函数"</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> parentMethod</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> '调用父类方法'</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> setAttr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, attr):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      Parent.parentAttr </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> attr</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> getAttr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "父类属性 :"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, Parent.parentAttr</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Child</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>Parent</span><span style=color:#24292e;--shiki-dark:#E1E4E8>): </span><span style=color:#6a737d;--shiki-dark:#6A737D># 定义子类</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    # class 派生类名（基类名）</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "调用子类构造方法"</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 需要专门调用init方法</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 这个构造函数可以被重写，比如</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#      def__init__(self,name,sex,mother,father):</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     self.name = name</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     self.sex = sex</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     self.mother = mother</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     self.father = father</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 如果父类的属性太多，也可以重写这个方法，和下面讲到的多态一样</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> childMethod</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> '调用子类方法 child method'</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>c </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Child()          </span><span style=color:#6a737d;--shiki-dark:#6A737D># 实例化子类</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>c.childMethod()      </span><span style=color:#6a737d;--shiki-dark:#6A737D># 调用子类的方法</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>c.parentMethod()     </span><span style=color:#6a737d;--shiki-dark:#6A737D># 调用父类方法</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>c.setAttr(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>200</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)       </span><span style=color:#6a737d;--shiki-dark:#6A737D># 再次调用父类的方法</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>c.getAttr()          </span><span style=color:#6a737d;--shiki-dark:#6A737D># 再次调用父类的方法</span></span></code></pre></div><p>父类只去定义一些最基本的属性和方法</p><p>多态是比如果说，我们在员工里增加这么一个方法</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Employee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>   '所有员工的基类'</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   empCount </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, name, salary):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.name </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> name</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.salary </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> salary</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      Employee.empCount </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>   </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> displayCount</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>     print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Total Employee </span><span style=color:#005cc5;--shiki-dark:#79B8FF>%d</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span><span style=color:#d73a49;--shiki-dark:#F97583> %</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Employee.empCount</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>	def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> print_title</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        if</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.sex </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "male"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>            print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"man"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        elif</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.sex </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "female"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>            print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"woman"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>   def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> displayEmployee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>      print</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Name : "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.name,  </span><span style=color:#032f62;--shiki-dark:#9ECBFF>", Salary: "</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.salary     </span></span></code></pre></div><p>现在我我们想雇佣童工了，就可以把新的子类写为</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> child</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>Employee</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>     def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> print_title</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        if</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.sex </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "male"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>             print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"boy"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>         elif</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.sex </span><span style=color:#d73a49;--shiki-dark:#F97583>==</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "female"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>             print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"girl"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><p>当子类和父类都存在相同的 print_title()方法时，子类的 print_title() 覆盖了父类的 print_title()，在代码运行时，会调用子类的 print_title()</p><p>多态的好处就是，当我们需要传入更多的子类，例如新增 Teenagers、Grownups 等时，我们只需要继承 Person 类型就可以了，而print_title()方法既可以直不重写（即使用Person的），也可以重写一个特有的。这就是多态的意思。调用方只管调用，不管细节，而当我们新增一种Person的子类时，只要确保新方法编写正确，而不用管原来的代码。这就是著名的“开闭”原则：</p><h3 id=iterator>iterator<a href=#iterator class=heading-anchor-link aria-label="Link to iterator"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>讲什么样的类才能循环，我感觉暂时用不到</p><h3 id=访问限制>访问限制<a href=#访问限制 class=heading-anchor-link aria-label="Link to 访问限制"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>如果我们不想让某个属性被外界访问到，可以增加访问限制，就像</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> JustCounter</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>	__secretCount </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#6a737d;--shiki-dark:#6A737D>  # 私有变量</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>	publicCount </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#6a737d;--shiki-dark:#6A737D>    # 公开变量</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>	def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> count</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>		self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.__secretCount </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>		self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.publicCount </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>		print</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.__secretCount</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>counter </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> JustCounter()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>counter.count()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>counter.count()</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8> counter.publicCount</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8> counter.__secretCount  </span><span style=color:#6a737d;--shiki-dark:#6A737D># 报错，实例不能访问私有变量</span></span></code></pre></div><h3 id=模块的调用>模块的调用<a href=#模块的调用 class=heading-anchor-link aria-label="Link to 模块的调用"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>Python 模块(Module)，是一个 Python 文件，以 .py 结尾，包含了 Python 对象定义和Python语句。</p><p>意思就是，我们可以把类也放到模块里，跟函数一样去调用。</p><h1 id=mdn的实现>MDN的实现<a href=#mdn的实现 class=heading-anchor-link aria-label="Link to MDN的实现"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>说了这么多，啥是MDN呢</p><p>打算结合<a href=https://github.com/hardmaru/pytorch_notebooks rel="nofollow noopener noreferrer external" target=_blank>这个</a>里面来讲。</p><p>重点来看他们是怎么实现MDN的，然后对比一下论文的源代码。最后再去讲原理。</p><p>在看这个之前，请先把<a href=https://pytorch.org/tutorials/beginner/basics/tensorqs_tutorial.html rel="nofollow noopener noreferrer external" target=_blank>这个</a>看完来补补课</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> MDN</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>nn</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.</span><span style=color:#6f42c1;--shiki-dark:#B392F0>Module</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, n_hidden, n_gaussians):</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        super</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>MDN</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>).</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>()</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_h </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.Sequential(</span><span style=color:#6a737d;--shiki-dark:#6A737D># 这个是连续处理的意思，就是先做线性变换再做tanh变换</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            nn.Linear(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, n_hidden),</span><span style=color:#6a737d;--shiki-dark:#6A737D>#这里是做了Linear transformation</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>            nn.Tanh()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        )</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_pi </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.Linear(n_hidden, n_gaussians)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_sigma </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.Linear(n_hidden, n_gaussians)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_mu </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.Linear(n_hidden, n_gaussians)  </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> forward</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, x):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        z_h </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_h(x)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        pi </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.functional.softmax(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_pi(z_h), </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        # re scale to [0,1]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        sigma </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.exp(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_sigma(z_h))</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        #做exp运算</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        mu </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.z_mu(z_h)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> pi, sigma, mu</span></span></code></pre></div><p>让我们详细说一下这个MDN是怎么构造的</p><p>对于每一个输入的x，我们预测的是y的分布</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mi>y</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><msubsup><mo>∑</mo><mi>k</mi><mi>K</mi></msubsup><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mi>ϕ</mi><mo stretchy=false>(</mo><mi>y</mi><mo separator=true>,</mo><msub><mi>μ</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>σ</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P(y|x) = \sum_{k}^{K} \Pi_{k}(x) \phi(y, \mu_{k}(x), \sigma_{k}(x))</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.2809em;vertical-align:-.2997em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord mathnormal">ϕ</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>))</span></span></span></span></p><ul><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span> is an index describing which Gaussian we are referencing. There are <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.07153em>K</span></span></span></span> Gaussians total.</li><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mo>∑</mo><mi>k</mi><mi>K</mi></msubsup></mrow><annotation encoding=application/x-tex>\sum_{k}^{K}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.2809em;vertical-align:-.2997em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span></span></span></span> is the summation operator. We sum every <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span> Gaussian across all <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.07153em>K</span></span></span></span>. You might also see <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding=application/x-tex>\sum_{k=0}^{K-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.2809em;vertical-align:-.2997em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span><span class="mtight mrel">=</span><span class="mord mtight">0</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07153em>K</span><span class="mtight mbin">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span></span></span></span> or <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></mrow><annotation encoding=application/x-tex>\sum_{k=1}^{K}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.2809em;vertical-align:-.2997em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span><span class="mtight mrel">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span></span></span></span> depending on whether an author is using zero-based numbering or not.</li><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\Pi_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> acts as a weight, or multiplier, for mixing every <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span> Gaussian. It is a function of the input <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi_k(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></li><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span> is the Gaussian function and returns the at <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>y</mi></mrow><annotation encoding=application/x-tex>y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> for a given mean and standard deviation.</li><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\mu_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\sigma_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> are the parameters for the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span> Gaussian: mean <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\mu_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> and standard deviation <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\sigma_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>. Instead of being fixed for each Gaussian, they are also functions of the input <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\mu_k(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\sigma_k(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></li></ul><p>All of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\sigma_{k}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> are positive, and all of the weights <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>Π</mi></mrow><annotation encoding=application/x-tex>\Pi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class=mord>Π</span></span></span></span> sum to one:</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mo>∑</mo><mi>k</mi><mi>K</mi></msubsup><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\sum_{k}^{K} \Pi_{k} = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.2809em;vertical-align:-.2997em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=top:-2.4003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>1</span></span></span></span></p><p>First our network must learn the functions <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>μ</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><msub><mi>σ</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\Pi_{k}(x), \mu_{k}(x), \sigma_{k}(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span> for every <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span> Gaussian. Then these functions can be used to generate individual parameters <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub><mo separator=true>,</mo><msub><mi>σ</mi><mi>k</mi></msub><mo separator=true>,</mo><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\mu_k, \sigma_k, \Pi_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8778em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> for a given input <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>. These parameters will be used to generate our pdf <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>P</mi><mo stretchy=false>(</mo><mi>y</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>P(y|x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span>. Finally, to make a prediction, we will need to sample (pick a value) from this pdf.</p><p>In our implementation, we will use a neural network of one hidden layer with 20 nodes. This will feed into another layer that generates the parameters for 5 mixtures: with 3 parameters <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\Pi_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\mu_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\sigma_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> for each Gaussian <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span>.</p><p>Our definition will be split into three parts.</p><p>First we will compute 20 hidden values <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>h</mi></msub></mrow><annotation encoding=application/x-tex>z_h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> from our input <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>.</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>h</mi></msub><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy=false>(</mo><msub><mi>W</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mi>x</mi><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>z_h(x) = \tanh( W_{in} x + b_{in})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>tanh</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></p><p>Second, we will use these hidden values <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>h</mi></msub></mrow><annotation encoding=application/x-tex>z_h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> to compute our three sets of parameters <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>Π</mi><mo separator=true>,</mo><mi>σ</mi><mo separator=true>,</mo><mi>μ</mi></mrow><annotation encoding=application/x-tex>\Pi, \sigma, \mu</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8778em;vertical-align:-.1944em></span><span class=mord>Π</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">μ</span></span></span></span>:</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi mathvariant=normal>Π</mi></msub><mo>=</mo><msub><mi>W</mi><mi mathvariant=normal>Π</mi></msub><msub><mi>z</mi><mi>h</mi></msub><mo>+</mo><msub><mi>b</mi><mi mathvariant=normal>Π</mi></msub><mspace linebreak=newline></mspace><msub><mi>z</mi><mi>σ</mi></msub><mo>=</mo><msub><mi>W</mi><mi>σ</mi></msub><msub><mi>z</mi><mi>h</mi></msub><mo>+</mo><msub><mi>b</mi><mi>σ</mi></msub><mspace linebreak=newline></mspace><msub><mi>z</mi><mi>μ</mi></msub><mo>=</mo><msub><mi>W</mi><mi>μ</mi></msub><msub><mi>z</mi><mi>h</mi></msub><mo>+</mo><msub><mi>b</mi><mi>μ</mi></msub></mrow><annotation encoding=application/x-tex>z_\Pi = W_{\Pi} z_h + b_{\Pi}\\ z_\sigma = W_{\sigma} z_h + b_{\sigma}\\ z_\mu = W_{\mu} z_h + b_{\mu}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight">Π</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.8444em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03588em>σ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>σ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.8444em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>σ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.7167em;vertical-align:-.2861em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">μ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.9694em;vertical-align:-.2861em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">μ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.9805em;vertical-align:-.2861em></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">μ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span></p><p>Third, we will use the output of these layers to determine the parameters of the Gaussians.</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>Π</mi><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><msub><mi>z</mi><mi mathvariant=normal>Π</mi></msub><mo stretchy=false>)</mo></mrow><mrow><msubsup><mo>∑</mo><mi>k</mi><mi>K</mi></msubsup><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><msub><mi>z</mi><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub></msub><mo stretchy=false>)</mo></mrow></mfrac><mspace linebreak=newline></mspace><mi>σ</mi><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><msub><mi>z</mi><mi>σ</mi></msub><mo stretchy=false>)</mo><mspace linebreak=newline></mspace><mi>μ</mi><mo>=</mo><msub><mi>z</mi><mi>μ</mi></msub></mrow><annotation encoding=application/x-tex>\Pi = \frac{\exp(z_{\Pi})}{\sum_{k}^{K} \exp(z_{\Pi_k})}\\ \sigma = \exp(z_{\sigma})\\ \mu = z_{\mu}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class=mord>Π</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.7148em;vertical-align:-.7048em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.01em><span style=top:-2.5703em><span class=pstrut style=height:3em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mop"><span class="mtight mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8852em><span style=top:-2.1786em;margin-left:0;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span style=top:-2.8971em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07153em>K</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3214em><span></span></span></span></span></span></span><span class="mtight mspace" style=margin-right:.1952em></span><span class="mtight mop"><span class=mtight>e</span><span class=mtight>x</span><span class=mtight>p</span></span><span class="mtight mopen">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567em;margin-left:-.044em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3448em;margin-left:0;margin-right:.1em><span class=pstrut style=height:2.6944em></span><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3496em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.393em><span></span></span></span></span></span></span><span class="mtight mclose">)</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.485em><span class=pstrut style=height:3em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mtight mop"><span class=mtight>e</span><span class=mtight>x</span><span class=mtight>p</span></span><span class="mtight mopen">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3567em;margin-left:-.044em;margin-right:.0714em><span class=pstrut style=height:2.5em></span><span class="mtight sizing reset-size3 size1"><span class="mord mtight"><span class="mord mtight">Π</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1433em><span></span></span></span></span></span></span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.7048em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>exp</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>σ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal">μ</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.7167em;vertical-align:-.2861em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mtight"><span class="mord mathnormal mtight">μ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span></p><ul><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\exp(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>exp</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span> is the exponential function also written as <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding=application/x-tex>e^x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6644em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></li></ul><p>We use a <a href=https://en.wikipedia.org/wiki/Softmax_function rel="nofollow noopener noreferrer external" target=_blank><em>softmax</em></a> operator to ensure that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>Π</mi></mrow><annotation encoding=application/x-tex>\Pi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class=mord>Π</span></span></span></span> sums to one across all <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span>, and the exponential function ensures that each weight <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Π</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\Pi_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8333em;vertical-align:-.15em></span><span class=mord><span class=mord>Π</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is positive. We also use the exponential function to ensure that every <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\sigma_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5806em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight sizing reset-size6 size3"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is positive.</p><p>懂了，这个构造的方式其实是利用MDN预测了高斯混合网络的几个参数，再从整个PDF里面取值作为预测值。</p><p>那么就牵扯到一个问题，就是我的y值只有一个，但是MDN产生的结果是一个分布，怎么计算loss来更新权重呢？</p><p>请见下篇</p><div id=post-copyright></div><div class="mt-12.6 uno-decorative-line"></div><div class="no-heti flex flex-wrap gap-x-3 gap-y-3.2"><a href=/tags/机器学习/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">机器学习 </span><span class="inline-block font-medium opacity-0" aria-hidden=true>机器学习 </span></a><a href=/tags/Inversion/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Inversion </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Inversion </span></a><a href="/tags/Deep Learning/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Deep Learning </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Deep Learning</span></a></div></div></article></main><footer class="leading-1.25em font-navbar lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=/atom.xml/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>RSS</a>&nbsp;/ <a href=https://github.com/lifeodyssey class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:email@radishzz.cc class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;</p><p>© 2025-2026 周大侠</p><p>Powered by <a href=https://astro.build/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><div class="flex absolute gap-6 lg:bottom-[min(10.27rem+1.92vw,12rem)] lg:fixed lg:right-[max(5rem,calc(50vw-35rem))] lg:top-auto lg:w-14rem min-[823px]:max-lg:right-[calc(50vw-22rem)] right-7.25vw top-14.6"><a href=/posts/fbd0b1b0.html.html/ class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" aria-label="Switch website language" id=language-switcher><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M19.18 21.1 12.4 1.89h-1.21L4.52 21.1l-2.53.2v.81h6.37v-.81l-2.83-.2 2.02-5.97h7.58l2.02 5.97-3.34.2v.81H22v-.81l-2.83-.2zM7.85 14.33l3.44-10.21 3.54 10.21z"/></svg> </a><button aria-label="Switch light/dark theme" class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" id=theme-toggle-button><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M12.06.61C5.66.61.46 5.71.46 12.11s5.1 11.5 11.6 11.5 11.5-5.1 11.5-11.5S18.46.61 12.06.61m0 21c-6.07 0-10.94-4.2-10.94-9.5s4.87-9.4 10.94-9.4S23 6.91 23 12.21s-4.88 9.4-10.94 9.4"/></svg></button></div><script>!function(){const e="oklch(96% 0.005 298)",t="oklch(22% 0.005 298)";function n(n){document.documentElement.classList.toggle("dark",n);const o=document.head.querySelector('meta[name="theme-color"]');o&&e&&t&&o.setAttribute("content",n?t:e),localStorage.setItem("theme",n?"dark":"light"),document.dispatchEvent(new Event("theme-changed"))}function o(){n(!document.documentElement.classList.contains("dark"))}document.addEventListener("click",(function(e){const t=e.target instanceof Element?e.target:null,n=t?.closest("#theme-toggle-button");if(!n)return;if(document.documentElement.classList.contains("reduce-motion"))return void o();document.documentElement.style.setProperty("view-transition-name","animation-theme-toggle"),document.documentElement.setAttribute("data-theme-changing",""),document.startViewTransition(o).finished.then((()=>{document.documentElement.style.removeProperty("view-transition-name"),document.documentElement.removeAttribute("data-theme-changing")}))}),{passive:!0}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{n(e.matches)}))}()</script><script type=module>const o={click:"tap",typing:"type"},l={[o.click]:.8,[o.typing]:.4},d=["#language-switcher","#theme-toggle-button"],f=[".el-input__inner",".el-textarea__inner","#wl-nick","#wl-mail","#wl-link","#wl-edit"],h=new Set(["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"]),p=d.join(","),g=f.join(",");function r(){return window.matchMedia("(max-width: 1023px)").matches}function w(){return document.head.querySelector('link[rel="sitemap"]')?.getAttribute("href")?.replace("/sitemap-index.xml","")||""}class y{audioContext=null;audioBuffers={[o.click]:[],[o.typing]:[]};initPromise=null;async fetchAndCacheSound(t,e){if(!this.audioContext)throw new Error("Audio context not initialized");const n=`${t}_0${e+1}`,i=await(await fetch(`${w()}/sounds/${n}.wav`)).arrayBuffer(),a=await this.audioContext.decodeAudioData(i);this.audioBuffers[t].push(a)}async preloadAllSounds(){const t=Object.values(o).flatMap((t=>Array.from({length:5},((e,n)=>this.fetchAndCacheSound(t,n)))));await Promise.allSettled(t)}async initialize(){return this.initPromise??=(async()=>{const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,await this.preloadAllSounds()})()}async playSound(t){try{if(await this.initialize(),!this.audioContext)return;"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=this.audioBuffers[t];if(0===e.length)return;const n=this.audioContext.createBufferSource();n.buffer=e[Math.floor(Math.random()*e.length)];const i=this.audioContext.createGain();i.gain.value=l[t],n.connect(i).connect(this.audioContext.destination),n.start(0)}catch(t){console.warn("Sound playback failed:",t)}}}const c=new y;function m(t){r()||!t.target?.closest(p)||c.playSound(o.click)}function x(t){r()||t.ctrlKey||t.altKey||t.metaKey||h.has(t.key)||!t.target?.closest(g)||c.playSound(o.typing)}document.addEventListener("click",m,{passive:!0}),document.addEventListener("keydown",x,{passive:!0})</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},o=new WeakMap;function r(){const e=document.querySelectorAll(".code-copy-button");0!==e.length&&e.forEach((e=>{e.innerHTML=s.copy}))}async function a(e){if(e.classList.contains("copy-success"))return;const t=e.parentElement?.querySelector("pre code"),n=t?.textContent??"";if(t&&n)try{await navigator.clipboard.writeText(n);const t=o.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const c=setTimeout((()=>{e.isConnected&&(e.innerHTML=s.copy,e.classList.remove("copy-success"),o.delete(e))}),1500);o.set(e,c)}catch(e){console.error("Failed to copy code",e)}}function l(e){const t=e.target instanceof Element&&e.target.closest(".code-copy-button");t&&a(t)}document.addEventListener("astro:page-load",r),document.addEventListener("click",l,{passive:!0}),r()</script><script type=module>async function p(t){const e=t.dataset.repo;if(!e)return;const o=t.getElementsByClassName("gc-owner-avatar")[0],n=t.getElementsByClassName("gc-repo-description")[0],s=t.getElementsByClassName("gc-stars-count")[0],a=t.getElementsByClassName("gc-forks-count")[0],r=t.getElementsByClassName("gc-license-info")[0];function c(t){const e=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1});o&&t.owner?.avatar_url&&(o.style.backgroundImage=`url(${t.owner.avatar_url})`),n&&(n.textContent=t.description??"No description"),s&&(s.textContent=e.format(t.stargazers_count??0)),a&&(a.textContent=e.format(t.forks_count??0)),r&&(r.textContent=t.license?.spdx_id??"No License")}const i=`github-repo-${e}`,m=sessionStorage.getItem(i);if(m){c(JSON.parse(m))}else try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok){if(n){const e=404===t.status?"Repository not found":"Failed to load repository data";n.textContent=e}return}const o=await t.json();sessionStorage.setItem(i,JSON.stringify(o)),c(o)}catch(t){console.error(`Failed to fetch ${e}:`,t)}}function f(){const t=document.getElementsByClassName("gc-container");0!==t.length&&Array.from(t).forEach((t=>{p(t)}))}document.addEventListener("astro:page-load",f),f()</script><script type=module src=/_astro/MediaEmbed.astro_astro_type_script_index_0_lang.wKrCMCCr.js></script><script type=module>const n={overlay:document.querySelector(".zoom-overlay"),zoomedImg:null,originalImg:null,createOverlay(){this.overlay&&this.overlay.isConnected||(this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-label","Image Viewer"),this.overlay.setAttribute("tabindex","-1"),Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",backgroundColor:"oklch(var(--un-preset-theme-colors-background) / 0.95)",opacity:"0",transition:"opacity 300ms cubic-bezier(0.4, 0, 0.2, 1)",cursor:"zoom-out",display:"none"}),document.body.appendChild(this.overlay))},zoomImg(e){if(!this.overlay)return;document.body.style.overflow="hidden";const t=e.getBoundingClientRect();this.originalImg=e,this.zoomedImg=e.cloneNode(),Object.assign(this.zoomedImg.style,{position:"fixed",top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",zIndex:"1000",cursor:"zoom-out"}),document.body.appendChild(this.zoomedImg),this.overlay.style.display="block",this.overlay.focus();const o=window.innerWidth,i=window.innerHeight,s=window.innerWidth<768?1:.8,l=Math.min(o*s/t.width,i*s/t.height),a=(-t.left+(o-t.width)/2)/l,n=(-t.top+(i-t.height)/2)/l;requestAnimationFrame((()=>{this.overlay&&(this.overlay.style.opacity="1"),this.zoomedImg&&(this.zoomedImg.style.transform=`scale(${l}) translate3d(${a}px, ${n}px, 0)`)}))},close(){!this.overlay||!this.zoomedImg||!this.originalImg||(this.zoomedImg.style.transform="",this.overlay.style.opacity="0",document.body.style.overflow="",setTimeout((()=>{this.zoomedImg&&this.zoomedImg.parentNode&&document.body.removeChild(this.zoomedImg),this.zoomedImg=null,this.overlay&&(this.overlay.style.display="none"),this.originalImg&&this.originalImg.focus(),this.originalImg=null}),300))},setupOverlay(){this.createOverlay(),this.zoomedImg=null,this.originalImg=null},handleClick(e){if(this.zoomedImg)return void this.close();const t=e.target;t instanceof HTMLImageElement&&t.complete&&t.naturalWidth>=100&&t.naturalHeight>=100&&this.zoomImg(t)},handleResize(){this.zoomedImg&&this.close()},init(){this.createOverlay(),document.addEventListener("astro:page-load",(()=>this.setupOverlay())),document.addEventListener("click",(e=>this.handleClick(e)),{passive:!0}),window.addEventListener("resize",(()=>this.handleResize()),{passive:!0})}};n.init()</script></body></html>
<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color media="(prefers-color-scheme: light)"><meta content=#222 name=theme-color media="(prefers-color-scheme: dark)"><meta content="Hexo 8.0.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link href=/images/logo.svg rel=mask-icon color=#222><link href=/css/main.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet crossorigin=anonymous integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM="><link href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet crossorigin=anonymous integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE="><script class=next-config data-name=main type=application/json>{"hostname":"lifeodyssey.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.25.0","exturl":true,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"base16/tomorrow-night"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"max"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src=/js/config.js defer=defer></script><meta content="Ordinary Kriging Poisson Kriging-Area to Area Poisson Kriging-Area to Point These are the three types inside https:&#x2F;&#x2F;github.com&#x2F;szymon-datalions&#x2F;pyinterpolate I also wan to show how to apply them to s" name=description><meta content=article property=og:type><meta content=kriging property=og:title><meta content=https://lifeodyssey.github.io/posts/f4af350.html property=og:url><meta content=乔克叔叔的床边故事 property=og:site_name><meta content="Ordinary Kriging Poisson Kriging-Area to Area Poisson Kriging-Area to Point These are the three types inside https:&#x2F;&#x2F;github.com&#x2F;szymon-datalions&#x2F;pyinterpolate I also wan to show how to apply them to s" property=og:description><meta content=en_US property=og:locale><meta content=2020-10-22T02:53:33.000Z property=article:published_time><meta content=2025-09-30T10:12:48.219Z property=article:modified_time><meta content=周大侠 property=article:author><meta content="Kriging model" property=article:tag><meta content="Spatial staticstics" property=article:tag><meta content=summary name=twitter:card><link href=https://lifeodyssey.github.io/posts/f4af350.html rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://lifeodyssey.github.io/posts/f4af350.html","path":"posts/f4af350.html","title":"kriging"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>kriging | 乔克叔叔的床边故事</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-135697820-1" async></script><script class=next-config data-name=google_analytics type=application/json>{"tracking_id":"UA-135697820-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src=/js/third-party/analytics/google-analytics.js defer=defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js defer=defer crossorigin=anonymous integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY="></script><script src=/js/utils.js defer=defer></script><script src=/js/motion.js defer=defer></script><script src=/js/sidebar.js defer=defer></script><script src=/js/next-boot.js defer=defer></script><script src=/js/bookmark.js defer=defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js defer=defer crossorigin=anonymous integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg="></script><script src=/js/third-party/search/local-search.js defer=defer></script><script class=next-config data-name=pdf type=application/json>{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script><script src=/js/third-party/tags/pdf.js defer=defer></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":"forest","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script src=/js/third-party/tags/mermaid.js defer=defer></script><script class=next-config data-name=enableMath type=application/json>true</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src=/js/third-party/math/mathjax.js defer=defer></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><link href=/atom.xml rel=alternate type=application/atom+xml title=乔克叔叔的床边故事></head><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button aria-label="Toggle navigation bar"><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><p class=site-title>乔克叔叔的床边故事</p><i class=logo-line></i></a></div><div class=site-nav-right><div class="toggle popup-trigger" role=button aria-label=Search><i class="fa fa-fw fa-search fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-fw fa-home"></i>Home</a></li><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-fw fa-user"></i>About</a></li><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-fw fa-tags"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-fw fa-th"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-fw fa-archive"></i>Archives</a></li><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-fw fa-search"></i>Search</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-5x fa-pulse fa-spinner"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents</li><li class=sidebar-nav-overview>Overview</li></ul><div class=sidebar-panel-container><div class="sidebar-panel post-toc-wrap"><div class="animated post-toc"><ol class=nav><li class="nav-item nav-level-1"><a href=#general-introduction class=nav-link><span class=nav-number>1.</span> <span class=nav-text>General Introduction</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a href=#problem-setup class=nav-link><span class=nav-number>1.1.</span> <span class=nav-text>Problem Setup</span></a></li><li class="nav-item nav-level-2"><a href=#variogram class=nav-link><span class=nav-number>1.2.</span> <span class=nav-text>Variogram</span></a></li><li class="nav-item nav-level-2"><a href=#solving-model class=nav-link><span class=nav-number>1.3.</span> <span class=nav-text>Solving model</span></a></li><li class="nav-item nav-level-2"><a href=#several-assumpution class=nav-link><span class=nav-number>1.4.</span> <span class=nav-text>Several Assumpution</span></a></li><li class="nav-item nav-level-2"><a href=#pros-and-cons class=nav-link><span class=nav-number>1.5.</span> <span class=nav-text>Pros and Cons</span></a></li></ol></li><li class="nav-item nav-level-1"><a href=#ordinary-kriging class=nav-link><span class=nav-number>2.</span> <span class=nav-text>Ordinary Kriging</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a href=#theory-of-ordinary-kriging class=nav-link><span class=nav-number>2.1.</span> <span class=nav-text>THEORY OF ORDINARY KRIGING</span></a></li><li class="nav-item nav-level-2"><a href=#weights class=nav-link><span class=nav-number>2.2.</span> <span class=nav-text>WEIGHTS</span></a></li></ol></li><li class="nav-item nav-level-1"><a href=#covariance-and-variogram class=nav-link><span class=nav-number>3.</span> <span class=nav-text>Covariance and Variogram</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a href=#a-stochastic-approach-to-spatial-variation-the-theory-of-regionalized-variables class=nav-link><span class=nav-number>3.1.</span> <span class=nav-text>A STOCHASTIC APPROACH TO SPATIAL VARIATION: THE THEORY OF REGIONALIZED VARIABLES</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a href=#random-variables class=nav-link><span class=nav-number>3.1.1.</span> <span class=nav-text>Random variables</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a href=#poisson-kriging-area-to-area class=nav-link><span class=nav-number>4.</span> <span class=nav-text>Poisson Kriging-Area to Area</span></a></li></ol></div></div><!--/noindex--><div class="sidebar-panel site-overview-wrap"><div class="animated site-author" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>周大侠</p><div class=site-description itemprop=description></div></div><div class="animated site-state-wrap"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>165</span> <span class=site-state-item-name>posts</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>17</span> <span class=site-state-item-name>categories</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>97</span> <span class=site-state-item-name>tags</span></a></div></nav></div><div class="animated links-of-author"><span class=links-of-author-item><span class=exturl data-url=aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5 title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lifeodyssey"><i class="fa-fw fab fa-github"></i>GitHub</span> </span><span class=links-of-author-item><span class=exturl data-url="bWFpbHRvOnpoZW5qaWF6aG91MDEyN0BnbWFpbC5jb20=" title="E-Mail → mailto:zhenjiazhou0127@gmail.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span> </span><span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL1poZW5qaWFfWmhvdQ==" title="Researchgate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Zhenjia_Zhou"><i class="fa fa-fw fa-researchgate"></i>Researchgate</span> </span><span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3poZW5qaWEtemhvdS8=" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;zhenjia-zhou&#x2F;"><i class="fa fa-fw fa-Linkedin"></i>Linkedin</span> </span><span class=links-of-author-item><a href=/atom.xml rel="noopener me" title="RSS → &#x2F;atom.xml"><i class="fa-fw rss"></i>RSS</a></span></div><div class="animated cc-license" itemprop=license><span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><img src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg alt="Creative Commons"></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://lifeodyssey.github.io/posts/f4af350.html itemprop=mainEntityOfPage><span itemprop=author itemscope itemtype=http://schema.org/Person hidden><meta content=/images/avatar.gif itemprop=image><meta content=周大侠 itemprop=name></span><span itemprop=publisher itemscope itemtype=http://schema.org/Organization hidden><meta content=乔克叔叔的床边故事 itemprop=name><meta content="" itemprop=description></span><span itemprop=post itemscope itemtype=http://schema.org/CreativeWork hidden><meta content="kriging | 乔克叔叔的床边故事" itemprop=name><meta content="" itemprop=description></span><header class=post-header><h1 class=post-title itemprop="name headline">kriging</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>Posted on</span> <time datetime=2020-10-22T10:53:33+08:00 itemprop="dateCreated datePublished" title="Created: 2020-10-22 10:53:33">2020-10-22</time> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder"></i> </span><span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/ rel=index itemprop=url><span itemprop=name>学习笔记</span></a> </span></span><span class=post-meta-break></span> <span class=post-meta-item title="Word count in article"><span class=post-meta-item-icon><i class="far fa-file-word"></i> </span><span class=post-meta-item-text>Word count in article: </span><span>9.9k</span> </span><span class=post-meta-item title="Reading time"><span class=post-meta-item-icon><i class="far fa-clock"></i> </span><span class=post-meta-item-text>Reading time &asymp;</span> <span>36 mins.</span></span></div></div></header><div class=post-body itemprop=articleBody><p>Ordinary Kriging</p><p>Poisson Kriging-Area to Area</p><p>Poisson Kriging-Area to Point</p><p>These are the three types inside https://github.com/szymon-datalions/pyinterpolate</p><p>I also wan to show how to apply them to satellite image as an practice for APTRK</p><span id=more></span><h1 id=general-introduction>General Introduction</h1><p>Reference: https://www.youtube.com/watch?v=J-IB4_QL7Oc</p><h2 id=problem-setup>Problem Setup</h2><p><img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110419095.png /></p><p>Here we have a island and we take some measurement for some red points. Each point include two attributes. <span class="math inline"><em>x</em><sub><em>i</em></sub></span> is the location and <span class="math inline"><em>y</em><sub><em>i</em></sub></span> is the thing we are interested in, like elevation.</p><p>Now we want to get the elevation in some other point that we did not explicitly collect data. For example in this black dot.</p><p><img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110833500.png /></p><p>So we just could use the data we have to predict the elevation of black dot. There are five closest red dots to this unknown dot. We are gonna to use these five dots to predict the unknown dots. <span class="math display">$$ y_{new}=w^Ty+\epsilon_{new}\\ =w_1y_1+w_2y_2+...+w_5y_5+\epsilon_{new} $$</span> This is a linear combination weight of neighbor dots. This is the kirging model. So the important thing is to know the <span class="math inline"><em>w</em></span> .</p><h2 id=variogram>Variogram</h2><p>A general idea is that the closer one should have higher weigh. But how do I formalize this idea in math? Here the things determines the weight is called the variogram. <span class="math display">$$ \gamma(x_i,x_j)=\frac{1}{2}(y_i-y_j)^2 $$</span> This is the equation of variogram. <span class="math inline">(<em>x</em><sub><em>i</em></sub>, <em>x</em><sub><em>j</em></sub>)</span> indicate the distance between two points. The distance is the input of <span class="math inline"><em>γ</em></span> function. And the output of <span class="math inline"><em>γ</em></span> function is half the difference of elevation. It should be increasing function since the smaller distance, the smaller difference.</p><p>So lets plot the graph between H, the distance <span class="math inline">(<em>x</em><sub><em>i</em></sub>, <em>x</em><sub><em>j</em></sub>)</span> and the output of <span class="math inline"><em>γ</em></span> function.</p><p><img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022142200533.png /></p><p>This graph should reach the plateau as H increase. Because if the distance is two large, the difference should be almost the same, which indicate that the elevation belong to different group.</p><p>There are some terminology here. First is the nugget. The nugget is the intercept that our graph begin. It should be not equal to zero. Because the variogram is a fit line and maybe we have a lot of closed dot with different elevation. But it shoul be small.</p><p>Second one is the sill. Sill is the silling of a variogram. And the he range is the H value of sill.</p><h2 id=solving-model>Solving model</h2><p>So we can get the weight from the variogram by solving a matrix equation.</p><p><span class="math inline"><em>A</em><em>w</em> = <em>b</em></span></p><p>Here A is the <span class="math inline"><em>γ</em>(<em>x</em><sub><em>i</em></sub>, <em>x</em><sub><em>j</em></sub>)</span> and b is the <span class="math inline"><em>γ</em>(<em>x</em><sub><em>n</em><em>e</em><em>w</em></sub>, <em>x</em><sub><em>i</em></sub>)</span>, <span class="math inline"><em>w</em></span> is the vector from <span class="math inline"><em>w</em><sub>1</sub></span> to<span class="math inline"><em>w</em><sub>5</sub></span></p><p>So I can just take a inverse to get the <span class="math inline"><em>w</em></span>.</p><h2 id=several-assumpution>Several Assumpution</h2><ol type=1><li>Stationarity: In every small part of island, the change speed of elevation should be almost the same.</li><li>Constant variogram. In every small part of the island, the variogram shoul be almost the same.</li></ol><h2 id=pros-and-cons>Pros and Cons</h2><p>Pros: we can estimate the error</p><p>Cons: For every new point, we need to solve different equation matrix.</p><h1 id=ordinary-kriging>Ordinary Kriging</h1><p>Refference: Olea R A. Geostatistics for engineers and earth scientists[M]. Springer Science &amp; Business Media, 2012.</p><p>The kriging model we describe before is the ordinary kriging. Kriging covers a range of least-squares methods of spatial prediction.</p><ul><li>􏰀 Ordinary kriging of a single variable, as described in Section 8.2, is the most robust method and the one most used.</li><li>􏰀 Simple kriging (Section 8.9) is rather little used as it stands because we usually do not know the mean. It finds application in other forms such as indicator and disjunctive kriging in which the data are transformed to have known means.</li><li>􏰀 Lognormal kriging (Section 8.10) is ordinary kriging of the logarithms of the measured values. It is used for strongly positively skewed data that approximate a lognormal distribution.</li><li>􏰀 Kriging with drift (Chapter 9), also known as universal kriging, recognizes both non-stationary deterministic and random components in a variable, estimates the trend in the former and the variogram of the latter, and recombines the two for prediction. This introduces residual maximum likelihood into the kriging procedure (see Section 9.2).</li><li>􏰀 Factorial kriging or kriging analysis (Chapter 9) is of particular value where the variation is nested, i.e. more than one scale of variation is present. Factorial kriging estimates the individual components of variation sepa- rately, but in a single analysis.</li><li>􏰀 Ordinary cokriging (Chapter 10) is the extension of ordinary kriging of a single variable to two or more variables. There must be some coregionaliza- tion among the variables for it to be profitable. It is particularly useful if some property that can be measured cheaply at many sites is spatially correlated with one or more others that are expensive to measure and are measured at many fewer sites. It enables us to estimate the more sparsely sampled property with more precision by cokriging using the spatial information from the more intensely measured one.</li><li>􏰀 Indicator kriging (see Chapter 11) is a non-linear, non-parametric form of kriging in which continuous variables are converted to binary ones (indicators). It is becoming popular because it can handle distribu- tions of almost any kind, and empirical cumulative distributions of estimates can be computed and thereby provide confidence limits on them. It can also accommodate ‘soft’ qualitative information to improve prediction.</li><li>􏰀 Disjunctive kriging (see Chapter 11) is also a non-linear method of kriging, but it is strictly parametric. It is valuable for decision-making because the probabilities of exceeding or not exceeding a predefined threshold are determined in addition to the kriged estimates.</li><li>􏰀 Probability kriging (not described further in this book) was proposed by Sullivan (1984) because indicator kriging does not take into account the proximity of a value to the threshold, but only its position. It uses the rank order for each value, zðxÞ, normalized to 1 as the secondary variable to estimate the indicator by cokriging. Chile`s and Delfiner (1999) and Goo- vaerts (1997) describe the method briefly.</li><li>􏰀 Bayesian kriging (not described further in this book) was introduced by Omre (1987) for situations in which there is some prior knowledge about the drift. It is intermediate between simple kriging, used when there is no drift, and universal kriging where there is known to be drift. The kriging equations are those of simple kriging, but with non-stationary covariances (Chile`s and Delfiner, 1999).</li></ul><p>Here I just gonna to talk about the three kinds of kriging model. For further you can just find that textbook.</p><p>But before we talk more deeply about that two type. Lets write the former introduction more detailed.</p><h2 id=theory-of-ordinary-kriging>THEORY OF ORDINARY KRIGING</h2><p>The aim of kriging is to estimate the value of a random variable,<span class="math inline"><em>Z</em></span>, at one or more unsampled points or over larger blocks, from more or less sparse sample data on a given support, say <span class="math inline"><em>z</em>(<strong>x</strong><sub>1</sub>), <em>z</em>(<strong>x</strong><sub>2</sub>), ..., <em>z</em>(<strong>x</strong><sub><em>N</em></sub>)</span>, at points <span class="math inline"><strong>x</strong><sub>1</sub>, <strong>x</strong><sub>2</sub>, ..., <strong>x</strong><sub><em>N</em></sub></span>. The data may be distributed in one, two or three dimensions, though applications in the environmental sciences are usually two-dimensional.</p><p>Ordinary kriging is by far the most common type of kriging in practice,and for this reason we focus on its theory here. It is based on the assumption that we do not know the mean. If we consider punctual estimation first, then we estimate <span class="math inline"><em>Z</em></span> at a point <span class="math inline"><strong>x</strong><sub>0</sub></span>by <span class="math inline"><em>Ẑ</em>(<strong>x</strong><sub>0</sub>)</span>, with the same support as the data, by <span class="math display">$$ \hat{Z}(\boldsymbol{x}_0)=\sum_{i=1}^{N}\lambda_i(\boldsymbol{x}_i), $$</span> where <span class="math inline"><em>λ</em><sub><em>i</em></sub></span> are the weights. To ensure that the estimate is unbiased the weights are made to sum to 1, <span class="math display">$$ \sum_{i=1}^{N}\lambda_i=1 $$</span></p><blockquote><p>Review about the unbiased, consistent, efficient estimator https://en.wikipedia.org/wiki/Consistent_estimator#Unbiased_but_not_consistent</p></blockquote><p>and the expected error is <span class="math inline"><em>E</em>[<em>Ẑ</em>(<strong>x</strong><sub>0</sub>) − <em>Z</em>(<strong>x</strong><sub>0</sub>)] = 0</span>.</p><p>The estimation variance is <span class="math display">$$ var[\hat{Z}(\boldsymbol{x}_0)]=E[\{\hat{Z}(\boldsymbol{x}_0)-Z(\boldsymbol{x}_0)\}^2]\\ =2\sum_{i=1}^{N}\lambda_i\gamma(\boldsymbol{x}_i,\boldsymbol{x}_0)-\sum_{i=1}^{N}\sum_{i=1}^{N}\lambda_i\lambda_j\gamma(\boldsymbol{x}_i,\boldsymbol{x}_j) $$</span> where <span class="math inline"><em>γ</em>(<strong>x</strong><sub><em>i</em></sub>, <strong>x</strong><sub><em>j</em></sub>)</span> is the semivariance of <span class="math inline"><em>Z</em></span> between the data points<span class="math inline"><strong>x</strong><sub><em>i</em></sub></span> and <span class="math inline"><strong>x</strong><sub><em>j</em></sub></span>, and <span class="math inline"><em>γ</em>(<strong>x</strong><sub><em>i</em></sub>, <strong>x</strong><sub>0</sub>)</span> is the semivariance between the ith data point and the target point <span class="math inline"><em>x</em><sub>0</sub></span>.</p><blockquote><p>Semi variance:http://www.kgs.ku.edu/Tis/surf3/s3krig2.html</p></blockquote><p>In the more general case we may wish to estimate <span class="math inline"><em>Z</em></span> in a block <span class="math inline"><em>B</em></span>, which may be a line, an area or a volume depending on whether it is in one, two or three spatial dimensions. The kriged estimate in <span class="math inline"><em>B</em></span> is still a simple weighted average of the data, <span class="math display">$$ \hat{Z}(\boldsymbol{B})=\sum_{i=1}^{N}\lambda_iz(\boldsymbol{x}_i), $$</span> but with <span class="math inline"><em>x</em><sub>0</sub></span> of equation (3) replaced by <span class="math inline"><em>B</em></span>. Its variance is <span class="math display">$$ var[\hat{Z}(\boldsymbol{B})]=E[\{\hat{Z}(\boldsymbol{B})-Z(\boldsymbol{B})\}^2]\\ =2\sum_{i=1}^{N}\lambda_i\gamma(\boldsymbol{x}_i,\boldsymbol{B})-\sum_{i=1}^{N}\sum_{i=1}^{N}\lambda_i\lambda_j\gamma(\boldsymbol{x}_i,\boldsymbol{x}_j)-\bar{\gamma}(B,B). $$</span> The quantity <span class="math inline"><em>γ̄</em>(<strong>x</strong><sub><em>i</em></sub>, <em>B</em>)</span> is the average semivariance between the <span class="math inline"><em>i</em></span>th sampling point and the block <span class="math inline"><em>B</em></span> and is the integral <span class="math display">$$ $\bar\gamma(\boldsymbol{x}_i,B)$ =\frac{1}{B}\int_B\gamma(\boldsymbol{x}_i,\boldsymbol{x})d\boldsymbol{x}, $$</span> where <span class="math inline"><em>γ</em>(<strong>x</strong><sub><em>i</em></sub>, <strong>x</strong>)</span> denotes the semivariance between the sampling point xi and a point x describing the block.</p><p><img src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022160855202.png /></p><p>The third term on the right-hand side of equation (7) is the double integral <span class="math display">$$ \bar{\gamma}(B,B)=\frac{1}{|B^2|}\int_B\int_B\gamma(\boldsymbol{x},\boldsymbol{x^{\prime}})d\boldsymbol{x}d\boldsymbol{x^{\prime}} $$</span> where <span class="math inline"><em>γ</em>(<strong>x</strong>, <strong>x</strong><sup><strong>′</strong></sup>)</span> is the semivariance between two points <span class="math inline"><em>x</em></span> and <span class="math inline"><em>x</em><sup>′</sup></span> that sweep independently over B. It is the within-block variance. In punctual kriging <span class="math inline"><em>γ̄</em>(<em>B</em>, <em>B</em>)</span>becomes <span class="math inline"><em>γ̄</em>(<em>x</em><sub>0</sub>, <em>x</em><sub>0</sub>) = 0</span>, which is why equation (5) has two terms rather than three.</p><p>For each kriged estimate there is an associated kriging variance, which we can denote by <span class="math inline"><em>σ</em><sup>2</sup>(<strong>x</strong><sub>0</sub>)</span> and <span class="math inline"><em>σ</em><sup>2</sup>(<em>B</em>)</span> for the point and block, respectively, and which are defined in equation(5) and equation(7).</p><p>The next step in kriging is to find the weights that minimize these variances, subject to the constraint that they sum to 1. We achieve this using the method of Lagrange multipliers.</p><p>Here I do not want to show how Lagrange multipliers works. Anyway this post is just a general introduction.</p><h2 id=weights>WEIGHTS</h2><p>When the kriging equations are solved to obtain the weights, <span class="math inline"><em>λ</em><sub><em>i</em></sub></span>, in general the only large weights are those of the points near to the point or block to be kriged. The nearest four or five might contribute 80% of the total weight, and the next nearest ten almost all of the remainder. The weights also depend on the configuration of the sampling. We can summarize the factors affecting the weights as follows.</p><ol type=1><li>Near points carry more weight than more distant ones. Their relative proportions depend on the positions of the sampling points and on the variogram: the larger is the nugget variance, the smaller are the weights of the points that are nearest to target point or block.</li><li>The relative weights of points also depend on the block size: as the block size increases, the weights of the nearest points decrease and those of the more distant points increase , until the weights become nearly equal.</li><li>Clustered points carry less weight individually than isolated ones at the same distance</li><li>Data points can be screened by ones lying between them and the target</li></ol><p>These effects are all intuitively desirable, and the first shows that kriging is local. They will become evident in the examples below. They also have practical implications. The most important for present purposes is that because only the nearest few data points to the target carry significant weight, matrix A in the kriging system need never be large and its inversion will be swift.</p><h1 id=covariance-and-variogram>Covariance and Variogram</h1><p>Before we step into the next one, we need to clarify some basic definition.</p><p>This part also comes from the previous textbook.</p><h2 id=a-stochastic-approach-to-spatial-variation-the-theory-of-regionalized-variables>A STOCHASTIC APPROACH TO SPATIAL VARIATION: THE THEORY OF REGIONALIZED VARIABLES</h2><h3 id=random-variables>Random variables</h3><h1 id=poisson-kriging-area-to-area>Poisson Kriging-Area to Area</h1></div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>Post author: </strong>周大侠</li><li class=post-copyright-link><strong>Post link: </strong><a href=https://lifeodyssey.github.io/posts/f4af350.html title=kriging>https://lifeodyssey.github.io/posts/f4af350.html</a></li><li class=post-copyright-license><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class=exturl data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><i class="fa-fw fab fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.</li></ul></div><div class=post-tags><a href=/tags/Kriging-model/ rel=tag># Kriging model</a> <a href=/tags/Spatial-staticstics/ rel=tag># Spatial staticstics</a></div><div class=post-nav><div class=post-nav-item><a href=/posts/3d8d27aa.html rel=prev title="Annotated Bibliography 2020 10.5-10.11"><i class="fa fa-angle-left"></i> Annotated Bibliography 2020 10.5-10.11</a></div><div class=post-nav-item><a href=/posts/39e89397.html rel=next title=np.ma.mask>np.ma.mask <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2016 – <span itemprop=copyrightYear>2025</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>周大侠</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i> </span><span title="Word count total">794k</span> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i> </span><span title="Reading time total">48:07</span></span></div><div class=powered-by>Powered by <span class=exturl data-url=aHR0cHM6Ly9oZXhvLmlv>Hexo</span> & <span class=exturl data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><div class=sidebar-dimmer></div><div class=back-to-top role=button aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class=reading-progress-bar></div><a class="book-mark-link book-mark-link-fixed" role=button></a> <span class="exturl github-corner" data-url=aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5 title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg aria-hidden=true height=80 viewBox="0 0 250 250" width=80><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" class=octo-arm fill=currentColor style="transform-origin:130px 106px"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" class=octo-body fill=currentColor></path></svg></span><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript></body></html>
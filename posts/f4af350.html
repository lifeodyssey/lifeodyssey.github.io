<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lifeodyssey.github.io","root":"/","scheme":"Mist","version":"8.0.0-rc.5","exturl":true,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="Ordinary Kriging Poisson Kriging-Area to Area Poisson Kriging-Area to Point These are the three types inside https:&#x2F;&#x2F;github.com&#x2F;szymon-datalions&#x2F;pyinterpolate I also wan to show how to apply them to s">
<meta property="og:type" content="article">
<meta property="og:title" content="kriging">
<meta property="og:url" content="https://lifeodyssey.github.io/posts/f4af350.html">
<meta property="og:site_name" content="乔克叔叔的床边故事">
<meta property="og:description" content="Ordinary Kriging Poisson Kriging-Area to Area Poisson Kriging-Area to Point These are the three types inside https:&#x2F;&#x2F;github.com&#x2F;szymon-datalions&#x2F;pyinterpolate I also wan to show how to apply them to s">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110419095.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110833500.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022142200533.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022160855202.png">
<meta property="article:published_time" content="2020-10-22T01:53:33.000Z">
<meta property="article:modified_time" content="2020-11-15T03:53:03.487Z">
<meta property="article:author" content="周大侠">
<meta property="article:tag" content="Kriging model">
<meta property="article:tag" content="Spatial staticstics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110419095.png">

<link rel="canonical" href="https://lifeodyssey.github.io/posts/f4af350.html">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>kriging | 乔克叔叔的床边故事</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135697820-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135697820-1');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="乔克叔叔的床边故事" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">乔克叔叔的床边故事</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#general-introduction"><span class="nav-number">1.</span> <span class="nav-text">General Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#problem-setup"><span class="nav-number">1.1.</span> <span class="nav-text">Problem Setup</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#variogram"><span class="nav-number">1.2.</span> <span class="nav-text">Variogram</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#solving-model"><span class="nav-number">1.3.</span> <span class="nav-text">Solving model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#several-assumpution"><span class="nav-number">1.4.</span> <span class="nav-text">Several Assumpution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pros-and-cons"><span class="nav-number">1.5.</span> <span class="nav-text">Pros and Cons</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ordinary-kriging"><span class="nav-number">2.</span> <span class="nav-text">Ordinary Kriging</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#theory-of-ordinary-kriging"><span class="nav-number">2.1.</span> <span class="nav-text">THEORY OF ORDINARY KRIGING</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#weights"><span class="nav-number">2.2.</span> <span class="nav-text">WEIGHTS</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#covariance-and-variogram"><span class="nav-number">3.</span> <span class="nav-text">Covariance and Variogram</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#a-stochastic-approach-to-spatial-variation-the-theory-of-regionalized-variables"><span class="nav-number">3.1.</span> <span class="nav-text">A STOCHASTIC APPROACH TO SPATIAL VARIATION: THE THEORY OF REGIONALIZED VARIABLES</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#random-variables"><span class="nav-number">3.1.1.</span> <span class="nav-text">Random variables</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#poisson-kriging-area-to-area"><span class="nav-number">4.</span> <span class="nav-text">Poisson Kriging-Area to Area</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">周大侠</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lifeodyssey"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnpoZW5qaWF6aG91MDEyN0BnbWFpbC5jb20=" title="E-Mail → mailto:zhenjiazhou0127@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL1poZW5qaWFfWmhvdQ==" title="Researchgate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Zhenjia_Zhou"><i class="fa fa-researchgate fa-fw"></i>Researchgate</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luLyVFNiU4QyVBRiVFNCVCRCVCMy0lRTUlOTElQTgtODMyNmI0MTU1Lw==" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;%E6%8C%AF%E4%BD%B3-%E5%91%A8-8326b4155&#x2F;"><i class="fa fa-Linkedin fa-fw"></i>Linkedin</span>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lifeodyssey.github.io/posts/f4af350.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="周大侠">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乔克叔叔的床边故事">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          kriging
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-22 10:53:33" itemprop="dateCreated datePublished" datetime="2020-10-22T10:53:33+09:00">2020-10-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-15 12:53:03" itemprop="dateModified" datetime="2020-11-15T12:53:03+09:00">2020-11-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>10 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Ordinary Kriging</p>
<p>Poisson Kriging-Area to Area</p>
<p>Poisson Kriging-Area to Point</p>
<p>These are the three types inside https://github.com/szymon-datalions/pyinterpolate</p>
<p>I also wan to show how to apply them to satellite image as an practice for APTRK</p>
<a id="more"></a>
<h1 id="general-introduction">General Introduction</h1>
<p>Reference: https://www.youtube.com/watch?v=J-IB4_QL7Oc</p>
<h2 id="problem-setup">Problem Setup</h2>
<p><img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110419095.png"></p>
<p>Here we have a island and we take some measurement for some red points. Each point include two attributes. <span class="math inline">\(x_i\)</span> is the location and <span class="math inline">\(y_i\)</span> is the thing we are interested in, like elevation.</p>
<p>Now we want to get the elevation in some other point that we did not explicitly collect data. For example in this black dot.</p>
<p><img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022110833500.png"></p>
<p>So we just could use the data we have to predict the elevation of black dot. There are five closest red dots to this unknown dot. We are gonna to use these five dots to predict the unknown dots. <span class="math display">\[
y_{new}=w^Ty+\epsilon_{new}\\
=w_1y_1+w_2y_2+...+w_5y_5+\epsilon_{new}
\]</span> This is a linear combination weight of neighbor dots. This is the kirging model. So the important thing is to know the <span class="math inline">\(w\)</span> .</p>
<h2 id="variogram">Variogram</h2>
<p>A general idea is that the closer one should have higher weigh. But how do I formalize this idea in math? Here the things determines the weight is called the variogram. <span class="math display">\[
\gamma(x_i,x_j)=\frac{1}{2}(y_i-y_j)^2
\]</span> This is the equation of variogram. <span class="math inline">\((x_i,x_j)\)</span> indicate the distance between two points. The distance is the input of <span class="math inline">\(\gamma\)</span> function. And the output of <span class="math inline">\(\gamma\)</span> function is half the difference of elevation. It should be increasing function since the smaller distance, the smaller difference.</p>
<p>So lets plot the graph between H, the distance <span class="math inline">\((x_i,x_j)\)</span> and the output of <span class="math inline">\(\gamma\)</span> function.</p>
<p><img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022142200533.png"></p>
<p>This graph should reach the plateau as H increase. Because if the distance is two large, the difference should be almost the same, which indicate that the elevation belong to different group.</p>
<p>There are some terminology here. First is the nugget. The nugget is the intercept that our graph begin. It should be not equal to zero. Because the variogram is a fit line and maybe we have a lot of closed dot with different elevation. But it shoul be small.</p>
<p>Second one is the sill. Sill is the silling of a variogram. And the he range is the H value of sill.</p>
<h2 id="solving-model">Solving model</h2>
<p>So we can get the weight from the variogram by solving a matrix equation.</p>
<p><span class="math inline">\(Aw=b\)</span></p>
<p>Here A is the <span class="math inline">\(\gamma(x_i,x_j)\)</span> and b is the <span class="math inline">\(\gamma(x_{new},x_i)\)</span>, <span class="math inline">\(w\)</span> is the vector from <span class="math inline">\(w_1\)</span> to<span class="math inline">\(w_5\)</span></p>
<p>So I can just take a inverse to get the <span class="math inline">\(w\)</span>.</p>
<h2 id="several-assumpution">Several Assumpution</h2>
<ol type="1">
<li>Stationarity: In every small part of island, the change speed of elevation should be almost the same.</li>
<li>Constant variogram. In every small part of the island, the variogram shoul be almost the same.</li>
</ol>
<h2 id="pros-and-cons">Pros and Cons</h2>
<p>Pros: we can estimate the error</p>
<p>Cons: For every new point, we need to solve different equation matrix.</p>
<h1 id="ordinary-kriging">Ordinary Kriging</h1>
<p>Refference: Olea R A. Geostatistics for engineers and earth scientists[M]. Springer Science &amp; Business Media, 2012.</p>
<p>The kriging model we describe before is the ordinary kriging. Kriging covers a range of least-squares methods of spatial prediction.</p>
<ul>
<li>􏰀 Ordinary kriging of a single variable, as described in Section 8.2, is the most robust method and the one most used.</li>
<li>􏰀 Simple kriging (Section 8.9) is rather little used as it stands because we usually do not know the mean. It finds application in other forms such as indicator and disjunctive kriging in which the data are transformed to have known means.</li>
<li>􏰀 Lognormal kriging (Section 8.10) is ordinary kriging of the logarithms of the measured values. It is used for strongly positively skewed data that approximate a lognormal distribution.</li>
<li>􏰀 Kriging with drift (Chapter 9), also known as universal kriging, recognizes both non-stationary deterministic and random components in a variable, estimates the trend in the former and the variogram of the latter, and recombines the two for prediction. This introduces residual maximum likelihood into the kriging procedure (see Section 9.2).</li>
<li>􏰀 Factorial kriging or kriging analysis (Chapter 9) is of particular value where the variation is nested, i.e. more than one scale of variation is present. Factorial kriging estimates the individual components of variation sepa- rately, but in a single analysis.</li>
<li>􏰀 Ordinary cokriging (Chapter 10) is the extension of ordinary kriging of a single variable to two or more variables. There must be some coregionaliza- tion among the variables for it to be profitable. It is particularly useful if some property that can be measured cheaply at many sites is spatially correlated with one or more others that are expensive to measure and are measured at many fewer sites. It enables us to estimate the more sparsely sampled property with more precision by cokriging using the spatial information from the more intensely measured one.</li>
<li>􏰀 Indicator kriging (see Chapter 11) is a non-linear, non-parametric form of kriging in which continuous variables are converted to binary ones (indicators). It is becoming popular because it can handle distribu- tions of almost any kind, and empirical cumulative distributions of estimates can be computed and thereby provide confidence limits on them. It can also accommodate ‘soft’ qualitative information to improve prediction.</li>
<li>􏰀 Disjunctive kriging (see Chapter 11) is also a non-linear method of kriging, but it is strictly parametric. It is valuable for decision-making because the probabilities of exceeding or not exceeding a predefined threshold are determined in addition to the kriged estimates.</li>
<li>􏰀 Probability kriging (not described further in this book) was proposed by Sullivan (1984) because indicator kriging does not take into account the proximity of a value to the threshold, but only its position. It uses the rank order for each value, zðxÞ, normalized to 1 as the secondary variable to estimate the indicator by cokriging. Chile`s and Delfiner (1999) and Goo- vaerts (1997) describe the method briefly.</li>
<li>􏰀 Bayesian kriging (not described further in this book) was introduced by Omre (1987) for situations in which there is some prior knowledge about the drift. It is intermediate between simple kriging, used when there is no drift, and universal kriging where there is known to be drift. The kriging equations are those of simple kriging, but with non-stationary covariances (Chile`s and Delfiner, 1999).</li>
</ul>
<p>Here I just gonna to talk about the three kinds of kriging model. For further you can just find that textbook.</p>
<p>But before we talk more deeply about that two type. Lets write the former introduction more detailed.</p>
<h2 id="theory-of-ordinary-kriging">THEORY OF ORDINARY KRIGING</h2>
<p>The aim of kriging is to estimate the value of a random variable,<span class="math inline">\(Z\)</span>, at one or more unsampled points or over larger blocks, from more or less sparse sample data on a given support, say <span class="math inline">\(z(\boldsymbol{x}_1),z(\boldsymbol{x}_2),...,z(\boldsymbol{x}_N)\)</span>, at points <span class="math inline">\(\boldsymbol{x}_1,\boldsymbol{x}_2,...,\boldsymbol{x}_N\)</span>. The data may be distributed in one, two or three dimensions, though applications in the environmental sciences are usually two-dimensional.</p>
<p>Ordinary kriging is by far the most common type of kriging in practice,and for this reason we focus on its theory here. It is based on the assumption that we do not know the mean. If we consider punctual estimation first, then we estimate <span class="math inline">\(Z\)</span> at a point <span class="math inline">\(\boldsymbol{x}_0\)</span>by <span class="math inline">\(\hat{Z}(\boldsymbol{x}_0)\)</span>, with the same support as the data, by <span class="math display">\[
\hat{Z}(\boldsymbol{x}_0)=\sum_{i=1}^{N}\lambda_i(\boldsymbol{x}_i),
\]</span> where <span class="math inline">\(\lambda_i\)</span> are the weights. To ensure that the estimate is unbiased the weights are made to sum to 1, <span class="math display">\[
\sum_{i=1}^{N}\lambda_i=1
\]</span></p>
<blockquote>
<p>Review about the unbiased, consistent, efficient estimator https://en.wikipedia.org/wiki/Consistent_estimator#Unbiased_but_not_consistent</p>
</blockquote>
<p>and the expected error is <span class="math inline">\(E[\hat{Z}(\boldsymbol{x}_0)-Z(\boldsymbol{x}_0)]=0\)</span>.</p>
<p>The estimation variance is <span class="math display">\[
var[\hat{Z}(\boldsymbol{x}_0)]=E[\{\hat{Z}(\boldsymbol{x}_0)-Z(\boldsymbol{x}_0)\}^2]\\
=2\sum_{i=1}^{N}\lambda_i\gamma(\boldsymbol{x}_i,\boldsymbol{x}_0)-\sum_{i=1}^{N}\sum_{i=1}^{N}\lambda_i\lambda_j\gamma(\boldsymbol{x}_i,\boldsymbol{x}_j)
\]</span> where <span class="math inline">\(\gamma(\boldsymbol{x}_i,\boldsymbol{x}_j)\)</span> is the semivariance of <span class="math inline">\(Z\)</span> between the data points<span class="math inline">\(\boldsymbol{x}_i\)</span> and <span class="math inline">\(\boldsymbol{x}_j\)</span>, and <span class="math inline">\(\gamma(\boldsymbol{x}_i,\boldsymbol{x}_0)\)</span> is the semivariance between the ith data point and the target point <span class="math inline">\(x_0\)</span>.</p>
<blockquote>
<p>Semi variance:http://www.kgs.ku.edu/Tis/surf3/s3krig2.html</p>
</blockquote>
<p>In the more general case we may wish to estimate <span class="math inline">\(Z\)</span> in a block <span class="math inline">\(B\)</span>, which may be a line, an area or a volume depending on whether it is in one, two or three spatial dimensions. The kriged estimate in <span class="math inline">\(B\)</span> is still a simple weighted average of the data, <span class="math display">\[
\hat{Z}(\boldsymbol{B})=\sum_{i=1}^{N}\lambda_iz(\boldsymbol{x}_i),
\]</span> but with <span class="math inline">\(x_0\)</span> of equation (3) replaced by <span class="math inline">\(B\)</span>. Its variance is <span class="math display">\[
var[\hat{Z}(\boldsymbol{B})]=E[\{\hat{Z}(\boldsymbol{B})-Z(\boldsymbol{B})\}^2]\\
=2\sum_{i=1}^{N}\lambda_i\gamma(\boldsymbol{x}_i,\boldsymbol{B})-\sum_{i=1}^{N}\sum_{i=1}^{N}\lambda_i\lambda_j\gamma(\boldsymbol{x}_i,\boldsymbol{x}_j)-\bar{\gamma}(B,B).
\]</span> The quantity <span class="math inline">\(\bar\gamma(\boldsymbol{x}_i,B)\)</span> is the average semivariance between the <span class="math inline">\(i\)</span>th sampling point and the block <span class="math inline">\(B\)</span> and is the integral <span class="math display">\[
$\bar\gamma(\boldsymbol{x}_i,B)$ =\frac{1}{B}\int_B\gamma(\boldsymbol{x}_i,\boldsymbol{x})d\boldsymbol{x},
\]</span> where <span class="math inline">\(\gamma(\boldsymbol{x}_i,\boldsymbol{x})\)</span> denotes the semivariance between the sampling point xi and a point x describing the block.</p>
<p><img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00021022160855202.png"></p>
<p>The third term on the right-hand side of equation (7) is the double integral <span class="math display">\[
\bar{\gamma}(B,B)=\frac{1}{|B^2|}\int_B\int_B\gamma(\boldsymbol{x},\boldsymbol{x^{\prime}})d\boldsymbol{x}d\boldsymbol{x^{\prime}}
\]</span> where <span class="math inline">\(\gamma(\boldsymbol{x},\boldsymbol{x^{\prime}})\)</span> is the semivariance between two points <span class="math inline">\(x\)</span> and <span class="math inline">\(x^{\prime}\)</span> that sweep independently over B. It is the within-block variance. In punctual kriging <span class="math inline">\(\bar{\gamma}(B,B)\)</span>becomes <span class="math inline">\(\bar{\gamma}(x_0,x_0)=0\)</span>, which is why equation (5) has two terms rather than three.</p>
<p>For each kriged estimate there is an associated kriging variance, which we can denote by <span class="math inline">\(\sigma^2(\boldsymbol{x}_0)\)</span> and <span class="math inline">\(\sigma^2(B)\)</span> for the point and block, respectively, and which are defined in equation(5) and equation(7).</p>
<p>The next step in kriging is to find the weights that minimize these variances, subject to the constraint that they sum to 1. We achieve this using the method of Lagrange multipliers.</p>
<p>Here I do not want to show how Lagrange multipliers works. Anyway this post is just a general introduction.</p>
<h2 id="weights">WEIGHTS</h2>
<p>When the kriging equations are solved to obtain the weights, <span class="math inline">\(\lambda_i\)</span>, in general the only large weights are those of the points near to the point or block to be kriged. The nearest four or five might contribute 80% of the total weight, and the next nearest ten almost all of the remainder. The weights also depend on the configuration of the sampling. We can summarize the factors affecting the weights as follows.</p>
<ol type="1">
<li>Near points carry more weight than more distant ones. Their relative proportions depend on the positions of the sampling points and on the variogram: the larger is the nugget variance, the smaller are the weights of the points that are nearest to target point or block.</li>
<li>The relative weights of points also depend on the block size: as the block size increases, the weights of the nearest points decrease and those of the more distant points increase , until the weights become nearly equal.</li>
<li>Clustered points carry less weight individually than isolated ones at the same distance</li>
<li>Data points can be screened by ones lying between them and the target</li>
</ol>
<p>These effects are all intuitively desirable, and the first shows that kriging is local. They will become evident in the examples below. They also have practical implications. The most important for present purposes is that because only the nearest few data points to the target carry significant weight, matrix A in the kriging system need never be large and its inversion will be swift.</p>
<h1 id="covariance-and-variogram">Covariance and Variogram</h1>
<p>Before we step into the next one, we need to clarify some basic definition.</p>
<p>This part also comes from the previous textbook.</p>
<h2 id="a-stochastic-approach-to-spatial-variation-the-theory-of-regionalized-variables">A STOCHASTIC APPROACH TO SPATIAL VARIATION: THE THEORY OF REGIONALIZED VARIABLES</h2>
<h3 id="random-variables">Random variables</h3>
<h1 id="poisson-kriging-area-to-area">Poisson Kriging-Area to Area</h1>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>周大侠
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://lifeodyssey.github.io/posts/f4af350.html" title="kriging">https://lifeodyssey.github.io/posts/f4af350.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Kriging-model/" rel="tag"># Kriging model</a>
              <a href="/tags/Spatial-staticstics/" rel="tag"># Spatial staticstics</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/3d8d27aa.html" rel="prev" title="Annotated Bibliography 2020 10.5-10.11">
      <i class="fa fa-chevron-left"></i> Annotated Bibliography 2020 10.5-10.11
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/39e89397.html" rel="next" title="np.ma.mask">
      np.ma.mask <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">周大侠</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">486k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">7:22</span>
</div>
  <div class="powered-by">Powered by <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      const script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>

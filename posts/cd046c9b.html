<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lifeodyssey.github.io","root":"/","scheme":"Mist","version":"8.0.0-rc.5","exturl":true,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="这将会是一个长篇。 长到我也不知道要多久才能把他写完 天下人苦matplotlib已久 立个flag，这个月（2020年12月）结束它。 主要包括以下几个图的画法  站位图 海洋环境要素分布图 散点图 密度散点图 Bar 带CI的Lineplot 其中第一个会用R，后面的因为我需要在处理数据的时候直接调用，所以是python。 不过第二个我也在考虑把结果输出到nc文件后，用R来画。 还有这个我就懒">
<meta property="og:type" content="article">
<meta property="og:title" content="Publishable plot using python&amp;R">
<meta property="og:url" content="https://lifeodyssey.github.io/posts/cd046c9b.html">
<meta property="og:site_name" content="乔克叔叔的床边故事">
<meta property="og:description" content="这将会是一个长篇。 长到我也不知道要多久才能把他写完 天下人苦matplotlib已久 立个flag，这个月（2020年12月）结束它。 主要包括以下几个图的画法  站位图 海洋环境要素分布图 散点图 密度散点图 Bar 带CI的Lineplot 其中第一个会用R，后面的因为我需要在处理数据的时候直接调用，所以是python。 不过第二个我也在考虑把结果输出到nc文件后，用R来画。 还有这个我就懒">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-01T10:45:26.000Z">
<meta property="article:modified_time" content="2020-12-16T13:24:50.799Z">
<meta property="article:author" content="周大侠">
<meta property="article:tag" content="Research">
<meta property="article:tag" content="python">
<meta property="article:tag" content="R">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://lifeodyssey.github.io/posts/cd046c9b.html">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Publishable plot using python&R | 乔克叔叔的床边故事</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135697820-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135697820-1');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="乔克叔叔的床边故事" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">乔克叔叔的床边故事</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="nav-number">1.</span> <span class="nav-text">散点图</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">周大侠</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lifeodyssey"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnpoZW5qaWF6aG91MDEyN0BnbWFpbC5jb20=" title="E-Mail → mailto:zhenjiazhou0127@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL1poZW5qaWFfWmhvdQ==" title="Researchgate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Zhenjia_Zhou"><i class="fa fa-researchgate fa-fw"></i>Researchgate</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luLyVFNiU4QyVBRiVFNCVCRCVCMy0lRTUlOTElQTgtODMyNmI0MTU1Lw==" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;%E6%8C%AF%E4%BD%B3-%E5%91%A8-8326b4155&#x2F;"><i class="fa fa-Linkedin fa-fw"></i>Linkedin</span>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lifeodyssey.github.io/posts/cd046c9b.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="周大侠">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乔克叔叔的床边故事">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Publishable plot using python&R
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-12-01 19:45:26" itemprop="dateCreated datePublished" datetime="2020-12-01T19:45:26+09:00">2020-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-12-16 22:24:50" itemprop="dateModified" datetime="2020-12-16T22:24:50+09:00">2020-12-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>5.9k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>5 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>这将会是一个长篇。</p>
<p>长到我也不知道要多久才能把他写完</p>
<p>天下人苦matplotlib已久</p>
<p>立个flag，这个月（2020年12月）结束它。</p>
<p>主要包括以下几个图的画法</p>
<ol type="1">
<li><p>站位图</p></li>
<li><p>海洋环境要素分布图</p></li>
<li><p>散点图</p></li>
<li><p>密度散点图</p></li>
<li><p>Bar</p></li>
<li><p>带CI的Lineplot</p>
<p>其中第一个会用R，后面的因为我需要在处理数据的时候直接调用，所以是python。</p>
<p>不过第二个我也在考虑把结果输出到nc文件后，用R来画。</p>
<p>还有这个我就懒得用中文了，因为主要是给自己用的代码备忘录。</p></li>
</ol>
<h1 id="散点图">散点图</h1>
<p>def wavelength_to_rgb(wavelength, gamma=0.8): ''' taken from http://www.noah.org/wiki/Wavelength_to_RGB_in_Python This converts a given wavelength of light to an approximate RGB color value. The wavelength must be given in nanometers in the range from 380 nm through 750 nm (789 THz through 400 THz).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wavelength_to_rgb</span>(<span class="params">wavelength, gamma=<span class="number">0.8</span></span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; taken from http://www.noah.org/wiki/Wavelength_to_RGB_in_Python</span></span><br><span class="line"><span class="string">    This converts a given wavelength of light to an</span></span><br><span class="line"><span class="string">    approximate RGB color value. The wavelength must be given</span></span><br><span class="line"><span class="string">    in nanometers in the range from 380 nm through 750 nm</span></span><br><span class="line"><span class="string">    (789 THz through 400 THz).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Based on code by Dan Bruton</span></span><br><span class="line"><span class="string">    http://www.physics.sfasu.edu/astro/color/spectra.html</span></span><br><span class="line"><span class="string">    Additionally alpha value set to 0.5 outside range</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    wavelength = float(wavelength)</span><br><span class="line">    <span class="keyword">if</span> wavelength &gt;= <span class="number">380</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">750</span>:</span><br><span class="line">        A = <span class="number">1.</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        A = <span class="number">0.5</span></span><br><span class="line">    <span class="keyword">if</span> wavelength &lt; <span class="number">380</span>:</span><br><span class="line">        wavelength = <span class="number">380.</span></span><br><span class="line">    <span class="keyword">if</span> wavelength &gt; <span class="number">750</span>:</span><br><span class="line">        wavelength = <span class="number">750.</span></span><br><span class="line">    <span class="keyword">if</span> wavelength &gt;= <span class="number">380</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">440</span>:</span><br><span class="line">        attenuation = <span class="number">0.3</span> + <span class="number">0.7</span> * (wavelength - <span class="number">380</span>) / (<span class="number">440</span> - <span class="number">380</span>)</span><br><span class="line">        R = ((-(wavelength - <span class="number">440</span>) / (<span class="number">440</span> - <span class="number">380</span>)) * attenuation) ** gamma</span><br><span class="line">        G = <span class="number">0.0</span></span><br><span class="line">        B = (<span class="number">1.0</span> * attenuation) ** gamma</span><br><span class="line">    <span class="keyword">elif</span> wavelength &gt;= <span class="number">440</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">490</span>:</span><br><span class="line">        R = <span class="number">0.0</span></span><br><span class="line">        G = ((wavelength - <span class="number">440</span>) / (<span class="number">490</span> - <span class="number">440</span>)) ** gamma</span><br><span class="line">        B = <span class="number">1.0</span></span><br><span class="line">    <span class="keyword">elif</span> wavelength &gt;= <span class="number">490</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">510</span>:</span><br><span class="line">        R = <span class="number">0.0</span></span><br><span class="line">        G = <span class="number">1.0</span></span><br><span class="line">        B = (-(wavelength - <span class="number">510</span>) / (<span class="number">510</span> - <span class="number">490</span>)) ** gamma</span><br><span class="line">    <span class="keyword">elif</span> wavelength &gt;= <span class="number">510</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">580</span>:</span><br><span class="line">        R = ((wavelength - <span class="number">510</span>) / (<span class="number">580</span> - <span class="number">510</span>)) ** gamma</span><br><span class="line">        G = <span class="number">1.0</span></span><br><span class="line">        B = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">elif</span> wavelength &gt;= <span class="number">580</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">645</span>:</span><br><span class="line">        R = <span class="number">1.0</span></span><br><span class="line">        G = (-(wavelength - <span class="number">645</span>) / (<span class="number">645</span> - <span class="number">580</span>)) ** gamma</span><br><span class="line">        B = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">elif</span> wavelength &gt;= <span class="number">645</span> <span class="keyword">and</span> wavelength &lt;= <span class="number">750</span>:</span><br><span class="line">        attenuation = <span class="number">0.3</span> + <span class="number">0.7</span> * (<span class="number">750</span> - wavelength) / (<span class="number">750</span> - <span class="number">645</span>)</span><br><span class="line">        R = (<span class="number">1.0</span> * attenuation) ** gamma</span><br><span class="line">        G = <span class="number">0.0</span></span><br><span class="line">        B = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        R = <span class="number">0.0</span></span><br><span class="line">        G = <span class="number">0.0</span></span><br><span class="line">        B = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">return</span> np.array([R, G, B, A]).reshape(<span class="number">1</span>, <span class="number">-1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">single_color_scatter</span>(<span class="params">ax1, x, y, xlable: str, ylable: str, xlim: list = None, title: str = None, ylim: list = None , color: str = <span class="string">&#x27;k&#x27;</span>, </span>):</span></span><br><span class="line">  <span class="comment">##import packages</span></span><br><span class="line">  <span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">  <span class="keyword">import</span> matplotlib.patches <span class="keyword">as</span> mpl_patches</span><br><span class="line">  <span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line">  <span class="comment"># from sklearn.metrics import mean_absolute_percentage_error</span></span><br><span class="line">  sns.set_style(<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">## do regression and get metrics</span></span><br><span class="line"></span><br><span class="line">  max_lim = np.max([np.max(x), np.max(y)])</span><br><span class="line">  min_lim = np.min([np.min(x), np.min(y)])</span><br><span class="line">  x_11 = np.linspace(min_lim, max_lim)</span><br><span class="line">  y_11 = x_11</span><br><span class="line">  N = len(x)</span><br><span class="line"></span><br><span class="line">  result = regress2(x.flatten(), y.flatten())</span><br><span class="line">  Slope = result[<span class="string">&#x27;slope&#x27;</span>]</span><br><span class="line">  Intercep = result[<span class="string">&#x27;intercept&#x27;</span>]</span><br><span class="line">  y_fit = Slope * x + Intercep</span><br><span class="line">  rmse = round(np.sqrt(mean_squared_error(x.flatten(), y.flatten())), <span class="number">5</span>)</span><br><span class="line">  r = round(result[<span class="string">&#x27;r&#x27;</span>], <span class="number">5</span>)</span><br><span class="line">  bias = (np.sum((y - x) / x)) / N</span><br><span class="line">  <span class="comment"># MAPE = round(mape(x.flatten(), y.flatten()), 5)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># start plot</span></span><br><span class="line">  line11, = ax1.plot(x_11, y_11, color=<span class="string">&#x27;k&#x27;</span>, linewidth=<span class="number">1.5</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, label=<span class="string">&#x27;1:1 line&#x27;</span>, zorder=<span class="number">5</span>)</span><br><span class="line">  linefit, = ax1.plot(x, y_fit, color=<span class="string">&#x27;r&#x27;</span>, linewidth=<span class="number">2</span>, linestyle=<span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;fitted line&#x27;</span>, zorder=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">  ax1.scatter(x, y, edgecolor=<span class="literal">None</span>, c=color, s=<span class="number">50</span>, marker=<span class="string">&#x27;s&#x27;</span>, facecolors=<span class="string">&quot;None&quot;</span>, zorder=<span class="number">3</span>)</span><br><span class="line">  fontdict1 = &#123;<span class="string">&quot;size&quot;</span>: <span class="number">30</span>,</span><br><span class="line">               <span class="string">&quot;color&quot;</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;family&#x27;</span>: <span class="string">&#x27;Time New Roman&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">  ax1.set_xlabel(xlable, fontdict=fontdict1)</span><br><span class="line">  ax1.set_ylabel(ylable, fontdict=fontdict1)</span><br><span class="line">  ax1.grid(<span class="literal">False</span>)</span><br><span class="line">  l0 = ax1.legend(handles=[line11, linefit], loc=<span class="string">&#x27;lower right&#x27;</span>, prop=&#123;<span class="string">&quot;size&quot;</span>: <span class="number">25</span>&#125;)</span><br><span class="line">  <span class="comment"># set tick font</span></span><br><span class="line">  labels = ax1.get_xticklabels() + ax1.get_yticklabels()</span><br><span class="line">  [label.set_fontname(<span class="string">&#x27;Time New Roman&#x27;</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">  <span class="keyword">for</span> spine <span class="keyword">in</span> [<span class="string">&#x27;top&#x27;</span>, <span class="string">&#x27;bottom&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;right&#x27;</span>]:</span><br><span class="line">      ax1.spines[spine].set_color(<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">  ax1.tick_params(left=<span class="literal">True</span>, bottom=<span class="literal">True</span>, direction=<span class="string">&#x27;in&#x27;</span>, labelsize=<span class="number">30</span>)</span><br><span class="line">  <span class="comment"># add title</span></span><br><span class="line">  titlefontdict = &#123;<span class="string">&quot;size&quot;</span>: <span class="number">40</span>,</span><br><span class="line">                   <span class="string">&quot;color&quot;</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">                   <span class="string">&#x27;family&#x27;</span>: <span class="string">&#x27;Time New Roman&#x27;</span>&#125;</span><br><span class="line">  ax1.set_title(title, titlefontdict, pad=<span class="number">20</span>)</span><br><span class="line">  <span class="comment"># ax.set_title()</span></span><br><span class="line">  h1fontdict = &#123;<span class="string">&quot;size&quot;</span>: <span class="number">25</span>, <span class="string">&#x27;weight&#x27;</span>: <span class="string">&#x27;bold&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">  handles = [mpl_patches.Rectangle((<span class="number">0</span>, <span class="number">0</span>), <span class="number">1</span>, <span class="number">1</span>, fc=<span class="string">&quot;white&quot;</span>, ec=<span class="string">&quot;white&quot;</span>,</span><br><span class="line">                                   lw=<span class="number">0</span>, alpha=<span class="number">0</span>)] * <span class="number">6</span></span><br><span class="line">  text = [<span class="string">r&#x27;$r:$&#x27;</span> + str(r),</span><br><span class="line">          <span class="string">r&#x27;$RMSE:$&#x27;</span> + str(rmse),</span><br><span class="line">          <span class="string">r&#x27;$Slope:$&#x27;</span> + str(round(Slope, <span class="number">3</span>)),</span><br><span class="line">          <span class="string">r&#x27;$Intercept:$&#x27;</span> + str(round(Intercep, <span class="number">3</span>)),</span><br><span class="line">          <span class="string">r&#x27;$Bias:$&#x27;</span> + str(round(<span class="number">100</span> * bias, <span class="number">3</span>)) + <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">          <span class="string">r&#x27;$N:$&#x27;</span> + str(N)]</span><br><span class="line">  <span class="comment"># text.append(r&#x27;$R^2=$&#x27;+str(round(r1,3)),fontdict=fontdict)</span></span><br><span class="line">  <span class="comment"># text.append(&quot;RMSE=&quot;+str(rmse),fontdict=fontdict)</span></span><br><span class="line">  <span class="comment"># text.append(r&#x27;$y=$&#x27;+str(round(A1,3))+&#x27;$x$&#x27;+&quot; + &quot;+str(round(B1,3)),fontdict=fontdict)</span></span><br><span class="line">  <span class="comment"># text.append(r&#x27;$N=$&#x27;+ str(N),fontdict=fontdict)</span></span><br><span class="line">  l1 = ax1.legend(handles, text, loc=<span class="string">&#x27;upper left&#x27;</span>, fancybox=<span class="literal">True</span>, framealpha=<span class="number">0</span>, prop=h1fontdict)</span><br><span class="line"></span><br><span class="line">  h2text_font = &#123;<span class="string">&#x27;size&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;weight&#x27;</span>: <span class="string">&#x27;medium&#x27;</span>&#125;</span><br><span class="line">  label_font = &#123;<span class="string">&#x27;size&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;weight&#x27;</span>: <span class="string">&#x27;medium&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">  orderhand = [mpl_patches.Rectangle((<span class="number">0</span>, <span class="number">0</span>), <span class="number">1</span>, <span class="number">1</span>, fc=<span class="string">&quot;white&quot;</span>, ec=<span class="string">&quot;white&quot;</span>,</span><br><span class="line">                                     lw=<span class="number">0</span>, alpha=<span class="number">0</span>)]</span><br><span class="line">  <span class="comment">#     text2 = [order]</span></span><br><span class="line">  <span class="comment">#     l2 = ax1.legend(orderhand, text2, loc=&#x27;upper right&#x27;, fancybox=True, framealpha=0,prop=h2text_font)</span></span><br><span class="line">  <span class="comment"># ax.text(.7,.25,s=&#x27;Within EE = &#x27; + &#x27;&#123;:.0%&#125;&#x27;.format(bottom_top_counts/all_data),transform = ax.transAxes,</span></span><br><span class="line">  <span class="comment">#         ha=&#x27;left&#x27;, va=&#x27;center&#x27;,fontdict=text_font)</span></span><br><span class="line">  <span class="comment"># ax.text(.7,.18,s=&#x27;Above EE = &#x27; + &#x27;&#123;:.0%&#125;&#x27;.format(top_counts/all_data),transform = ax.transAxes,</span></span><br><span class="line">  <span class="comment">#         ha=&#x27;left&#x27;, va=&#x27;center&#x27;,fontdict=text_font)</span></span><br><span class="line">  <span class="comment"># ax.text(.7,.11,s=&#x27;Below EE = &#x27; + &#x27;&#123;:.0%&#125;&#x27;.format(bottom_counts/all_data),transform = ax.transAxes,</span></span><br><span class="line">  <span class="comment">#         ha=&#x27;left&#x27;, va=&#x27;center&#x27;,fontdict=text_font)</span></span><br><span class="line">  ax1.add_artist(l1)</span><br><span class="line">  <span class="comment">#     ax1.add_artist(l2)</span></span><br><span class="line">  ax1.add_artist(l0)</span><br><span class="line">  <span class="keyword">if</span> xlim <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">      ax1.set_xlim(xlim)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">      ax1.set_xlim(min_lim, max_lim)</span><br><span class="line">  <span class="keyword">if</span> ylim <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">      ax1.set_ylim(ylim)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">      ax1.set_ylim(min_lim, max_lim)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>周大侠
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://lifeodyssey.github.io/posts/cd046c9b.html" title="Publishable plot using python&amp;R">https://lifeodyssey.github.io/posts/cd046c9b.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Research/" rel="tag"># Research</a>
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/R/" rel="tag"># R</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/adc0cb59.html" rel="prev" title="Annotated Bibliography 2020 11.30-12.6">
      <i class="fa fa-chevron-left"></i> Annotated Bibliography 2020 11.30-12.6
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/e45539ea.html" rel="next" title="Correlation metrics">
      Correlation metrics <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">周大侠</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">751k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">11:23</span>
</div>
  <div class="powered-by">Powered by <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      const script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>

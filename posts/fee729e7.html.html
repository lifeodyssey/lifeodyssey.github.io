<!DOCTYPE html><html class="font-sans scroll-smooth" lang=zh-CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/favicon.svg rel=icon type=image/svg+xml><title>PyTorch基础 | 乔克叔叔的床边故事</title><meta content="没想到我也有开始炼丹的一天 主要的参考资料是这个 numpy中的基础单位是ndarray，PyTorch里面的基础单位是tensor，tensor可以在gpu里进行计算 基本操作都一样，比如ones_like,zeros,size，索引方式..." name=description><meta content=周大侠 name=author><meta content="Astro v5.13.7" name=generator><meta content="oklch(96% 0.005 298)" name=theme-color><link href=/fonts/EarlySummer-VF-Split/EarlySummer-VF-Subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Black-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Bold-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-Italic-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=https://lifeodyssey.github.io/posts/fee729e7.html.html rel=canonical><link href=/sitemap-index.xml rel=sitemap><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=https://lifeodyssey.github.io rel=alternate hreflang=zh><link href=https://lifeodyssey.github.io/en/ rel=alternate hreflang=en><link href=https://lifeodyssey.github.io/ja/ rel=alternate hreflang=ja><meta content=article property=og:type><meta content=https://lifeodyssey.github.io/posts/fee729e7.html.html property=og:url><meta content="PyTorch基础 | 乔克叔叔的床边故事" property=og:title><meta content="没想到我也有开始炼丹的一天 主要的参考资料是这个 numpy中的基础单位是ndarray，PyTorch里面的基础单位是tensor，tensor可以在gpu里进行计算 基本操作都一样，比如ones_like,zeros,size，索引方式..." property=og:description><meta content=https://lifeodyssey.github.io/og/fee729e7.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.1k2cUud7.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!!e&&"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",t?"oklch(22% 0.005 298)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t)}document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),e(),t()}()</script><link href=/_astro/_about_.Dzb1Me_E.css rel=stylesheet><link href=/_astro/_posts_slug_.CM85RmC-.css rel=stylesheet><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const tp={preserveBehavior:!1},ep=t=>{if("string"==typeof t)return[t,tp];const[e,n=tp]=t;return[e,{...tp,...n}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,e,r,o,i,a,s,c,d,p,l=t,u){function f(){u||(u=1,"/"==(s=(a.lib||"/~partytown/")+(a.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),o!=t?o.dispatchEvent(new CustomEvent("pt1",{detail:t})):(c=setTimeout(w,(null==a?void 0:a.fallbackTimeout)||1e4),e.addEventListener("pt0",h),i?y(1):r.serviceWorker?r.serviceWorker.register(s+(a.swPath||"partytown-sw.js"),{scope:s}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):w())))}function y(n){p=e.createElement(n?"script":"iframe"),t._pttab=Date.now(),n||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=s+"partytown-"+(n?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),e.querySelector(a.sandboxParent||"body").appendChild(p)}function w(n,r){for(h(),o==t&&(a.forward||[]).map((function(e){const[n]=ep(e);delete t[n.split(".")[0]]})),n=0;n<d.length;n++)(r=e.createElement("script")).innerHTML=d[n].innerHTML,r.nonce=a.nonce,e.head.appendChild(r);p&&p.parentNode.removeChild(p)}function h(){clearTimeout(c)}a=t.partytown||{},o==t&&(a.forward||[]).map((function(e){const[r,{preserveBehavior:o}]=ep(e);l=t,r.split(".").map((function(e,r,i){var a;l=l[i[r]]=r+1<i.length?l[i[r]]||(a=i[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(o){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,i);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(i,arguments),n}})()}))})),"complete"==e.readyState?f():(t.addEventListener("DOMContentLoaded",f),t.addEventListener("load",f))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-fee729e7-zh}@layer astro{::view-transition-old(post-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-fee729e7-zh}@layer astro{::view-transition-old(time-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-fee729e7-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-wif6pdce-3]{view-transition-name:site-title-zh}@layer astro{::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><body><div class="w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><header class="cjk:tracking-0.02em lg:uno-desktop-column lg:top-20 mb-10.8"><h2 class="c-secondary font-bold font-title lg:c-primary lg:mb-1.8 lg:mt-0 lg:text-9 mb-2.8 mt-3 text-5.375"><div class="inline-block box-content pr-1" data-astro-transition-scope=astro-wif6pdce-3 data-disable-theme-transition><a href=/ id=site-title-link>乔克叔叔的床边故事</a></div></h2></header><nav aria-label="Site Navigation" class="hidden cjk:tracking-0.02em font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,12.5rem)] lg:text-4 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">文章</a></li><li><a href=/tags/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">标签</a></li><li><a href=/about/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">关于</a></li><li><a href=/search/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Search</a></li></ul></nav><main class=mb-10><article class=heti><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function e(t){if(!(t.target instanceof Element?t.target:null)?.closest("#back-button"))return;if(window.history.length>1)return void window.history.back();const e=document.getElementById("site-title-link");e&&e.click()}document.addEventListener("click",e,{passive:!0})</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>PyTorch基础</span></h1></div><div class="c-primary block font-time mb-17.2" data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition id=post-date><time datetime=2021-12-31>2021-12-31 </time><span class=ml-1.75>14 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="w-full h-12 relative" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>目录</span><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24" class="ml-4 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center aspect-square hidden w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#张量 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>张量</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#张量的一些特殊操作 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>张量的一些特殊操作</a></li><li class=ml-8 data-astro-cid-v5otsao3><a href=#note class="highlight-hover no-heti toc-links-h4" data-astro-cid-v5otsao3>Note</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#与numpy的转换 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>与numpy的转换</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#自动求导 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>自动求导</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#神经网络包优化器 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>神经网络包&amp;优化器</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#定义一个网络 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>定义一个网络</a></li><li class=ml-8 data-astro-cid-v5otsao3><a href=#前向传播后向传播神经网络 class="highlight-hover no-heti toc-links-h4" data-astro-cid-v5otsao3>前向传播，后向传播，神经网络</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#损失函数 class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>损失函数</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#损失函数-1 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>损失函数</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#优化器 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>优化器</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#优化器-1 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>优化器</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#fine-tuning class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Fine tuning</a></li></ul></nav></div></div><script type=module>let s=null,i=null;function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",c=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&c.set(e,t)}));let r=null;function l(t){t!==r&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),r=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}s=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=c.get(e);t&&l(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]}),Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>s?.observe(t)));const a=document.getElementById("post-copyright");a&&(i=new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),r=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}),i?.observe(a),n.length>0&&l(n[0]))}function m(){s?.disconnect(),i?.disconnect(),s=null,i=null}document.addEventListener("astro:after-swap",g),document.addEventListener("astro:before-swap",m),g()</script><div id=post-content><p>没想到我也有开始炼丹的一天</p><p>主要的参考资料是<a href=https://github.com/zergtant/pytorch-handbook rel="nofollow noopener noreferrer external" target=_blank>这个</a></p><h1 id=pytorch基础>PyTorch基础<a href=#pytorch基础 class=heading-anchor-link aria-label="Link to PyTorch基础"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><h2 id=张量>张量<a href=#张量 class=heading-anchor-link aria-label="Link to 张量"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>numpy中的基础单位是ndarray，PyTorch里面的基础单位是tensor，tensor可以在gpu里进行计算</p><p>基本操作都一样，比如ones_like,zeros,size，索引方式也一样</p><p>基本的数据类型有五种</p><ul><li>32位浮点型：torch.FloatTensor。 (默认)</li><li>64位整型：torch.LongTensor。</li><li>32位整型：torch.IntTensor。</li><li>16位整型：torch.ShortTensor。</li><li>64位浮点型：torch.DoubleTensor。</li></ul><p>除以上数字类型外，还有 byte和chart型</p><h3 id=张量的一些特殊操作>张量的一些特殊操作<a href=#张量的一些特殊操作 class=heading-anchor-link aria-label="Link to 张量的一些特殊操作"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>加法1:</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>y </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.rand(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> y)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([[ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7808</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4388</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3151</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.0076</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.0716</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8465</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8175</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3625</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2005</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2435</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8512</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7142</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4737</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8545</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2.4833</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]])</span></span></code></pre></div><p>加法2</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(torch.add(x, y))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([[ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7808</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4388</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3151</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.0076</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.0716</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8465</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8175</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3625</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2005</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2435</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8512</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7142</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4737</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8545</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2.4833</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]])</span></span></code></pre></div><p>提供输出tensor作为参数</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>result </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.empty(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.add(x, y, </span><span style=color:#e36209;--shiki-dark:#FFAB70>out</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>result)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(result)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([[ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7808</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4388</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3151</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.0076</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.0716</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8465</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8175</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3625</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2005</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2435</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8512</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7142</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4737</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8545</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2.4833</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]])</span></span></code></pre></div><p>替换</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># adds x to y</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>y.add_(x)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(y)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([[ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7808</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4388</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3151</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.0076</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.0716</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8465</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8175</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3625</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2005</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2435</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8512</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7142</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1.4737</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.8545</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2.4833</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]])</span></span></code></pre></div><h4 id=note>Note<a href=#note class=heading-anchor-link aria-label="Link to Note"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h4><p>任何 以<code>_</code> 结尾的操作都会用结果替换原变量. 例如: <code>x.copy_(y)</code>, <code>x.t_()</code>, 都会改变 <code>x</code>.</p><p>改变维度</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.randn(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>y </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x.view(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>16</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>z </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x.view(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)  </span><span style=color:#6a737d;--shiki-dark:#6A737D>#  size -1 从其他维度推断</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x.size(), y.size(), z.size())</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>16</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>8</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span></code></pre></div><p>如果你有只有一个元素的张量，使用<code>.item()</code>来得到Python数据类型的数值</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.randn(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x.item())</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2368</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.2368014901876</span><span style=color:#24292e;--shiki-dark:#E1E4E8> b4496</span></span></code></pre></div><h3 id=与numpy的转换>与numpy的转换<a href=#与numpy的转换 class=heading-anchor-link aria-label="Link to 与numpy的转换"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>Torch Tensor与NumPy数组共享底层内存地址，修改一个会导致另一个的变化。</p><p>将一个Torch Tensor转换为NumPy数组</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>a </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.ones(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(a)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.])</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>b </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> a.numpy()</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(b)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>. 1. 1. 1. 1.]</span></span></code></pre></div><p>观察numpy数组的值是如何改变的。</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>a.add_(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(a)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(b)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>. 2. 2. 2. 2.]</span></span></code></pre></div><p>NumPy Array 转化成 Torch Tensor</p><p>使用from_numpy自动转化</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> numpy </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>a </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.ones(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>b </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.from_numpy(a)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>np.add(a, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#e36209;--shiki-dark:#FFAB70>out</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>a)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(a)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(b)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>. 2. 2. 2. 2.]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.], </span><span style=color:#e36209;--shiki-dark:#FFAB70>dtype</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.float64)</span></span></code></pre></div><p>所有的 Tensor 类型默认都是基于CPU， CharTensor 类型不支持到 NumPy 的转换.</p><p>使用<code>.to</code> 方法 可以将Tensor移动到任何设备中</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># is_available 函数判断是否有cuda可以使用</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># ``torch.device``将张量移动到指定的设备中</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.cuda.is_available():</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    device </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.device(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"cuda"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)          </span><span style=color:#6a737d;--shiki-dark:#6A737D># a CUDA 设备对象</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    y </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.ones_like(x, </span><span style=color:#e36209;--shiki-dark:#FFAB70>device</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>device)  </span><span style=color:#6a737d;--shiki-dark:#6A737D># 直接从GPU创建张量</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x.to(device)                       </span><span style=color:#6a737d;--shiki-dark:#6A737D># 或者直接使用``.to("cuda")``将张量移动到cuda中</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    z </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> y</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(z)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(z.to(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"cpu"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, torch.double))       </span><span style=color:#6a737d;--shiki-dark:#6A737D># ``.to`` 也会对变量的类型做更改</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7632</span><span style=color:#24292e;--shiki-dark:#E1E4E8>], </span><span style=color:#e36209;--shiki-dark:#FFAB70>device</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'cuda:0'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tensor([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7632</span><span style=color:#24292e;--shiki-dark:#E1E4E8>], </span><span style=color:#e36209;--shiki-dark:#FFAB70>dtype</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.float64)</span></span></code></pre></div><h2 id=自动求导>自动求导<a href=#自动求导 class=heading-anchor-link aria-label="Link to 自动求导"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>没太看懂这里是用来干嘛的</p><h2 id=神经网络包优化器>神经网络包&#x26;优化器<a href=#神经网络包优化器 class=heading-anchor-link aria-label="Link to 神经网络包&#x26;优化器"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>torch.nn是专门为神经网络设计的模块化接口。nn构建于 Autograd之上，可用来定义和运行神经网络。 这里我们主要介绍几个一些常用的类</p><p><strong>约定：torch.nn 我们为了方便使用，会为他设置别名为nn，本章除nn以外还有其他的命名约定</strong></p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 首先要引入相关的包</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 引入torch.nn并指定别名</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.nn </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#打印一下版本</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__version__</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>'1.0.0'</span></span></code></pre></div><p>除了nn别名以外，我们还引用了nn.functional，这个包中包含了神经网络中使用的一些常用函数，这些函数的特点是，不具有可学习的参数(如ReLU，pool，DropOut等)，这些函数可以放在构造函数中，也可以不放，但是这里建议不放。</p><p>一般情况下我们会<strong>将nn.functional 设置为大写的F</strong>，这样缩写方便调用</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.nn.functional </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> F</span></span></code></pre></div><h3 id=定义一个网络>定义一个网络<a href=#定义一个网络 class=heading-anchor-link aria-label="Link to 定义一个网络"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>PyTorch中已经为我们准备好了现成的网络模型，只要继承nn.Module，并实现它的forward方法，PyTorch会根据autograd，自动实现backward函数，在forward函数中可使用任何tensor支持的函数，还可以使用if、for循环、print、log等Python语法，写法和标准的Python写法一致。</p><p>In [3]:</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Net</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>nn</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.</span><span style=color:#6f42c1;--shiki-dark:#B392F0>Module</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    def</span><span style=color:#005cc5;--shiki-dark:#79B8FF> __init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self):</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        # nn.Module子类的函数必须在构造函数中执行父类的构造函数</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        super</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(Net, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>).</span><span style=color:#005cc5;--shiki-dark:#79B8FF>__init__</span><span style=color:#24292e;--shiki-dark:#E1E4E8>()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        # 卷积层 '1'表示输入图片为单通道， '6'表示输出通道数，'3'表示卷积核为3*3</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.conv1 </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.Conv2d(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        #线性层，输入1350个特征，输出10个特征</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.fc1   </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.Linear(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1350</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)  </span><span style=color:#6a737d;--shiki-dark:#6A737D>#这里的1350是如何计算的呢？这就要看后面的forward函数</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #正向传播 </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> forward</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, x): </span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x.size()) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 结果：[1, 1, 32, 32]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        # 卷积 -> 激活 -> 池化 </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.conv1(x) </span><span style=color:#6a737d;--shiki-dark:#6A737D>#根据卷积的尺寸计算公式，计算结果是30，具体计算公式后面第二章第四节 卷积神经网络 有详细介绍。</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> F.relu(x)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x.size()) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 结果：[1, 6, 30, 30]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> F.max_pool2d(x, (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)) </span><span style=color:#6a737d;--shiki-dark:#6A737D>#我们使用池化层，计算结果是15</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> F.relu(x)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x.size()) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 结果：[1, 6, 15, 15]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        # reshape，‘-1’表示自适应</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>        #这里做的就是压扁的操作 就是把后面的[1, 6, 15, 15]压扁，变为 [1, 1350]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x.view(x.size()[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>], </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(x.size()) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 这里就是fc1层的的输入1350 </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.fc1(x)        </span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> x</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>net </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Net()</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(net)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Net(</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  (</span><span style=color:#6f42c1;--shiki-dark:#B392F0>conv1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span><span style=color:#005cc5;--shiki-dark:#79B8FF>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> Conv2d</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 6,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> kernel_size=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>3,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span><span style=color:#032f62;--shiki-dark:#9ECBFF>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> stride=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>1,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  (</span><span style=color:#6f42c1;--shiki-dark:#B392F0>fc1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span><span style=color:#005cc5;--shiki-dark:#79B8FF>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> Linear</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(in_features</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>1350,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> out_features</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>10,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> bias</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><p>网络的可学习参数通过net.parameters()返回</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> parameters </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#24292e;--shiki-dark:#E1E4E8> net.parameters():</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(parameters)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Parameter</span><span style=color:#032f62;--shiki-dark:#9ECBFF> containing:</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>tensor([[[[</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 0.2745,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.2594,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.0171],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.0429,  0.3013, -0.0208]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.1459, -0.3223,  0.1797]]],</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [[[ 0.1847,  0.0227, -0.1919],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [-0.0210, -0.1336, -0.2176],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [-0.2164, -0.1244, -0.2428]]]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [[[ 0.1042, -0.0055, -0.2171],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.3306, -0.2808,  0.2058],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.2492,  0.2971,  0.2277]]]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [[[ 0.2134, -0.0644, -0.3044],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.0040,  0.0828, -0.2093],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.0204,  0.1065,  0.1168]]]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [[[ 0.1651, -0.2244,  0.3072],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [-0.2301,  0.2443, -0.2340],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.0685,  0.1026,  0.1754]]]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [[[ 0.1691, -0.0790,  0.2617],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.1956,  0.1477,  0.0877],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          [ 0.0538, -0.3091,  0.2030]]]], requires_grad</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Parameter</span><span style=color:#032f62;--shiki-dark:#9ECBFF> containing:</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>tensor([</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 0.2355,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.2949,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.1283,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.0848,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.2027,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.3331</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>       requires_grad</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Parameter</span><span style=color:#032f62;--shiki-dark:#9ECBFF> containing:</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>tensor([[</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 2.0555e-02,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -2.1445e-02,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -1.7981e-02,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  ...,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -2.3864e-02,</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>          8.5149e-03,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -6.2071e-04</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [-1.1755e-02,  1.0010e-02,  2.1978e-02,  ...,  1.8433e-02,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          7.1362e-03, -4.0951e-03]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [ 1.6187e-02,  2.1623e-02,  1.1840e-02,  ...,  5.7059e-03,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>         -2.7165e-02,  1.3463e-03]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>        ...</span><span style=color:#032f62;--shiki-dark:#9ECBFF>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [-3.2552e-03,  1.7277e-02, -1.4907e-02,  ...,  7.4232e-03,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>         -2.7188e-02, -4.6431e-03]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [-1.9786e-02, -3.7382e-03,  1.2259e-02,  ...,  3.2471e-03,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>         -1.2375e-02, -1.6372e-02]</span><span style=color:#6f42c1;--shiki-dark:#B392F0>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [-8.2350e-03,  4.1301e-03, -1.9192e-03,  ..., -2.3119e-05,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          2.0167e-03,  1.9528e-02]], requires_grad</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>Parameter</span><span style=color:#032f62;--shiki-dark:#9ECBFF> containing:</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>tensor([</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 0.0162,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.0146,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.0218,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.0212,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.0119,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.0142,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> -0.0079,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.0171,</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>         0.0205,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>  0.0164],</span><span style=color:#032f62;--shiki-dark:#9ECBFF> requires_grad=True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><p>net.named_parameters可同时返回可学习的参数及名称。</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> name,parameters </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#24292e;--shiki-dark:#E1E4E8> net.named_parameters():</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>    print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(name,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>':'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,parameters.size())</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>conv1.weight</span><span style=color:#032f62;--shiki-dark:#9ECBFF> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> torch.Size</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([6, 1, 3, 3])</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>conv1.bias</span><span style=color:#032f62;--shiki-dark:#9ECBFF> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> torch.Size</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([6])</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>fc1.weight</span><span style=color:#032f62;--shiki-dark:#9ECBFF> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> torch.Size</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([10, 1350])</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>fc1.bias</span><span style=color:#032f62;--shiki-dark:#9ECBFF> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> torch.Size</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([10])</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>input</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.randn(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 这里的对应前面fforward的输入是32</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>out </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> net(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>input</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>out.size()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>30</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>30</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>6</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>15</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>15</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>torch.Size([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1350</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>torch.Size([1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 10]</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>input.size</span><span style=color:#24292e;--shiki-dark:#E1E4E8>()</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>torch.Size([1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 32,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 32]</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><p>在反向传播前，先要将所有参数的梯度清零</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>net.zero_grad() </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>out.backward(torch.ones(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 反向传播的实现是PyTorch自动实现的，我们只要调用这个函数即可</span></span></code></pre></div><p><strong>注意</strong></p><div></div>.nn只支持mini-batches，不支持一次只输入一个样本，即一次必须是一个batch。<p></p><p>也就是说，就算我们输入一个样本，也会对样本进行分批，所以，所有的输入都会增加一个维度，我们对比下刚才的input，nn中定义为3维，但是我们人工创建时多增加了一个维度，变为了4维，最前面的1即为batch-size</p><p>我感觉我需要去补一下coursera，而不是在这里看代码</p><h4 id=前向传播后向传播神经网络>前向传播，后向传播，神经网络<a href=#前向传播后向传播神经网络 class=heading-anchor-link aria-label="Link to 前向传播，后向传播，神经网络"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h4><p>翻出来了<a href=https://www.techbrood.com/zh/news/ai/%E7%94%A8%E4%BA%BA%E8%AF%9D%E8%A7%A3%E9%87%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E9%87%8C%E9%9D%A2%E7%9A%84%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%E5%92%8C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD.html rel="nofollow noopener noreferrer external" target=_blank>这个</a></p><figure><img alt=1.png src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/202112311621806.png><figcaption>1.png</figcaption></figure><p>这是一个没有隐藏层的神经网络，左侧输入，右侧输出，前向就是从输入到输出，反向就是从后面获取的Loss传到前面的那个输出层里（比如logistic）</p><figure><img alt=1552807616619421 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/202112311632948.png><figcaption>1552807616619421</figcaption></figure><p>这是一个带有隐藏层的神经网络，像之前没有隐藏层的时候，我们改一个东西的参数就可以了，现在我们还要改小女孩的参数，所以要用链式求导梯度下降。</p><p>这些中间层和output就是传说中的<a href=https://zh.wikipedia.org/wiki/%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0 rel="nofollow noopener noreferrer external" target=_blank>激活函数</a>，如果不用激活函数，每一层输出都是上一层输入的线性函数，没法拟合非线性函数。</p><p>输入数据乘以权重（weight）加上一个偏置（bias），然后应用激活函数得到该神经元的输出，再将此输出传给下一层的神经元。这些weight和bias，再加上L1 L2 batch size之类的 就是超参数。</p><h3 id=损失函数>损失函数<a href=#损失函数 class=heading-anchor-link aria-label="Link to 损失函数"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><h2 id=损失函数-1>损失函数<a href=#损失函数-1 class=heading-anchor-link aria-label="Link to 损失函数"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>在nn中PyTorch还预制了常用的损失函数，下面我们用MSELoss用来计算均方误差</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>y </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.arange(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>).view(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>).float()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>criterion </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.MSELoss()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>loss </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> criterion(out, y)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#loss是个scalar，我们可以直接用item获取到他的python类型的数值</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(loss.item()) </span></span></code></pre></div><p>28.92203712463379</p><h2 id=优化器>优化器<a href=#优化器 class=heading-anchor-link aria-label="Link to 优化器"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><h2 id=优化器-1>优化器<a href=#优化器-1 class=heading-anchor-link aria-label="Link to 优化器"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>在反向传播计算完所有参数的梯度后，还需要使用优化方法来更新网络的权重和参数，例如随机梯度下降法(SGD)的更新策略如下：</p><p>weight = weight - learning_rate * gradient</p><p>在torch.optim中实现大多数的优化方法，例如RMSProp、Adam、SGD等，下面我们使用SGD做个简单的样例</p><p>In [10]:</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.optim</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>out </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> net(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>input</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#6a737d;--shiki-dark:#6A737D># 这里调用的时候会打印出我们在forword函数中打印的x的大小</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>criterion </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> nn.MSELoss()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>loss </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> criterion(out, y)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#新建一个优化器，SGD只需要要调整的参数和学习率</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>optimizer </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> torch.optim.SGD(net.parameters(), </span><span style=color:#e36209;--shiki-dark:#FFAB70>lr</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0.01</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 先梯度清零(与net.zero_grad()效果一样)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>optimizer.zero_grad() </span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>loss.backward()</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#更新参数</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>optimizer.step()</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=bash style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>torch.Size([1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 32,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 32]</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>torch.Size([1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 6,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 30,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 30]</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>torch.Size([1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 6,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 15,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 15]</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>torch.Size([1,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 1350]</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><p>这样，神经网络的数据的一个完整的传播就已经通过PyTorch实现了。</p><p>后面就没有再细看了</p><h2 id=fine-tuning>Fine tuning<a href=#fine-tuning class=heading-anchor-link aria-label="Link to Fine tuning"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>这个目前恰好切中自己的需求。</p><p>针对于某个任务，自己的训练数据不多，那怎么办？ 没关系，我们先找到一个同类的别人训练好的模型，把别人现成的训练好了的模型拿过来，换成自己的数据，调整一下参数，再训练一遍，这就是微调（fine-tune）。 PyTorch里面提供的经典的网络模型都是官方通过Imagenet的数据集与训练好的数据，如果我们的数据训练数据不够，这些数据是可以作为基础模型来使用的。</p><ol><li>新数据集和原始数据集合类似，那么直接可以微调一个最后的FC层或者重新指定一个新的分类器</li><li>新数据集比较小和原始数据集合差异性比较大，那么可以使用从模型的中部开始训练，只对最后几层进行fine-tuning</li><li>新数据集比较小和原始数据集合差异性比较大，如果上面方法还是不行的化那么最好是重新训练，只将预训练的模型作为一个新模型初始化的数据</li><li>新数据集的大小一定要与原始数据集相同，比如CNN中输入的图片大小一定要相同，才不会报错</li><li>如果数据集大小不同的话，可以在最后的fc层之前添加卷积或者pool层，使得最后的输出与fc层一致，但这样会导致准确度大幅下降，所以不建议这样做</li><li>对于不同的层可以设置不同的学习率，一般情况下建议，对于使用的原始数据做初始化的层设置的学习率要小于（一般可设置小于10倍）初始化的学习率，这样保证对于已经初始化的数据不会扭曲的过快，而使用初始化学习率的新层可以快速的收敛。</li></ol><p>更具体的可以看<a href=https://github.com/zergtant/pytorch-handbook/blob/master/chapter4/4.1-fine-tuning.ipynb rel="nofollow noopener noreferrer external" target=_blank>这里</a></p><p>还有一些<a href=https://github.com/zergtant/pytorch-handbook/blob/master/chapter4/4.2.2-tensorboardx.ipynb rel="nofollow noopener noreferrer external" target=_blank>可视化</a>的内容，后面用到了再补充</p><div id=post-copyright></div><div class="mt-12.6 uno-decorative-line"></div><div class="no-heti flex flex-wrap gap-x-3 gap-y-3.2"><a href=/tags/机器学习/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">机器学习 </span><span class="inline-block font-medium opacity-0" aria-hidden=true>机器学习 </span></a><a href=/tags/Inversion/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Inversion </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Inversion </span></a><a href="/tags/Deep Learning/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Deep Learning </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Deep Learning </span></a><a href=/tags/PyTorch/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">PyTorch </span><span class="inline-block font-medium opacity-0" aria-hidden=true>PyTorch</span></a></div></div></article></main><footer class="leading-1.25em font-navbar lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=/atom.xml/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>RSS</a>&nbsp;/ <a href=https://github.com/lifeodyssey class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:email@radishzz.cc class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;</p><p>© 2025-2026 周大侠</p><p>Powered by <a href=https://astro.build/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><div class="flex absolute gap-6 lg:bottom-[min(10.27rem+1.92vw,12rem)] lg:fixed lg:right-[max(5rem,calc(50vw-35rem))] lg:top-auto lg:w-14rem min-[823px]:max-lg:right-[calc(50vw-22rem)] right-7.25vw top-14.6"><a href=/posts/fee729e7.html.html/ class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" aria-label="Switch website language" id=language-switcher><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M19.18 21.1 12.4 1.89h-1.21L4.52 21.1l-2.53.2v.81h6.37v-.81l-2.83-.2 2.02-5.97h7.58l2.02 5.97-3.34.2v.81H22v-.81l-2.83-.2zM7.85 14.33l3.44-10.21 3.54 10.21z"/></svg> </a><button aria-label="Switch light/dark theme" class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" id=theme-toggle-button><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M12.06.61C5.66.61.46 5.71.46 12.11s5.1 11.5 11.6 11.5 11.5-5.1 11.5-11.5S18.46.61 12.06.61m0 21c-6.07 0-10.94-4.2-10.94-9.5s4.87-9.4 10.94-9.4S23 6.91 23 12.21s-4.88 9.4-10.94 9.4"/></svg></button></div><script>!function(){const e="oklch(96% 0.005 298)",t="oklch(22% 0.005 298)";function n(n){document.documentElement.classList.toggle("dark",n);const o=document.head.querySelector('meta[name="theme-color"]');o&&e&&t&&o.setAttribute("content",n?t:e),localStorage.setItem("theme",n?"dark":"light"),document.dispatchEvent(new Event("theme-changed"))}function o(){n(!document.documentElement.classList.contains("dark"))}document.addEventListener("click",(function(e){const t=e.target instanceof Element?e.target:null,n=t?.closest("#theme-toggle-button");if(!n)return;if(document.documentElement.classList.contains("reduce-motion"))return void o();document.documentElement.style.setProperty("view-transition-name","animation-theme-toggle"),document.documentElement.setAttribute("data-theme-changing",""),document.startViewTransition(o).finished.then((()=>{document.documentElement.style.removeProperty("view-transition-name"),document.documentElement.removeAttribute("data-theme-changing")}))}),{passive:!0}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{n(e.matches)}))}()</script><script type=module>const o={click:"tap",typing:"type"},l={[o.click]:.8,[o.typing]:.4},d=["#language-switcher","#theme-toggle-button"],f=[".el-input__inner",".el-textarea__inner","#wl-nick","#wl-mail","#wl-link","#wl-edit"],h=new Set(["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"]),p=d.join(","),g=f.join(",");function r(){return window.matchMedia("(max-width: 1023px)").matches}function w(){return document.head.querySelector('link[rel="sitemap"]')?.getAttribute("href")?.replace("/sitemap-index.xml","")||""}class y{audioContext=null;audioBuffers={[o.click]:[],[o.typing]:[]};initPromise=null;async fetchAndCacheSound(t,e){if(!this.audioContext)throw new Error("Audio context not initialized");const n=`${t}_0${e+1}`,i=await(await fetch(`${w()}/sounds/${n}.wav`)).arrayBuffer(),a=await this.audioContext.decodeAudioData(i);this.audioBuffers[t].push(a)}async preloadAllSounds(){const t=Object.values(o).flatMap((t=>Array.from({length:5},((e,n)=>this.fetchAndCacheSound(t,n)))));await Promise.allSettled(t)}async initialize(){return this.initPromise??=(async()=>{const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,await this.preloadAllSounds()})()}async playSound(t){try{if(await this.initialize(),!this.audioContext)return;"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=this.audioBuffers[t];if(0===e.length)return;const n=this.audioContext.createBufferSource();n.buffer=e[Math.floor(Math.random()*e.length)];const i=this.audioContext.createGain();i.gain.value=l[t],n.connect(i).connect(this.audioContext.destination),n.start(0)}catch(t){console.warn("Sound playback failed:",t)}}}const c=new y;function m(t){r()||!t.target?.closest(p)||c.playSound(o.click)}function x(t){r()||t.ctrlKey||t.altKey||t.metaKey||h.has(t.key)||!t.target?.closest(g)||c.playSound(o.typing)}document.addEventListener("click",m,{passive:!0}),document.addEventListener("keydown",x,{passive:!0})</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},o=new WeakMap;function r(){const e=document.querySelectorAll(".code-copy-button");0!==e.length&&e.forEach((e=>{e.innerHTML=s.copy}))}async function a(e){if(e.classList.contains("copy-success"))return;const t=e.parentElement?.querySelector("pre code"),n=t?.textContent??"";if(t&&n)try{await navigator.clipboard.writeText(n);const t=o.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const c=setTimeout((()=>{e.isConnected&&(e.innerHTML=s.copy,e.classList.remove("copy-success"),o.delete(e))}),1500);o.set(e,c)}catch(e){console.error("Failed to copy code",e)}}function l(e){const t=e.target instanceof Element&&e.target.closest(".code-copy-button");t&&a(t)}document.addEventListener("astro:page-load",r),document.addEventListener("click",l,{passive:!0}),r()</script><script type=module>async function p(t){const e=t.dataset.repo;if(!e)return;const o=t.getElementsByClassName("gc-owner-avatar")[0],n=t.getElementsByClassName("gc-repo-description")[0],s=t.getElementsByClassName("gc-stars-count")[0],a=t.getElementsByClassName("gc-forks-count")[0],r=t.getElementsByClassName("gc-license-info")[0];function c(t){const e=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1});o&&t.owner?.avatar_url&&(o.style.backgroundImage=`url(${t.owner.avatar_url})`),n&&(n.textContent=t.description??"No description"),s&&(s.textContent=e.format(t.stargazers_count??0)),a&&(a.textContent=e.format(t.forks_count??0)),r&&(r.textContent=t.license?.spdx_id??"No License")}const i=`github-repo-${e}`,m=sessionStorage.getItem(i);if(m){c(JSON.parse(m))}else try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok){if(n){const e=404===t.status?"Repository not found":"Failed to load repository data";n.textContent=e}return}const o=await t.json();sessionStorage.setItem(i,JSON.stringify(o)),c(o)}catch(t){console.error(`Failed to fetch ${e}:`,t)}}function f(){const t=document.getElementsByClassName("gc-container");0!==t.length&&Array.from(t).forEach((t=>{p(t)}))}document.addEventListener("astro:page-load",f),f()</script><script type=module src=/_astro/MediaEmbed.astro_astro_type_script_index_0_lang.wKrCMCCr.js></script><script type=module>const n={overlay:document.querySelector(".zoom-overlay"),zoomedImg:null,originalImg:null,createOverlay(){this.overlay&&this.overlay.isConnected||(this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-label","Image Viewer"),this.overlay.setAttribute("tabindex","-1"),Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",backgroundColor:"oklch(var(--un-preset-theme-colors-background) / 0.95)",opacity:"0",transition:"opacity 300ms cubic-bezier(0.4, 0, 0.2, 1)",cursor:"zoom-out",display:"none"}),document.body.appendChild(this.overlay))},zoomImg(e){if(!this.overlay)return;document.body.style.overflow="hidden";const t=e.getBoundingClientRect();this.originalImg=e,this.zoomedImg=e.cloneNode(),Object.assign(this.zoomedImg.style,{position:"fixed",top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",zIndex:"1000",cursor:"zoom-out"}),document.body.appendChild(this.zoomedImg),this.overlay.style.display="block",this.overlay.focus();const o=window.innerWidth,i=window.innerHeight,s=window.innerWidth<768?1:.8,l=Math.min(o*s/t.width,i*s/t.height),a=(-t.left+(o-t.width)/2)/l,n=(-t.top+(i-t.height)/2)/l;requestAnimationFrame((()=>{this.overlay&&(this.overlay.style.opacity="1"),this.zoomedImg&&(this.zoomedImg.style.transform=`scale(${l}) translate3d(${a}px, ${n}px, 0)`)}))},close(){!this.overlay||!this.zoomedImg||!this.originalImg||(this.zoomedImg.style.transform="",this.overlay.style.opacity="0",document.body.style.overflow="",setTimeout((()=>{this.zoomedImg&&this.zoomedImg.parentNode&&document.body.removeChild(this.zoomedImg),this.zoomedImg=null,this.overlay&&(this.overlay.style.display="none"),this.originalImg&&this.originalImg.focus(),this.originalImg=null}),300))},setupOverlay(){this.createOverlay(),this.zoomedImg=null,this.originalImg=null},handleClick(e){if(this.zoomedImg)return void this.close();const t=e.target;t instanceof HTMLImageElement&&t.complete&&t.naturalWidth>=100&&t.naturalHeight>=100&&this.zoomImg(t)},handleResize(){this.zoomedImg&&this.close()},init(){this.createOverlay(),document.addEventListener("astro:page-load",(()=>this.setupOverlay())),document.addEventListener("click",(e=>this.handleClick(e)),{passive:!0}),window.addEventListener("resize",(()=>this.handleResize()),{passive:!0})}};n.init()</script></body></html>
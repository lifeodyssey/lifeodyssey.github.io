<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lifeodyssey.github.io","root":"/","scheme":"Mist","version":"8.0.0-rc.5","exturl":true,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="A hybrid algorithm for estimating the chlorophyll-a concentration across different trophic states in Asian inland waters Optical water type discrimination and tuning remote sensing band-ratio algorit">
<meta property="og:type" content="article">
<meta property="og:title" content="Water Classification for Inversion&#x2F;Retrieval">
<meta property="og:url" content="https://lifeodyssey.github.io/posts/696b3f33.html">
<meta property="og:site_name" content="乔克叔叔的床边故事">
<meta property="og:description" content="A hybrid algorithm for estimating the chlorophyll-a concentration across different trophic states in Asian inland waters Optical water type discrimination and tuning remote sensing band-ratio algorit">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115135501466.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115140950759.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115141023265.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115182324282.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115201801830.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115202628690.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115202825460.png">
<meta property="og:image" content="https://ars.els-cdn.com/content/image/1-s2.0-S0303243417303148-gr2_lrg.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402161611706.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402162450657.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402162603375.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402164934583.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172203229.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172450000.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172636127.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172912120.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173332530.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173357960.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173419427.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173740967.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173903360.png">
<meta property="article:published_time" content="2021-01-15T03:38:36.000Z">
<meta property="article:modified_time" content="2021-04-05T10:07:47.000Z">
<meta property="article:author" content="周大侠">
<meta property="article:tag" content="Ocean Color">
<meta property="article:tag" content="Inherent Optical Properties">
<meta property="article:tag" content="Ocean Optics">
<meta property="article:tag" content="Research Basis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115135501466.png">

<link rel="canonical" href="https://lifeodyssey.github.io/posts/696b3f33.html">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Water Classification for Inversion/Retrieval | 乔克叔叔的床边故事</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135697820-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135697820-1');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="乔克叔叔的床边故事" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">乔克叔叔的床边故事</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#a-system-to-measure-the-data-quality-of-spectral-remote-sensing-reflectance-of-aquatic-environments"><span class="nav-number">1.</span> <span class="nav-text">A system to measure the data quality of spectral remote-sensing reflectance of aquatic environments</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#water-classification"><span class="nav-number">1.1.</span> <span class="nav-text">Water Classification</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#quantitatively-measurement"><span class="nav-number">1.2.</span> <span class="nav-text">Quantitatively measurement</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#result"><span class="nav-number">1.3.</span> <span class="nav-text">Result</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#code"><span class="nav-number">1.4.</span> <span class="nav-text">Code</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#annotation"><span class="nav-number">1.5.</span> <span class="nav-text">Annotation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#a-hybrid-algorithm-for-estimating-the-chlorophyll-a-concentration-across-different-trophic-states-in-asian-inland-waters"><span class="nav-number">2.</span> <span class="nav-text">A hybrid algorithm for estimating the chlorophyll-a concentration across different trophic states in Asian inland waters</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#optical-water-type-discrimination-and-tuning-remote-sensing-band-ratio-algorithms-application-to-retrieval-of-chlorophyll-and-kd490-in-the-irish-and-celtic-seas"><span class="nav-number">3.</span> <span class="nav-text">Optical water type discrimination and tuning remote sensing band-ratio algorithms: Application to retrieval of chlorophyll and Kd(490) in the Irish and Celtic Seas</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#influence-of-a-red-band-based-water-classification-approach-on-chlorophyll-algorithms-for-optically-complex-estuarie"><span class="nav-number">4.</span> <span class="nav-text">Influence of a red band-based water classification approach on chlorophyll algorithms for optically complex estuarie</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#a-soft-classification-based-chlorophyll-a-estimation-method-using-meris-data-in-the-highly-turbid-and-eutrophic-taihu-lake"><span class="nav-number">5.</span> <span class="nav-text">A soft-classification-based chlorophyll-a estimation method using MERIS data in the highly turbid and eutrophic Taihu Lake</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#an-improved-optical-classification-scheme-for-the-ocean-colour-essential-climate-variable-and-its-applications"><span class="nav-number">6.</span> <span class="nav-text">An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#optical-types-of-inland-and-coastal-waters"><span class="nav-number">7.</span> <span class="nav-text">Optical types of inland and coastal waters</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#a-global-approach-for-chlorophyll-a-retrieval-across-optically-complex-inland-waters-based-on-optical-water-type"><span class="nav-number">7.1.</span> <span class="nav-text">A global approach for chlorophyll-a retrieval across optically complex inland waters based on optical water type</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#remote-estimation-of-chlorophyll-a-concentrations-over-a-wide-range-of-optical-conditions-based-on-water-classification-from-viirs-observations"><span class="nav-number">8.</span> <span class="nav-text">Remote estimation of chlorophyll a concentrations over a wide range of optical conditions based on water classification from VIIRS observations</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#remotely-estimating-total-suspended-solids-concentration-in-clear-to-extremely-turbid-waters-using-a-novel-semi-analytical-method"><span class="nav-number">9.</span> <span class="nav-text">Remotely estimating total suspended solids concentration in clear to extremely turbid waters using a novel semi-analytical method</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">周大侠</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">121</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">76</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lifeodyssey"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnpoZW5qaWF6aG91MDEyN0BnbWFpbC5jb20=" title="E-Mail → mailto:zhenjiazhou0127@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL1poZW5qaWFfWmhvdQ==" title="Researchgate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Zhenjia_Zhou"><i class="fa fa-researchgate fa-fw"></i>Researchgate</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luLyVFNiU4QyVBRiVFNCVCRCVCMy0lRTUlOTElQTgtODMyNmI0MTU1Lw==" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;%E6%8C%AF%E4%BD%B3-%E5%91%A8-8326b4155&#x2F;"><i class="fa fa-Linkedin fa-fw"></i>Linkedin</span>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lifeodyssey.github.io/posts/696b3f33.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="周大侠">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乔克叔叔的床边故事">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Water Classification for Inversion/Retrieval
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-15 11:38:36" itemprop="dateCreated datePublished" datetime="2021-01-15T11:38:36+08:00">2021-01-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-05 18:07:47" itemprop="dateModified" datetime="2021-04-05T18:07:47+08:00">2021-04-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Annotated-Bibliography/" itemprop="url" rel="index"><span itemprop="name">Annotated Bibliography</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>20 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>A hybrid algorithm for estimating the chlorophyll-<em>a</em> concentration across different trophic states in Asian inland waters</p>
<p>Optical water type discrimination and tuning remote sensing band-ratio algorithms: application to retrieval of chlorophyll and kd (490) in the Irish and Celtic seas</p>
<p>Influence of a red band-based water classification approach on chlorophyll algorithms for optically complex estuaries</p>
<p>A soft-classification-based chlorophyll-a estimation method using MERIS data in the highly turbid and eutrophic Taihu Lake</p>
<p>A system to measure the data quality of spectral remote-sensing reflectance of aquatic environments</p>
<p>An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications</p>
<a id="more"></a>
<h1 id="a-system-to-measure-the-data-quality-of-spectral-remote-sensing-reflectance-of-aquatic-environments">A system to measure the data quality of spectral remote-sensing reflectance of aquatic environments</h1>
<h2 id="water-classification">Water Classification</h2>
<p>The reference Rrs spectra were first normalized by their respective root of sum of squares (RSS), <span class="math display">\[
nR_{rs}(\lambda)=\frac{R_{rs}}{[\sum^N_{i=1}R_{rs}(\lambda_i)^2]^{1/2}}
\]</span> where the index N represents the total number of wavelengths, varying from 1 to 9 and <span class="math inline">\(\lambda_i\)</span> corresponds to the wavelengths of 412, 443, 488, 510, 531, 547, 555, 667, and 678 nm. The nRrs spectra vary over the range between 0 and 1, while it retains the ‘‘shapes’’ pertaining to the original Rrs spectra, i.e., the band ratios of nRrs(<span class="math inline">\(\lambda_i\)</span>) remain the same as Rrs(<span class="math inline">\(\lambda_i\)</span>).</p>
<p>The number of data clusters k was evaluated using the gap method [Tibshirani et al., 2001]. The gap value is defined as: <span class="math display">\[
GAP_n(k)=E_n^*[log(W_k)]-log(W_k)
\]</span> where n is the sample size, k is the number of clusters being evaluated, and Wk is the pooled within-cluster dispersion measurement, with <span class="math display">\[
W_k=\sum_{r=1}^k\frac{1}{2n_r}D_r
\]</span> where nr is the number of data points in cluster r, and <span class="math inline">\(D_r\)</span> is the sum of the pair-wise distances for all points in cluster r.</p>
<p>The expected value <span class="math inline">\(E_n^*[log(W_k)]\)</span> is determined by Monte Carlo sampling from a reference distri- bution, and $log(Wk) is computed from the sample data. According to the gap method, the optimum cluster number of the nRrs data is determined as 23. Interestingly, this number is nearly the same as that of Forel- Ule water type classes developed 100 years ago [Arnone et al., 2004].</p>
<p>The unsupervised method, K-means clustering technique, was further used to group the nRrs spectra.</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115135501466.png" alt="image-00030115135501466"><figcaption aria-hidden="true">image-00030115135501466</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115140950759.png" alt="image-00030115140950759"><figcaption aria-hidden="true">image-00030115140950759</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115141023265.png" alt="image-00030115141023265"><figcaption aria-hidden="true">image-00030115141023265</figcaption>
</figure>
<p>This is a very detailed classification.</p>
<p>But what i want to do is just"Case1, Case2, and Case2 into slightly turbid, moderet turbid and highly turbid"</p>
<p>Anyway, I'm gonna to read it over as I also need it to do the verification/validation.</p>
<h2 id="quantitatively-measurement">Quantitatively measurement</h2>
<ol type="1">
<li><p>match up <span class="math inline">\(R_{rs}^*(\lambda^{&#39;})\)</span> with <span class="math inline">\(nR_{rs}(\lambda)\)</span> with regard to the wavelengths. If <span class="math inline">\(R^*_{rs}\)</span> has more spectral bands than that of <span class="math inline">\(nR_{rs}(\lambda)\)</span>, we will only choose the same wavelengths with <span class="math inline">\(nR_{rs}(\lambda)\)</span> for further analysis. If <span class="math inline">\(R^*_{rs}\)</span> has fewer wavelengths than the <span class="math inline">\(nR_{rs}(\lambda)\)</span> spectra (i.e., <span class="math inline">\(N(\lambda^{&#39;})&lt;9\)</span>), a subset of <span class="math inline">\(nR_{rs}(\lambda^{&#39;})\)</span> and associated upper boundary spectra <span class="math inline">\(nR_{rs}^U(\lambda^{&#39;})\)</span> and lower boundary spectra <span class="math inline">\(nR_{rs}^L(\lambda^{&#39;})\)</span> will be extrated first for <span class="math inline">\(\lambda^{&#39;}\)</span>.</p></li>
<li><p>the normalization of <span class="math inline">\(R_{rs}^*\)</span> spectra following equation (1). For the case of <span class="math inline">\(N(\lambda^{&#39;})&lt;9\)</span>, the new <span class="math inline">\(nR_{rs}(\lambda^{&#39;})\)</span> specta will be rescaled through the normalization procedure of eq(1) so that the RSS of <span class="math inline">\(nR_{rs}(\lambda^{&#39;})\)</span> is equal to 1 (<strong>?</strong>). Further, the new upper and lower boundary spectra <span class="math inline">\(nR_{rs}^{U}(\lambda^{&#39;})\)</span> and <span class="math inline">\(nR_{rs}^{L}(\lambda^{&#39;})\)</span> will also be rescaled by the newly rescaled <span class="math inline">\(nR_{rs}(\lambda^{&#39;})\)</span> spectra as below <span class="math display">\[
nR_{rs}^{U}(\lambda)=\frac{nR_{rs}^{U}(\lambda)}{[\sum_{i=1}^NnR_{rs}(\lambda_i)^2]^{1/2}}
\]</span></p>
<p><span class="math display">\[
nR_{rs}^{L}(\lambda)=\frac{nR_{rs}^{L}(\lambda)}{[\sum_{i=1}^NnR_{rs}(\lambda_i)^2]^{1/2}}
\]</span></p></li>
<li><p>assign a water type to the target spectrum by comparing it with the reference nRrs spectra. The spectra similarity between the target spectrum <span class="math inline">\(nR_{rs}^*\)</span> and refference spectra nRrs are estimated using a spectral angle mapper(SAM)[Kruse et al., 1993], <span class="math display">\[
cos\ \alpha=\frac{\sum_{i=1}^{N}[nR_{rs}^**nR_{rs}]}{\sqrt{\sum_{i=1}^{N}[nR_{rs}^{*}(\lambda_i)]^2\sum_{i=1}^{N}[nR_{rs}(\lambda_i)]^2}}
\]</span> Where <span class="math inline">\(\alpha\)</span> is the angle formed between the refference spectrum nRrs and the normalized target spectrum <span class="math inline">\(nR_{rs}^*\)</span>. As a spectral classifier, SAM is able to determine the spectral similarity by treating them as vertors in a space with dimensionality equal to the number of bands, N. The water type of the target spectrum <span class="math inline">\(nR_{rs}^*\)</span> is identified as one with the largest cosine values (equivalent to the smllest angles).</p></li>
<li><p>the computation of QA scores by comparing the target spectrum <span class="math inline">\(nRrs\)</span> with the upper and lower boundaries (<span class="math inline">\(nRrs^U\)</span> and <span class="math inline">\(nRrs^L\)</span>) of the corresponding water type. The number of wavelengths where <span class="math inline">\(nR_{rs}^*\)</span> falling within the boundaries is counted, and used to derive the total score (<span class="math inline">\(C_{tot}\)</span>) for the <span class="math inline">\(nR_{rs}\)</span> spectrum, <span class="math display">\[
C_{tot}=\frac{C(\lambda_1)+C(\lambda_2)+\ldots+C(\lambda_N)}{N}
\]</span></p></li>
</ol>
<p>Where <span class="math inline">\(C_{i}\)</span> is the wavelength-specific score with N the total number of wavelengths for both <span class="math inline">\(R_{rs}^*\)</span> and <span class="math inline">\(R_{rs}^{ref}\)</span>. At wavelength <span class="math inline">\(\lambda_i\)</span> , for example, if <span class="math inline">\(R_{rs}^*(\lambda_i)\)</span> is found beyond either the upper or lower boundary of nRrs, a score of 0 will be assigned to this wavelength; otherwise score=1. As suggested by equation (7), the total score <span class="math inline">\(C_{tot}\)</span> will vary within the range of [0, 1]. A higher score indicates higher data quality.</p>
<p>To account for the measurement uncertainty and possible data-processing errors and likely insufficient data coverage, the original upper boundary and lower boundary are slightly modified by <span class="math inline">\(\pm0.5%\)</span>,<span class="math inline">\(nRrs^U=nRrs^U\times(1+0.005)\ and\ nRrs^L=nRrs^L\times(1-0.005)\)</span>, respectively. Note that this added range of 0.5% is one order of magnitude smaller than the projected accuracy for radiance measurement [Hooker et al., 1992].</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115182324282.png" alt="image-00030115182324282"><figcaption aria-hidden="true">image-00030115182324282</figcaption>
</figure>
<h2 id="result">Result</h2>
<p>Because all field measurements are discrete, it is likely that the database used here does not cover every water types and/or there are situations where the range of Rrs variability goes beyond the domains defined here. Such a limitation can be updated or revised when more high-quality in situ measurements are avail- able. A MATLABVR script is made available (http://oceanoptics.umb.edu/score_metric/) to facilitate the evaluation and refinement of the score metrics. Nevertheless, this QA scheme provides an easily applicable system to quantitatively evaluate the quality of individual Rrs spectra.</p>
<h2 id="code">Code</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[maxCos, cos, clusterID, totScore]</span> = <span class="title">QAscores_matrix</span><span class="params">(test_Rrs, test_lambda)</span></span></span><br><span class="line"><span class="comment">% Quality assurance system for Rrs spectra (version 1)</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% Author: Jianwei Wei, University of Massachusetts Boston</span></span><br><span class="line"><span class="comment">% Email: Jianwei.Wei@umb.edu</span></span><br><span class="line"><span class="comment">% Nov-01-2016</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% ------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">% KNOWN VARIABLES :   ref_nRrs   -- Normalized Rrs spectra per-determined from water clustering (23x9 matrix)  </span></span><br><span class="line"><span class="comment">%                     ref_lambda -- Wavelengths for ref_nRrs (1x9 matrix)</span></span><br><span class="line"><span class="comment">%                     upB        -- Upper boundary (23x9 matrix)</span></span><br><span class="line"><span class="comment">%                     lowB       -- Lower boundary (23x9 matrix)</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% INPUTS:            test_Rrs   -- Rrs spectra for testing (units: sr^-1);</span></span><br><span class="line"><span class="comment">%                                  a row vector</span></span><br><span class="line"><span class="comment">%                    test_lambda-- Wavelengths for test_Rrs</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% OUTPUTS:  maxCos     -- maximum cosine values</span></span><br><span class="line"><span class="comment">%           cos        -- cosine values for every ref_nRrs spectra</span></span><br><span class="line"><span class="comment">%           clusterID  -- idenfification of water types (from 1-23)</span></span><br><span class="line"><span class="comment">%           totScore   -- total score assigned to test_Rrs</span></span><br><span class="line"><span class="comment">% ------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">% </span></span><br><span class="line"><span class="comment">% <span class="doctag">NOTE:</span></span></span><br><span class="line"><span class="comment">%         1) Nine wavelengths (412, 443, 488, 510, 531, 547, 555, 667, 678nm) are assumed in the model</span></span><br><span class="line"><span class="comment">%         2) If your Rrs data were measured at other wavelength, e.g. 440nm, you may want to change 440 to 443 before the model run;</span></span><br><span class="line"><span class="comment">%             or modify the code below to find a cloest wavelength from the nine bands.</span></span><br><span class="line"><span class="comment">%         3) The latest version may be found online at HTTP://oceanoptics.umb.edu/score_metric</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% Reference:</span></span><br><span class="line"><span class="comment">%         Wei, Jianwei; Lee, Zhongping; Shang, Shaoling (2016). A system</span></span><br><span class="line"><span class="comment">%         to measure the data quality of spectral remote sensing</span></span><br><span class="line"><span class="comment">%         reflectance of aquatic environments. Journal of Geophysical Research, </span></span><br><span class="line"><span class="comment">%         121, doi:10.1002/2016JC012126</span></span><br><span class="line"><span class="comment">%         </span></span><br><span class="line"><span class="comment">% ------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">% Apr. 5 2017, Keping Du</span></span><br><span class="line"><span class="comment">%     1) Vectorize code</span></span><br><span class="line"><span class="comment">%     2) totScore takes account of NaN bands</span></span><br><span class="line"><span class="comment">%     3) add input data check</span></span><br><span class="line"><span class="comment">% Apr. 11, 2017</span></span><br><span class="line"><span class="comment">%     4) compatible with previous matlab version (tested on v2014a)</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% INPUTS:            </span></span><br><span class="line"><span class="comment">%           test_Rrs -- matrix (inRow*inCol), each row represents one Rrs spectrum</span></span><br><span class="line"><span class="comment">% OUTPUTS:  </span></span><br><span class="line"><span class="comment">%           maxCos,clusterID,totScore -- row vector (1*inRow)</span></span><br><span class="line"><span class="comment">%           cos -- matrix (refRow[23]*inRow) </span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% Note:</span></span><br><span class="line"><span class="comment">%     1) nanmean, nansum need statistics toolbox</span></span><br><span class="line"><span class="comment">%     2) on less memory and multi-core system, it may further speedup using</span></span><br><span class="line"><span class="comment">%        parfor</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% ------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">%% check input data</span></span><br><span class="line">[row_lam, len] = <span class="built_in">size</span>(test_lambda);</span><br><span class="line"><span class="keyword">if</span>( row_lam ~= <span class="number">1</span> )</span><br><span class="line">    test_lambda = test_lambda&#x27;;</span><br><span class="line">    [row_lam, len] = <span class="built_in">size</span>(test_lambda);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">[row, col] = <span class="built_in">size</span>(test_Rrs);</span><br><span class="line"><span class="keyword">if</span>( len~=col &amp;&amp; len~=row)</span><br><span class="line">    error(<span class="string">&#x27;Rrs and lambda size mismatch, please check the input data!&#x27;</span>);</span><br><span class="line"><span class="keyword">elseif</span>( len == row )</span><br><span class="line">    test_Rrs = test_Rrs&#x27;;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% </span></span><br><span class="line">ref_lambda = [... </span><br><span class="line"><span class="number">4.1200000e+02</span>   <span class="number">4.4300000e+02</span>   <span class="number">4.8800000e+02</span>   <span class="number">5.1000000e+02</span>   <span class="number">5.3100000e+02</span>   <span class="number">5.4700000e+02</span>   <span class="number">5.5500000e+02</span>   <span class="number">6.6700000e+02</span>   <span class="number">6.7800000e+02</span>];</span><br><span class="line"></span><br><span class="line">ref_nRrs = [...</span><br><span class="line"><span class="number">7.3796683e-01</span>   <span class="number">5.3537883e-01</span>   <span class="number">3.3492125e-01</span>   <span class="number">1.6941114e-01</span>   <span class="number">1.1182662e-01</span>   <span class="number">8.4361643e-02</span>   <span class="number">7.2175090e-02</span>   <span class="number">7.2722859e-03</span>   <span class="number">7.0353728e-03</span></span><br><span class="line"><span class="number">6.7701882e-01</span>   <span class="number">5.3387929e-01</span>   <span class="number">3.9394438e-01</span>   <span class="number">2.2455653e-01</span>   <span class="number">1.5599408e-01</span>   <span class="number">1.2008708e-01</span>   <span class="number">1.0354070e-01</span>   <span class="number">1.0933735e-02</span>   <span class="number">1.0455480e-02</span></span><br><span class="line"><span class="number">6.0833086e-01</span>   <span class="number">5.2121439e-01</span>   <span class="number">4.3584243e-01</span>   <span class="number">2.7962783e-01</span>   <span class="number">2.0377847e-01</span>   <span class="number">1.6110758e-01</span>   <span class="number">1.4032775e-01</span>   <span class="number">1.6391579e-02</span>   <span class="number">1.6652716e-02</span></span><br><span class="line"><span class="number">5.0963646e-01</span>   <span class="number">4.7791625e-01</span>   <span class="number">4.6164394e-01</span>   <span class="number">3.4802439e-01</span>   <span class="number">2.7862610e-01</span>   <span class="number">2.3009577e-01</span>   <span class="number">2.0608914e-01</span>   <span class="number">2.8730802e-02</span>   <span class="number">3.1444642e-02</span></span><br><span class="line"><span class="number">4.2964691e-01</span>   <span class="number">4.3556598e-01</span>   <span class="number">4.7152369e-01</span>   <span class="number">3.8584748e-01</span>   <span class="number">3.2599050e-01</span>   <span class="number">2.7815421e-01</span>   <span class="number">2.5272485e-01</span>   <span class="number">3.7857754e-02</span>   <span class="number">4.0848963e-02</span></span><br><span class="line"><span class="number">3.6333623e-01</span>   <span class="number">3.8706313e-01</span>   <span class="number">4.5815748e-01</span>   <span class="number">4.0800274e-01</span>   <span class="number">3.6779296e-01</span>   <span class="number">3.2800639e-01</span>   <span class="number">3.0440341e-01</span>   <span class="number">4.2053379e-02</span>   <span class="number">4.6881488e-02</span></span><br><span class="line"><span class="number">3.0946099e-01</span>   <span class="number">3.5491575e-01</span>   <span class="number">4.5120901e-01</span>   <span class="number">4.1874143e-01</span>   <span class="number">3.9159654e-01</span>   <span class="number">3.5624518e-01</span>   <span class="number">3.3479154e-01</span>   <span class="number">4.7772121e-02</span>   <span class="number">5.2270007e-02</span></span><br><span class="line"><span class="number">2.7592997e-01</span>   <span class="number">3.1479809e-01</span>   <span class="number">4.1544764e-01</span>   <span class="number">4.1498609e-01</span>   <span class="number">4.1372468e-01</span>   <span class="number">3.9362850e-01</span>   <span class="number">3.7826076e-01</span>   <span class="number">6.1949978e-02</span>   <span class="number">6.7485875e-02</span></span><br><span class="line"><span class="number">3.4894221e-01</span>   <span class="number">3.3506487e-01</span>   <span class="number">3.9141989e-01</span>   <span class="number">3.8562158e-01</span>   <span class="number">3.8741043e-01</span>   <span class="number">3.8162021e-01</span>   <span class="number">3.7750529e-01</span>   <span class="number">9.0297871e-02</span>   <span class="number">1.1765683e-01</span></span><br><span class="line"><span class="number">2.2772731e-01</span>   <span class="number">2.7529725e-01</span>   <span class="number">3.8286839e-01</span>   <span class="number">4.0702216e-01</span>   <span class="number">4.2986184e-01</span>   <span class="number">4.2741518e-01</span>   <span class="number">4.2034636e-01</span>   <span class="number">7.8973961e-02</span>   <span class="number">8.2281945e-02</span></span><br><span class="line"><span class="number">2.9144133e-01</span>   <span class="number">2.7609677e-01</span>   <span class="number">3.4217459e-01</span>   <span class="number">3.6720207e-01</span>   <span class="number">4.0137560e-01</span>   <span class="number">4.2429030e-01</span>   <span class="number">4.3706779e-01</span>   <span class="number">1.2861174e-01</span>   <span class="number">1.8141021e-01</span></span><br><span class="line"><span class="number">1.8746813e-01</span>   <span class="number">2.4076435e-01</span>   <span class="number">3.4198541e-01</span>   <span class="number">3.8187091e-01</span>   <span class="number">4.2690383e-01</span>   <span class="number">4.5020436e-01</span>   <span class="number">4.6108232e-01</span>   <span class="number">1.4677497e-01</span>   <span class="number">1.5051459e-01</span></span><br><span class="line"><span class="number">1.7255536e-01</span>   <span class="number">2.2029128e-01</span>   <span class="number">3.4230960e-01</span>   <span class="number">3.9321173e-01</span>   <span class="number">4.4659383e-01</span>   <span class="number">4.6240583e-01</span>   <span class="number">4.6390040e-01</span>   <span class="number">9.2807580e-02</span>   <span class="number">9.5738816e-02</span></span><br><span class="line"><span class="number">1.8841854e-01</span>   <span class="number">2.3450346e-01</span>   <span class="number">3.1896860e-01</span>   <span class="number">3.6310347e-01</span>   <span class="number">4.1160987e-01</span>   <span class="number">4.4466363e-01</span>   <span class="number">4.6280653e-01</span>   <span class="number">2.1459148e-01</span>   <span class="number">2.1401522e-01</span></span><br><span class="line"><span class="number">1.4302269e-01</span>   <span class="number">1.9142029e-01</span>   <span class="number">3.0575515e-01</span>   <span class="number">3.6501150e-01</span>   <span class="number">4.3375853e-01</span>   <span class="number">4.7213469e-01</span>   <span class="number">4.9178025e-01</span>   <span class="number">1.6955637e-01</span>   <span class="number">1.7983785e-01</span></span><br><span class="line"><span class="number">1.8122161e-01</span>   <span class="number">2.0034662e-01</span>   <span class="number">2.6123587e-01</span>   <span class="number">3.0652476e-01</span>   <span class="number">3.6505277e-01</span>   <span class="number">4.1049611e-01</span>   <span class="number">4.3692672e-01</span>   <span class="number">3.5885777e-01</span>   <span class="number">3.7375096e-01</span></span><br><span class="line"><span class="number">1.7376760e-01</span>   <span class="number">2.0335076e-01</span>   <span class="number">2.8260384e-01</span>   <span class="number">3.3433902e-01</span>   <span class="number">3.9927549e-01</span>   <span class="number">4.4616335e-01</span>   <span class="number">4.7240007e-01</span>   <span class="number">2.7161480e-01</span>   <span class="number">2.8030883e-01</span></span><br><span class="line"><span class="number">1.4172683e-01</span>   <span class="number">1.6884314e-01</span>   <span class="number">2.7937007e-01</span>   <span class="number">3.4856431e-01</span>   <span class="number">4.3857605e-01</span>   <span class="number">4.9800156e-01</span>   <span class="number">5.2526881e-01</span>   <span class="number">1.2057525e-01</span>   <span class="number">1.3119104e-01</span></span><br><span class="line"><span class="number">4.9762118e-02</span>   <span class="number">1.2646476e-01</span>   <span class="number">2.1885211e-01</span>   <span class="number">2.7695980e-01</span>   <span class="number">3.3962502e-01</span>   <span class="number">3.9232585e-01</span>   <span class="number">4.2293225e-01</span>   <span class="number">4.5168610e-01</span>   <span class="number">4.4940869e-01</span></span><br><span class="line"><span class="number">1.1664824e-01</span>   <span class="number">1.5255979e-01</span>   <span class="number">2.5801235e-01</span>   <span class="number">3.2411839e-01</span>   <span class="number">4.1170366e-01</span>   <span class="number">4.7713532e-01</span>   <span class="number">5.1451309e-01</span>   <span class="number">2.4308012e-01</span>   <span class="number">2.5948949e-01</span></span><br><span class="line"><span class="number">1.6300080e-01</span>   <span class="number">1.7545808e-01</span>   <span class="number">2.4907066e-01</span>   <span class="number">3.0835049e-01</span>   <span class="number">4.0042169e-01</span>   <span class="number">4.9006514e-01</span>   <span class="number">5.4422570e-01</span>   <span class="number">1.8971850e-01</span>   <span class="number">2.1691957e-01</span></span><br><span class="line"><span class="number">1.1144977e-01</span>   <span class="number">1.3489716e-01</span>   <span class="number">2.2644205e-01</span>   <span class="number">2.9215646e-01</span>   <span class="number">3.8536483e-01</span>   <span class="number">4.6326561e-01</span>   <span class="number">5.1087974e-01</span>   <span class="number">3.0960602e-01</span>   <span class="number">3.2932847e-01</span></span><br><span class="line"><span class="number">1.4502528e-01</span>   <span class="number">1.3256756e-01</span>   <span class="number">1.7550282e-01</span>   <span class="number">2.1469996e-01</span>   <span class="number">2.8639896e-01</span>   <span class="number">4.2323996e-01</span>   <span class="number">5.4785581e-01</span>   <span class="number">3.4123619e-01</span>   <span class="number">4.4889669e-01</span>];</span><br><span class="line"></span><br><span class="line">upB = [...</span><br><span class="line"><span class="number">7.7969936e-01</span>   <span class="number">5.5909264e-01</span>   <span class="number">3.6692096e-01</span>   <span class="number">2.0292753e-01</span>   <span class="number">1.3779175e-01</span>   <span class="number">1.0873357e-01</span>   <span class="number">9.5895728e-02</span>   <span class="number">4.5695335e-02</span>   <span class="number">4.6623543e-02</span></span><br><span class="line"><span class="number">7.1135851e-01</span>   <span class="number">5.5483793e-01</span>   <span class="number">4.2431975e-01</span>   <span class="number">2.5442939e-01</span>   <span class="number">1.8182569e-01</span>   <span class="number">1.4088103e-01</span>   <span class="number">1.2594384e-01</span>   <span class="number">2.7945457e-02</span>   <span class="number">2.7482701e-02</span></span><br><span class="line"><span class="number">6.4636996e-01</span>   <span class="number">5.4024177e-01</span>   <span class="number">4.7082785e-01</span>   <span class="number">3.2199848e-01</span>   <span class="number">2.4284402e-01</span>   <span class="number">1.9718059e-01</span>   <span class="number">1.7318334e-01</span>   <span class="number">6.7007986e-02</span>   <span class="number">6.1761903e-02</span></span><br><span class="line"><span class="number">5.6956355e-01</span>   <span class="number">5.1481217e-01</span>   <span class="number">5.2762943e-01</span>   <span class="number">3.7374247e-01</span>   <span class="number">3.1163845e-01</span>   <span class="number">2.6467090e-01</span>   <span class="number">2.3993224e-01</span>   <span class="number">6.1840977e-02</span>   <span class="number">6.1595171e-02</span></span><br><span class="line"><span class="number">4.7766327e-01</span>   <span class="number">4.8771143e-01</span>   <span class="number">5.4753295e-01</span>   <span class="number">4.1775156e-01</span>   <span class="number">3.5180203e-01</span>   <span class="number">3.1410390e-01</span>   <span class="number">3.0074757e-01</span>   <span class="number">9.8916601e-02</span>   <span class="number">9.8223557e-02</span></span><br><span class="line"><span class="number">4.2349058e-01</span>   <span class="number">4.1629204e-01</span>   <span class="number">5.0574462e-01</span>   <span class="number">4.2702700e-01</span>   <span class="number">3.8954221e-01</span>   <span class="number">3.5793655e-01</span>   <span class="number">3.4536165e-01</span>   <span class="number">6.5299946e-02</span>   <span class="number">7.0929396e-02</span></span><br><span class="line"><span class="number">3.6203259e-01</span>   <span class="number">3.8603916e-01</span>   <span class="number">4.8546366e-01</span>   <span class="number">4.3877038e-01</span>   <span class="number">4.1263302e-01</span>   <span class="number">3.7826776e-01</span>   <span class="number">3.6026748e-01</span>   <span class="number">8.9755079e-02</span>   <span class="number">9.6484956e-02</span></span><br><span class="line"><span class="number">3.2810264e-01</span>   <span class="number">3.4343461e-01</span>   <span class="number">4.6353434e-01</span>   <span class="number">4.4890674e-01</span>   <span class="number">4.4108569e-01</span>   <span class="number">4.1758379e-01</span>   <span class="number">4.1232286e-01</span>   <span class="number">9.4401188e-02</span>   <span class="number">1.4021177e-01</span></span><br><span class="line"><span class="number">4.2855883e-01</span>   <span class="number">3.6912183e-01</span>   <span class="number">4.3403075e-01</span>   <span class="number">4.1270429e-01</span>   <span class="number">4.1160816e-01</span>   <span class="number">4.0289362e-01</span>   <span class="number">4.1035327e-01</span>   <span class="number">1.6615177e-01</span>   <span class="number">1.7528681e-01</span></span><br><span class="line"><span class="number">2.8324712e-01</span>   <span class="number">3.1754972e-01</span>   <span class="number">4.7084893e-01</span>   <span class="number">4.5098695e-01</span>   <span class="number">4.5149446e-01</span>   <span class="number">4.5357177e-01</span>   <span class="number">4.5236036e-01</span>   <span class="number">1.2816675e-01</span>   <span class="number">1.2540729e-01</span></span><br><span class="line"><span class="number">3.5991344e-01</span>   <span class="number">3.1914376e-01</span>   <span class="number">3.7307732e-01</span>   <span class="number">3.9984107e-01</span>   <span class="number">4.2745720e-01</span>   <span class="number">4.5149720e-01</span>   <span class="number">4.7720363e-01</span>   <span class="number">1.6995977e-01</span>   <span class="number">2.8445448e-01</span></span><br><span class="line"><span class="number">2.5323148e-01</span>   <span class="number">2.8678090e-01</span>   <span class="number">3.7399254e-01</span>   <span class="number">4.0526187e-01</span>   <span class="number">4.3921995e-01</span>   <span class="number">4.7516031e-01</span>   <span class="number">5.0687105e-01</span>   <span class="number">1.8317200e-01</span>   <span class="number">1.8818901e-01</span></span><br><span class="line"><span class="number">2.3499754e-01</span>   <span class="number">2.5303395e-01</span>   <span class="number">3.9213672e-01</span>   <span class="number">4.2364082e-01</span>   <span class="number">4.7335481e-01</span>   <span class="number">4.8597037e-01</span>   <span class="number">4.8826847e-01</span>   <span class="number">1.2800547e-01</span>   <span class="number">1.3376144e-01</span></span><br><span class="line"><span class="number">2.6334872e-01</span>   <span class="number">2.6326210e-01</span>   <span class="number">3.4983739e-01</span>   <span class="number">3.8201315e-01</span>   <span class="number">4.2907348e-01</span>   <span class="number">4.6056025e-01</span>   <span class="number">5.0704621e-01</span>   <span class="number">2.6195191e-01</span>   <span class="number">2.7603537e-01</span></span><br><span class="line"><span class="number">2.0165686e-01</span>   <span class="number">2.1944496e-01</span>   <span class="number">3.3293904e-01</span>   <span class="number">3.8081387e-01</span>   <span class="number">4.4757827e-01</span>   <span class="number">4.9268537e-01</span>   <span class="number">5.2092931e-01</span>   <span class="number">2.0348242e-01</span>   <span class="number">2.2378780e-01</span></span><br><span class="line"><span class="number">2.2950692e-01</span>   <span class="number">2.2362822e-01</span>   <span class="number">2.9607108e-01</span>   <span class="number">3.3929798e-01</span>   <span class="number">3.8191277e-01</span>   <span class="number">4.3237136e-01</span>   <span class="number">4.6462834e-01</span>   <span class="number">3.9304042e-01</span>   <span class="number">4.1905293e-01</span></span><br><span class="line"><span class="number">2.3208516e-01</span>   <span class="number">2.4386127e-01</span>   <span class="number">3.1588427e-01</span>   <span class="number">3.5480624e-01</span>   <span class="number">4.1530756e-01</span>   <span class="number">4.6339021e-01</span>   <span class="number">5.0286163e-01</span>   <span class="number">3.0237661e-01</span>   <span class="number">3.1290136e-01</span></span><br><span class="line"><span class="number">2.0171262e-01</span>   <span class="number">2.0441871e-01</span>   <span class="number">3.0892189e-01</span>   <span class="number">3.7634368e-01</span>   <span class="number">4.5467828e-01</span>   <span class="number">5.2197132e-01</span>   <span class="number">5.6041815e-01</span>   <span class="number">1.6311236e-01</span>   <span class="number">1.6976942e-01</span></span><br><span class="line"><span class="number">6.5661340e-02</span>   <span class="number">1.4690487e-01</span>   <span class="number">2.3551261e-01</span>   <span class="number">2.9595427e-01</span>   <span class="number">3.6727210e-01</span>   <span class="number">4.1473807e-01</span>   <span class="number">4.3942630e-01</span>   <span class="number">4.7896558e-01</span>   <span class="number">4.9313138e-01</span></span><br><span class="line"><span class="number">1.5923700e-01</span>   <span class="number">1.8447802e-01</span>   <span class="number">2.9637570e-01</span>   <span class="number">3.5554446e-01</span>   <span class="number">4.2928965e-01</span>   <span class="number">5.0010046e-01</span>   <span class="number">5.7076206e-01</span>   <span class="number">2.9044526e-01</span>   <span class="number">2.9315569e-01</span></span><br><span class="line"><span class="number">2.3467705e-01</span>   <span class="number">2.3694940e-01</span>   <span class="number">2.9291331e-01</span>   <span class="number">3.3603937e-01</span>   <span class="number">4.4272385e-01</span>   <span class="number">5.1506755e-01</span>   <span class="number">6.0505783e-01</span>   <span class="number">2.4064496e-01</span>   <span class="number">2.8576387e-01</span></span><br><span class="line"><span class="number">1.5917155e-01</span>   <span class="number">1.6716117e-01</span>   <span class="number">2.5081075e-01</span>   <span class="number">3.1848061e-01</span>   <span class="number">4.0755621e-01</span>   <span class="number">4.8220009e-01</span>   <span class="number">5.7294813e-01</span>   <span class="number">3.5104257e-01</span>   <span class="number">3.8328993e-01</span></span><br><span class="line"><span class="number">1.8025311e-01</span>   <span class="number">1.6668715e-01</span>   <span class="number">1.9757519e-01</span>   <span class="number">2.3256976e-01</span>   <span class="number">3.0993604e-01</span>   <span class="number">4.5188827e-01</span>   <span class="number">5.7836256e-01</span>   <span class="number">3.7903370e-01</span>   <span class="number">5.0856220e-01</span>];</span><br><span class="line"></span><br><span class="line">lowB = [...</span><br><span class="line"><span class="number">7.0944028e-01</span>   <span class="number">5.1166101e-01</span>   <span class="number">2.7132138e-01</span>   <span class="number">1.1925057e-01</span>   <span class="number">7.3117696e-02</span>   <span class="number">5.2517151e-02</span>   <span class="number">4.4424250e-02</span>   <span class="number">2.3244358e-03</span>   <span class="number">1.7280789e-03</span></span><br><span class="line"><span class="number">6.3840139e-01</span>   <span class="number">5.0883522e-01</span>   <span class="number">3.6351047e-01</span>   <span class="number">1.9833316e-01</span>   <span class="number">1.3181697e-01</span>   <span class="number">1.0045892e-01</span>   <span class="number">8.4327293e-02</span>   <span class="number">2.7526552e-03</span>   <span class="number">3.0136510e-03</span></span><br><span class="line"><span class="number">5.5332832e-01</span>   <span class="number">4.9738169e-01</span>   <span class="number">4.1160489e-01</span>   <span class="number">2.4634336e-01</span>   <span class="number">1.7860486e-01</span>   <span class="number">1.3952599e-01</span>   <span class="number">1.1925864e-01</span>   <span class="number">7.1624892e-03</span>   <span class="number">6.7813256e-03</span></span><br><span class="line"><span class="number">4.3575142e-01</span>   <span class="number">4.3822012e-01</span>   <span class="number">4.1917290e-01</span>   <span class="number">3.1017788e-01</span>   <span class="number">2.4134878e-01</span>   <span class="number">1.9276253e-01</span>   <span class="number">1.6873340e-01</span>   <span class="number">1.0336969e-02</span>   <span class="number">1.0575256e-02</span></span><br><span class="line"><span class="number">3.6482973e-01</span>   <span class="number">3.9039153e-01</span>   <span class="number">4.1720917e-01</span>   <span class="number">3.6595976e-01</span>   <span class="number">2.8660924e-01</span>   <span class="number">2.3234012e-01</span>   <span class="number">2.0247522e-01</span>   <span class="number">1.5868207e-02</span>   <span class="number">1.5286574e-02</span></span><br><span class="line"><span class="number">3.0704995e-01</span>   <span class="number">3.6020020e-01</span>   <span class="number">4.0499850e-01</span>   <span class="number">3.8743491e-01</span>   <span class="number">3.4744031e-01</span>   <span class="number">2.9691113e-01</span>   <span class="number">2.7164222e-01</span>   <span class="number">2.8723854e-02</span>   <span class="number">2.8095758e-02</span></span><br><span class="line"><span class="number">2.5106498e-01</span>   <span class="number">3.1479600e-01</span>   <span class="number">4.1503769e-01</span>   <span class="number">4.0334518e-01</span>   <span class="number">3.7325697e-01</span>   <span class="number">3.3395352e-01</span>   <span class="number">3.0649812e-01</span>   <span class="number">1.6409266e-02</span>   <span class="number">2.1277292e-02</span></span><br><span class="line"><span class="number">1.9524320e-01</span>   <span class="number">2.6645927e-01</span>   <span class="number">3.7459566e-01</span>   <span class="number">3.8648689e-01</span>   <span class="number">3.8966056e-01</span>   <span class="number">3.7107656e-01</span>   <span class="number">3.4536957e-01</span>   <span class="number">2.3468373e-02</span>   <span class="number">2.5248160e-02</span></span><br><span class="line"><span class="number">2.9510963e-01</span>   <span class="number">3.1603431e-01</span>   <span class="number">3.6697675e-01</span>   <span class="number">3.6241475e-01</span>   <span class="number">3.5891532e-01</span>   <span class="number">3.5210964e-01</span>   <span class="number">3.4139078e-01</span>   <span class="number">5.8341191e-02</span>   <span class="number">6.6080536e-02</span></span><br><span class="line"><span class="number">1.3127870e-01</span>   <span class="number">2.3383370e-01</span>   <span class="number">3.3563122e-01</span>   <span class="number">3.8054666e-01</span>   <span class="number">4.0677434e-01</span>   <span class="number">3.8957954e-01</span>   <span class="number">3.7636462e-01</span>   <span class="number">2.1549732e-02</span>   <span class="number">3.2454227e-02</span></span><br><span class="line"><span class="number">2.4706327e-01</span>   <span class="number">2.4040986e-01</span>   <span class="number">3.1094797e-01</span>   <span class="number">3.4504382e-01</span>   <span class="number">3.6604542e-01</span>   <span class="number">3.6960554e-01</span>   <span class="number">3.7735013e-01</span>   <span class="number">8.4929835e-02</span>   <span class="number">1.1753899e-01</span></span><br><span class="line"><span class="number">1.4757789e-01</span>   <span class="number">2.0726071e-01</span>   <span class="number">3.0160822e-01</span>   <span class="number">3.3610868e-01</span>   <span class="number">4.0871602e-01</span>   <span class="number">4.2488320e-01</span>   <span class="number">4.2659628e-01</span>   <span class="number">1.0951814e-01</span>   <span class="number">1.1484183e-01</span></span><br><span class="line"><span class="number">9.1742158e-02</span>   <span class="number">1.6100841e-01</span>   <span class="number">3.1322179e-01</span>   <span class="number">3.7490499e-01</span>   <span class="number">4.2297563e-01</span>   <span class="number">4.3757985e-01</span>   <span class="number">4.3639722e-01</span>   <span class="number">2.4259065e-02</span>   <span class="number">2.3478356e-02</span></span><br><span class="line"><span class="number">1.5838339e-01</span>   <span class="number">1.9960855e-01</span>   <span class="number">2.6513370e-01</span>   <span class="number">3.1086089e-01</span>   <span class="number">3.8179041e-01</span>   <span class="number">4.2671191e-01</span>   <span class="number">4.3813226e-01</span>   <span class="number">1.5437250e-01</span>   <span class="number">1.7919256e-01</span></span><br><span class="line"><span class="number">6.5751115e-02</span>   <span class="number">1.4872663e-01</span>   <span class="number">2.7329740e-01</span>   <span class="number">3.3440351e-01</span>   <span class="number">4.1829544e-01</span>   <span class="number">4.5463364e-01</span>   <span class="number">4.6632118e-01</span>   <span class="number">1.3489346e-01</span>   <span class="number">1.4272407e-01</span></span><br><span class="line"><span class="number">1.5596873e-01</span>   <span class="number">1.6063788e-01</span>   <span class="number">2.2583023e-01</span>   <span class="number">2.8187737e-01</span>   <span class="number">3.5551812e-01</span>   <span class="number">3.9392236e-01</span>   <span class="number">4.1661845e-01</span>   <span class="number">3.2762330e-01</span>   <span class="number">3.3207209e-01</span></span><br><span class="line"><span class="number">1.3658524e-01</span>   <span class="number">1.7620400e-01</span>   <span class="number">2.5184514e-01</span>   <span class="number">3.0981985e-01</span>   <span class="number">3.8772491e-01</span>   <span class="number">4.1841560e-01</span>   <span class="number">4.3663895e-01</span>   <span class="number">2.4409767e-01</span>   <span class="number">2.4335830e-01</span></span><br><span class="line"><span class="number">5.7943169e-02</span>   <span class="number">1.1577971e-01</span>   <span class="number">2.4910978e-01</span>   <span class="number">3.2064774e-01</span>   <span class="number">4.1928998e-01</span>   <span class="number">4.8032887e-01</span>   <span class="number">4.9879067e-01</span>   <span class="number">4.9669377e-02</span>   <span class="number">5.4213979e-02</span></span><br><span class="line"><span class="number">3.2114597e-02</span>   <span class="number">7.9563157e-02</span>   <span class="number">1.8250239e-01</span>   <span class="number">2.4567895e-01</span>   <span class="number">3.2360944e-01</span>   <span class="number">3.7846671e-01</span>   <span class="number">4.1099745e-01</span>   <span class="number">4.1683471e-01</span>   <span class="number">4.0913583e-01</span></span><br><span class="line"><span class="number">3.5790266e-02</span>   <span class="number">9.6338446e-02</span>   <span class="number">2.1754001e-01</span>   <span class="number">2.9267040e-01</span>   <span class="number">3.9487537e-01</span>   <span class="number">4.6406111e-01</span>   <span class="number">4.9047457e-01</span>   <span class="number">2.0439610e-01</span>   <span class="number">2.1684389e-01</span></span><br><span class="line"><span class="number">1.0724044e-01</span>   <span class="number">1.4052739e-01</span>   <span class="number">1.9880290e-01</span>   <span class="number">2.4646929e-01</span>   <span class="number">3.4713330e-01</span>   <span class="number">4.6406216e-01</span>   <span class="number">5.0762214e-01</span>   <span class="number">1.4872355e-01</span>   <span class="number">1.7132289e-01</span></span><br><span class="line"><span class="number">7.3193803e-02</span>   <span class="number">9.8029772e-02</span>   <span class="number">2.0015322e-01</span>   <span class="number">2.4913266e-01</span>   <span class="number">3.3016201e-01</span>   <span class="number">4.5041635e-01</span>   <span class="number">4.8460783e-01</span>   <span class="number">2.6383395e-01</span>   <span class="number">2.9161859e-01</span></span><br><span class="line"><span class="number">9.3197327e-02</span>   <span class="number">9.4502428e-02</span>   <span class="number">1.4641494e-01</span>   <span class="number">1.9385761e-01</span>   <span class="number">2.6497912e-01</span>   <span class="number">3.8223376e-01</span>   <span class="number">4.8516910e-01</span>   <span class="number">3.0135913e-01</span>   <span class="number">3.8303801e-01</span>];</span><br><span class="line">    </span><br><span class="line">[refRow,refCol]=<span class="built_in">size</span>(ref_nRrs);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% match the ref_lambda and test_lambda</span></span><br><span class="line">idx0 = []; <span class="comment">% for ref_lambda </span></span><br><span class="line">idx1 = []; <span class="comment">% for test_lambda</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span> : <span class="built_in">length</span>(test_lambda)</span><br><span class="line">    pos = <span class="built_in">find</span>(ref_lambda==test_lambda(<span class="built_in">i</span>));</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isempty</span>(pos)</span><br><span class="line">        idx1(<span class="built_in">i</span>) = NaN;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        idx0(<span class="built_in">i</span>) = pos;</span><br><span class="line">        idx1(<span class="built_in">i</span>) = <span class="built_in">i</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">pos = <span class="built_in">isnan</span>(idx1);  idx1(pos) = [];</span><br><span class="line"></span><br><span class="line">test_lambda = test_lambda(idx1); test_Rrs = test_Rrs(:,idx1);</span><br><span class="line">ref_lambda = ref_lambda(idx0); ref_nRrs = ref_nRrs(:,idx0); </span><br><span class="line">upB = upB(:,idx0); lowB = lowB(:,idx0); </span><br><span class="line"></span><br><span class="line"><span class="comment">%% match the ref_nRrs and test_Rrs</span></span><br><span class="line"><span class="comment">% keep the original value</span></span><br><span class="line">test_Rrs_orig = test_Rrs;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="comment">%% nromalization</span></span><br><span class="line">[inRow, inCol] = <span class="built_in">size</span>(test_Rrs);</span><br><span class="line"></span><br><span class="line"><span class="comment">% transform spectrum to column, inCol*inRow</span></span><br><span class="line">test_Rrs = test_Rrs&#x27;;</span><br><span class="line">test_Rrs_orig = test_Rrs_orig&#x27;;</span><br><span class="line"></span><br><span class="line"><span class="comment">% inCol*inRow</span></span><br><span class="line">nRrs_denom=<span class="built_in">sqrt</span>(nansum(test_Rrs.^<span class="number">2</span>));</span><br><span class="line">nRrs_denom = <span class="built_in">repmat</span>(nRrs_denom,[inCol,<span class="number">1</span>]);</span><br><span class="line">nRrs = test_Rrs./nRrs_denom;  </span><br><span class="line"></span><br><span class="line"><span class="comment">% SAM input, inCol*inRow*refRow </span></span><br><span class="line">test_Rrs2 = <span class="built_in">repmat</span>(test_Rrs_orig,[<span class="number">1</span>,<span class="number">1</span>,refRow]);</span><br><span class="line"></span><br><span class="line"><span class="comment">%for ref Rrs, inCol*refRow*inRow </span></span><br><span class="line">test_Rrs2p = <span class="built_in">permute</span>(test_Rrs2,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">% inCol*inRow*refRow  </span></span><br><span class="line">nRrs2_denom=<span class="built_in">sqrt</span>(nansum(test_Rrs2.^<span class="number">2</span>));</span><br><span class="line">nRrs2_denom = <span class="built_in">repmat</span>(nRrs2_denom,[inCol,<span class="number">1</span>]);</span><br><span class="line">nRrs2 = test_Rrs2./nRrs2_denom;  </span><br><span class="line"><span class="comment">% inCol*refRow*inRow  </span></span><br><span class="line">nRrs2 = <span class="built_in">permute</span>(nRrs2,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% adjust the ref_nRrs, according to the matched wavebands</span></span><br><span class="line"><span class="comment">%[row, ~] = size(ref_nRrs);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%%%% re-normalize the ref_adjusted</span></span><br><span class="line">ref_nRrs = ref_nRrs&#x27;;</span><br><span class="line"></span><br><span class="line"><span class="comment">% inCol*refRow*inRow </span></span><br><span class="line">ref_nRrs2 = <span class="built_in">repmat</span>(ref_nRrs,[<span class="number">1</span>,<span class="number">1</span>,inRow]);</span><br><span class="line"></span><br><span class="line"><span class="comment">% inCol*refRow*inRow </span></span><br><span class="line">ref_nRrs2_denom=<span class="built_in">sqrt</span>(nansum(ref_nRrs2.^<span class="number">2</span>));</span><br><span class="line">ref_nRrs2_denom = <span class="built_in">repmat</span>(ref_nRrs2_denom,[inCol,<span class="number">1</span>]);</span><br><span class="line">ref_nRrs_corr2 = ref_nRrs2./ref_nRrs2_denom;</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Classification </span></span><br><span class="line"><span class="comment">%%%% calculate the Spectral angle mapper</span></span><br><span class="line"><span class="comment">% inCol*refRow*inRow </span></span><br><span class="line">cos_denom=<span class="built_in">sqrt</span>(nansum(ref_nRrs_corr2.^<span class="number">2</span>).*nansum(nRrs2.^<span class="number">2</span>));</span><br><span class="line">cos_denom = <span class="built_in">repmat</span>(cos_denom,[inCol,<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">cos</span> = (ref_nRrs_corr2.*nRrs2)./cos_denom; </span><br><span class="line"><span class="comment">% 1*refRow*inRow </span></span><br><span class="line"><span class="built_in">cos</span> = sum(<span class="built_in">cos</span>);</span><br><span class="line"><span class="comment">% refRow*inRow</span></span><br><span class="line"><span class="built_in">cos</span> = <span class="built_in">permute</span>(<span class="built_in">cos</span>,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 1*inRow</span></span><br><span class="line">[maxCos,clusterID] = <span class="built_in">max</span>(<span class="built_in">cos</span>);</span><br><span class="line">posClusterID = <span class="built_in">isnan</span>(maxCos);</span><br><span class="line"><span class="comment">%potential bug for vectorized code</span></span><br><span class="line"><span class="comment">%clusterID(pos) = NaN;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% if isnan(cos)</span></span><br><span class="line"><span class="comment">%     clusterID = NaN;</span></span><br><span class="line"><span class="comment">% else</span></span><br><span class="line"><span class="comment">%     clusterID = find(cos==maxCos);</span></span><br><span class="line"><span class="comment">% end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% scoring</span></span><br><span class="line"> </span><br><span class="line">upB_corr = upB&#x27;; </span><br><span class="line">lowB_corr = lowB&#x27;; </span><br><span class="line"></span><br><span class="line"><span class="comment">%% comparison</span></span><br><span class="line"><span class="comment">% inCol*inRow</span></span><br><span class="line">upB_corr2 = upB_corr(:,clusterID).*(<span class="number">1</span>+<span class="number">0.005</span>);</span><br><span class="line">lowB_corr2 = lowB_corr(:,clusterID).*(<span class="number">1</span><span class="number">-0.005</span>);</span><br><span class="line">ref_nRrs2 = ref_nRrs(:,clusterID);</span><br><span class="line"></span><br><span class="line"><span class="comment">%normalization</span></span><br><span class="line">ref_nRrs2_denom=<span class="built_in">sqrt</span>(nansum(ref_nRrs2.^<span class="number">2</span>));</span><br><span class="line">ref_nRrs2_denom = <span class="built_in">repmat</span>(ref_nRrs2_denom,[inCol,<span class="number">1</span>]);</span><br><span class="line">upB_corr2 = upB_corr2 ./ ref_nRrs2_denom;</span><br><span class="line">lowB_corr2 = lowB_corr2 ./ ref_nRrs2_denom;</span><br><span class="line"></span><br><span class="line">upB_diff = upB_corr2 - nRrs;</span><br><span class="line">lowB_diff = nRrs - lowB_corr2;</span><br><span class="line"></span><br><span class="line">C = <span class="built_in">zeros</span>(inCol,inRow);</span><br><span class="line">pos = <span class="built_in">find</span>( upB_diff&gt;=<span class="number">0</span> &amp; lowB_diff&gt;=<span class="number">0</span> );</span><br><span class="line">C(pos) = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">%process all NaN spectral </span></span><br><span class="line">C(:,posClusterID)=NaN;                                               </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">totScore = <span class="built_in">nanmean</span>(C) ;  </span><br></pre></td></tr></table></figure>
<h2 id="annotation">Annotation</h2>
<p>I believe this is actually not the true evaluation that do not need any 'in-situ' data.</p>
<p>It should met a lot of problem when applied it to other regions and sensors.</p>
<p>I need to modify the former code if I want to use it in the evaluation of fusion result.</p>
<h1 id="a-hybrid-algorithm-for-estimating-the-chlorophyll-a-concentration-across-different-trophic-states-in-asian-inland-waters">A hybrid algorithm for estimating the chlorophyll-<em>a</em> concentration across different trophic states in Asian inland waters</h1>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115201801830.png" alt="image-00030115201801830"><figcaption aria-hidden="true">image-00030115201801830</figcaption>
</figure>
<p><span class="math inline">\(MCI\le0.001\)</span> Slightly turbid</p>
<p><span class="math inline">\(0.001&lt;MCI\le0.0016\)</span> Moderate turbid</p>
<p><span class="math inline">\(MCI&gt;0.0016\)</span> Highly turbid</p>
<h1 id="optical-water-type-discrimination-and-tuning-remote-sensing-band-ratio-algorithms-application-to-retrieval-of-chlorophyll-and-kd490-in-the-irish-and-celtic-seas">Optical water type discrimination and tuning remote sensing band-ratio algorithms: Application to retrieval of chlorophyll and <em>K</em>d(490) in the Irish and Celtic Seas</h1>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115202628690.png" alt="image-00030115202628690"><figcaption aria-hidden="true">image-00030115202628690</figcaption>
</figure>
<p>This is a very very emprical classification.</p>
<h1 id="influence-of-a-red-band-based-water-classification-approach-on-chlorophyll-algorithms-for-optically-complex-estuarie">Influence of a red band-based water classification approach on chlorophyll algorithms for optically complex estuarie</h1>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030115202825460.png" alt="image-00030115202825460"><figcaption aria-hidden="true">image-00030115202825460</figcaption>
</figure>
<p>I can try this. Along with the Chia/TSM ratio</p>
<h1 id="a-soft-classification-based-chlorophyll-a-estimation-method-using-meris-data-in-the-highly-turbid-and-eutrophic-taihu-lake">A soft-classification-based chlorophyll-<em>a</em> estimation method using MERIS data in the highly turbid and eutrophic Taihu Lake</h1>
<p><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0303243417303148-gr2_lrg.jpg"></p>
<p>SGLI didn't have red edge wavelength, which introduced a lot of problem in this work.</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2NpZW5jZWRpcmVjdC5jb20vdG9waWNzL2VhcnRoLWFuZC1wbGFuZXRhcnktc2NpZW5jZXMvcGh5dG9wbGFua3Rvbg==">Phytoplankton<i class="fa fa-external-link-alt"></i></span> pigments cause high reflectance in red edge wavelengths (<em>e.g.</em> 709 nm), and low reflectance in red wavelengths (<em>e.g.</em> 681 nm) because of the phytoplankton pigment absorption peak around 681 nm.</p>
<h1 id="an-improved-optical-classification-scheme-for-the-ocean-colour-essential-climate-variable-and-its-applications">An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications</h1>
<p>其实这个并不能算是OWT-&gt;inversion/estimation</p>
<p>只是先用FCM划分了分类，然后假定模型在每类的error是一样的，最后通过每一类的error来给一个error estimation</p>
<h1 id="optical-types-of-inland-and-coastal-waters">Optical types of inland and coastal waters</h1>
<p>这篇文章真的是我感觉非常理想的文章了，因为他们非常理想的讲了OWT里面都是由什么构成的</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402161611706.png" alt="image-00030402161611706"><figcaption aria-hidden="true">image-00030402161611706</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402162450657.png" alt="image-00030402162450657"><figcaption aria-hidden="true">image-00030402162450657</figcaption>
</figure>
<p>这个13是按照给Inland water分类的，所以会有很严重的蓝藻的东西，</p>
<p>然后Coastal他们分了9类，但是没有给出解释之类的。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402162603375.png" alt="image-00030402162603375"><figcaption aria-hidden="true">image-00030402162603375</figcaption>
</figure>
<p>讲了给提供数据，但是链接打不开。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402164934583.png" alt="image-00030402164934583"><figcaption aria-hidden="true">image-00030402164934583</figcaption>
</figure>
<p>这个地方是讲怎么Match的</p>
<p>L2 norm distance 是基于Vector 的Euclidean distance</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172203229.png" alt="image-00030402172203229"><figcaption aria-hidden="true">image-00030402172203229</figcaption>
</figure>
<p>至于这个Norm?我查了查似乎并不是规范化的意思。</p>
<p>然后这个是全Dataset的Cluster结果。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172450000.png" alt="image-00030402172450000"><figcaption aria-hidden="true">image-00030402172450000</figcaption>
</figure>
<p>这个其实也害不错，但是就是没有讲这个大类里面每一种到底是什么样的。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172636127.png" alt="image-00030402172636127"><figcaption aria-hidden="true">image-00030402172636127</figcaption>
</figure>
<h2 id="a-global-approach-for-chlorophyll-a-retrieval-across-optically-complex-inland-waters-based-on-optical-water-type">A global approach for chlorophyll-a retrieval across optically complex inland waters based on optical water type</h2>
<p>这个是根据上一篇的结果做出来的。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402172912120.png" alt="image-00030402172912120"><figcaption aria-hidden="true">image-00030402172912120</figcaption>
</figure>
<p>然后在ACIX-Aqua李只选用了其中几个。</p>
<h1 id="remote-estimation-of-chlorophyll-a-concentrations-over-a-wide-range-of-optical-conditions-based-on-water-classification-from-viirs-observations">Remote estimation of chlorophyll a concentrations over a wide range of optical conditions based on water classification from VIIRS observations</h1>
<p>这个是算Chla的，但是好的地方在于这个文章给了一个非常清晰的怎么分类的过程。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173332530.png" alt="image-00030402173332530"><figcaption aria-hidden="true">image-00030402173332530</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173357960.png" alt="image-00030402173357960"><figcaption aria-hidden="true">image-00030402173357960</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173419427.png" alt="image-00030402173419427"><figcaption aria-hidden="true">image-00030402173419427</figcaption>
</figure>
<p>An absorption-related optical classification approach was developed by considering the contributions of different particle sources, aph(443)/ ad(443) (Table 3), to divide the study sites into three water classes, i.e., detritus-dominated waters (aph(443)/ad(443) &lt; 0.2, Wd), pigment- dominated waters (aph(443)/ad(443) ≥ 1.0, Wp) and intermediate waters (0.2 ≤ aph(443)/ad(443) &lt; 1.0, Wm),</p>
<p>自己可以尝试一下。</p>
<h1 id="remotely-estimating-total-suspended-solids-concentration-in-clear-to-extremely-turbid-waters-using-a-novel-semi-analytical-method">Remotely estimating total suspended solids concentration in clear to extremely turbid waters using a novel semi-analytical method</h1>
<p>这个是我最近特别喜欢的一篇文章。</p>
<p>果然还是中国人理解中国人。</p>
<p>而且这个用的是QAA</p>
<p>他的做Simulation和Rrs correction的过程也特别值得一看。</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173740967.png" alt="image-00030402173740967"><figcaption aria-hidden="true">image-00030402173740967</figcaption>
</figure>
<p>I 560</p>
<p>II 665</p>
<p>III 754</p>
<p>IV 865</p>
<p>这个可以保证算出来的bbp是准确的</p>
<figure>
<img src="https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image-00030402173903360.png" alt="image-00030402173903360"><figcaption aria-hidden="true">image-00030402173903360</figcaption>
</figure>
<p>虽然没有提到bbp shape的事情。</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>周大侠
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://lifeodyssey.github.io/posts/696b3f33.html" title="Water Classification for Inversion&#x2F;Retrieval">https://lifeodyssey.github.io/posts/696b3f33.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Ocean-Color/" rel="tag"># Ocean Color</a>
              <a href="/tags/Inherent-Optical-Properties/" rel="tag"># Inherent Optical Properties</a>
              <a href="/tags/Ocean-Optics/" rel="tag"># Ocean Optics</a>
              <a href="/tags/Research-Basis/" rel="tag"># Research Basis</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/d040ebe8.html" rel="prev" title="在我成为井井有条的大人之前">
      <i class="fa fa-chevron-left"></i> 在我成为井井有条的大人之前
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/8aa48f64.html" rel="next" title="《文凭社会》">
      《文凭社会》 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">周大侠</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">15:12</span>
</div>
  <div class="powered-by">Powered by <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      const script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>

<!DOCTYPE html><html class="font-sans scroll-smooth" lang=zh-CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/favicon.svg rel=icon type=image/svg+xml><title>probabilistic method in machine learning | 乔克叔叔的床边故事</title><meta content="机器学习中的统计方法，主要是跟着mixture density network那篇下来的 在MDN的那篇里面主要使用的是tfp.distributions.MixtureSameFamily(prob, dist), mix.log_pro..." name=description><meta content=周大侠 name=author><meta content="Astro v5.13.7" name=generator><meta content="oklch(96% 0.005 298)" name=theme-color><link href=/fonts/EarlySummer-VF-Split/EarlySummer-VF-Subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Black-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Bold-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-Italic-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=https://lifeodyssey.github.io/posts/62469dc9.html.html rel=canonical><link href=/sitemap-index.xml rel=sitemap><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=https://lifeodyssey.github.io rel=alternate hreflang=zh><link href=https://lifeodyssey.github.io/en/ rel=alternate hreflang=en><link href=https://lifeodyssey.github.io/ja/ rel=alternate hreflang=ja><meta content=article property=og:type><meta content=https://lifeodyssey.github.io/posts/62469dc9.html.html property=og:url><meta content="probabilistic method in machine learning | 乔克叔叔的床边故事" property=og:title><meta content="机器学习中的统计方法，主要是跟着mixture density network那篇下来的 在MDN的那篇里面主要使用的是tfp.distributions.MixtureSameFamily(prob, dist), mix.log_pro..." property=og:description><meta content=https://lifeodyssey.github.io/og/62469dc9.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.1k2cUud7.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!!e&&"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",t?"oklch(22% 0.005 298)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t)}document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),e(),t()}()</script><link href=/_astro/_about_.Dzb1Me_E.css rel=stylesheet><link href=/_astro/_posts_slug_.CM85RmC-.css rel=stylesheet><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const tp={preserveBehavior:!1},ep=t=>{if("string"==typeof t)return[t,tp];const[e,n=tp]=t;return[e,{...tp,...n}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,e,r,o,i,a,s,c,d,p,l=t,u){function f(){u||(u=1,"/"==(s=(a.lib||"/~partytown/")+(a.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),o!=t?o.dispatchEvent(new CustomEvent("pt1",{detail:t})):(c=setTimeout(w,(null==a?void 0:a.fallbackTimeout)||1e4),e.addEventListener("pt0",h),i?y(1):r.serviceWorker?r.serviceWorker.register(s+(a.swPath||"partytown-sw.js"),{scope:s}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):w())))}function y(n){p=e.createElement(n?"script":"iframe"),t._pttab=Date.now(),n||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=s+"partytown-"+(n?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),e.querySelector(a.sandboxParent||"body").appendChild(p)}function w(n,r){for(h(),o==t&&(a.forward||[]).map((function(e){const[n]=ep(e);delete t[n.split(".")[0]]})),n=0;n<d.length;n++)(r=e.createElement("script")).innerHTML=d[n].innerHTML,r.nonce=a.nonce,e.head.appendChild(r);p&&p.parentNode.removeChild(p)}function h(){clearTimeout(c)}a=t.partytown||{},o==t&&(a.forward||[]).map((function(e){const[r,{preserveBehavior:o}]=ep(e);l=t,r.split(".").map((function(e,r,i){var a;l=l[i[r]]=r+1<i.length?l[i[r]]||(a=i[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(o){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,i);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(i,arguments),n}})()}))})),"complete"==e.readyState?f():(t.addEventListener("DOMContentLoaded",f),t.addEventListener("load",f))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-62469dc9-zh}@layer astro{::view-transition-old(post-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-62469dc9-zh}@layer astro{::view-transition-old(time-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-62469dc9-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-wif6pdce-3]{view-transition-name:site-title-zh}@layer astro{::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><body><div class="w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><header class="cjk:tracking-0.02em lg:uno-desktop-column lg:top-20 mb-10.8"><h2 class="font-bold c-secondary font-title lg:c-primary lg:mb-1.8 lg:mt-0 lg:text-9 mb-2.8 mt-3 text-5.375"><div class="inline-block box-content pr-1" data-astro-transition-scope=astro-wif6pdce-3 data-disable-theme-transition><a href=/ id=site-title-link>乔克叔叔的床边故事</a></div></h2></header><nav aria-label="Site Navigation" class="hidden cjk:tracking-0.02em font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,12.5rem)] lg:text-4 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">文章</a></li><li><a href=/tags/ class="hover:c-primary highlight-hover after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">标签</a></li><li><a href=/about/ class="hover:c-primary highlight-hover after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">关于</a></li><li><a href=/search/ class="hover:c-primary highlight-hover after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Search</a></li></ul></nav><main class=mb-10><article class=heti><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function e(t){if(!(t.target instanceof Element?t.target:null)?.closest("#back-button"))return;if(window.history.length>1)return void window.history.back();const e=document.getElementById("site-title-link");e&&e.click()}document.addEventListener("click",e,{passive:!0})</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>probabilistic method in machine learning</span></h1></div><div class="c-primary block font-time mb-17.2" data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition id=post-date><time datetime=2022-02-12>2022-02-12 </time><span class=ml-1.75>12 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="w-full h-12 relative" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>目录</span><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24" class="aspect-square 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center hidden ml-4 w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#categorical-distribution class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>Categorical distribution</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#mdn代码解析 class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>MDN代码解析</a></li></ul></nav></div></div><script type=module>let s=null,i=null;function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",c=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&c.set(e,t)}));let r=null;function l(t){t!==r&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),r=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}s=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=c.get(e);t&&l(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]}),Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>s?.observe(t)));const a=document.getElementById("post-copyright");a&&(i=new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),r=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}),i?.observe(a),n.length>0&&l(n[0]))}function m(){s?.disconnect(),i?.disconnect(),s=null,i=null}document.addEventListener("astro:after-swap",g),document.addEventListener("astro:before-swap",m),g()</script><div id=post-content><p>机器学习中的统计方法，主要是跟着mixture density network那篇下来的</p><p>在MDN的那篇里面主要使用的是tfp.distributions.MixtureSameFamily(prob, dist),</p><p>mix.log_prob(y)</p><p>MixtureSameFamily，一个categorical,</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> loss</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, y, output):</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    prior, mu, scale </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>._parse_outputs(output) </span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>    #获取输出结果的三个参数</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    dist  </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> getattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(tfp.distributions, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.distribution)(mu, scale)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    prob  </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfp.distributions.Categorical(</span><span style=color:#e36209;--shiki-dark:#FFAB70>probs</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>prior)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    mix   </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfp.distributions.MixtureSameFamily(prob, dist)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    likelihood </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> mix.log_prob(y)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tf.reduce_mean(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>likelihood) </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tf.add_n([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.] </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.model.losses)</span></span></code></pre></div><p>就是这个函数</p><p>来细致看里面调用的东西</p><h1 id=第一句>第一句<a href=#第一句 class=heading-anchor-link aria-label="Link to 第一句"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> dist  </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> getattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(tfp.distributions, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.distribution)(mu, scale)</span></span></code></pre></div><p>getattr获得对象的属性值</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>getattr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>object</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, name[, default])</span></span></code></pre></div><ul><li>oject — 对象。</li><li>name — 字符串，对象属性。</li><li>default — 默认返回值，如果不提供该参数，在没有对应属性时，将触发 AttributeError。</li></ul><p>但是这里用的是利用getattr来调用函数的办法</p><p>self.distribution等于 ‘MultivariateNormalTriL’这句话实际上是 在tfp.distributions里调用了一个 ‘MultivariateNormalTriL’的函数实例，然后把(mu, scale)这两个参数传给这个函数</p><p>这个函数是</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> MultivariateNormalTriL</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    mvn_linear_operator</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.</span><span style=color:#6f42c1;--shiki-dark:#B392F0>MultivariateNormalLinearOperator</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  """The multivariate normal distribution on `R^k`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The Multivariate Normal distribution is defined over `R^k` and parameterized</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  by a (batch of) length-`k` `loc` vector (aka "mu") and a (batch of) `k x k`</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  `scale` matrix; `covariance = scale @ scale.T` where `@` denotes</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  matrix-multiplication.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  #### Mathematical Details</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The probability density function (pdf) is,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  ```none</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  pdf(x; loc, scale) = exp(-0.5 ||y||**2) / Z,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  y = inv(scale) @ (x - loc),</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  Z = (2 pi)**(0.5 k) |det(scale)|,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  where:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  * `loc` is a vector in `R^k`,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  * `scale` is a matrix in `R^{k x k}`, `covariance = scale @ scale.T`,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  * `Z` denotes the normalization constant, and,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  * `||y||**2` denotes the squared Euclidean norm of `y`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    A (non-batch) `scale` matrix is:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  ```none</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  scale = scale_tril</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>```</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  where `scale_tril` is lower-triangular `k x k` matrix with non-zero diagonal,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  i.e., `tf.diag_part(scale_tril) != 0`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  Additional leading dimensions (if any) will index batches.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The MultivariateNormal distribution is a member of the [location-scale</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  family](https://en.wikipedia.org/wiki/Location-scale_family), i.e., it can be</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  constructed as,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  ```none</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  X ~ MultivariateNormal(loc=0, scale=1)   # Identity scale, zero shift.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  Y = scale @ X + loc</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  ```</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  Trainable (batch) lower-triangular matrices can be created with</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  `tfp.distributions.matrix_diag_transform()` and/or</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  `tfp.math.fill_triangular()</span></span></code></pre></div><p>简单理解就是传入了方差和均值两个参数，来计算一个多变量的正态分布</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  tfd </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfp.distributions</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # Initialize a single 3-variate Gaussian.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mu </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  cov </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [[ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.36</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.12</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.06</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>         [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.12</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.29</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.13</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>         [ </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.06</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.13</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,  </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.26</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  scale </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tf.linalg.cholesky(cov)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # ==> [[ 0.6,  0. ,  0. ],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  #      [ 0.2,  0.5,  0. ],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  #      [ 0.1, -0.3,  0.4]])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfd.MultivariateNormalTriL(</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      loc</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>mu,</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      scale_tril</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>scale)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn.mean()</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # ==> [1., 2, 3]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # Covariance agrees with cholesky(cov) parameterization.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn.covariance()</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # ==> [[ 0.36,  0.12,  0.06],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  #      [ 0.12,  0.29, -0.13],</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  #      [ 0.06, -0.13,  0.26]]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # Compute the pdf of an observation in `R^3` ; return a scalar.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn.prob([</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])  </span><span style=color:#6a737d;--shiki-dark:#6A737D># shape: []</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # Initialize a 2-batch of 3-variate Gaussians.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mu </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>11</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>22</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>33</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]]              </span><span style=color:#6a737d;--shiki-dark:#6A737D># shape: [2, 3]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  tril </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> ...</span><span style=color:#6a737d;--shiki-dark:#6A737D>  # shape: [2, 3, 3], lower triangular, non-zero diagonal.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfd.MultivariateNormalTriL(</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      loc</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>mu,</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      scale_tril</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tril)</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # Compute the pdf of two `R^3` observations; return a length-2 vector.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [[</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.9</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>       [</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>9</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]]     </span><span style=color:#6a737d;--shiki-dark:#6A737D># shape: [2, 3]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn.prob(x)           </span><span style=color:#6a737d;--shiki-dark:#6A737D># shape: [2]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # Instantiate a "learnable" MVN.</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  dims </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 4</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  mvn </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfd.MultivariateNormalTriL(</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      loc</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tf.Variable(tf.zeros([dims], </span><span style=color:#e36209;--shiki-dark:#FFAB70>dtype</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tf.float32), </span><span style=color:#e36209;--shiki-dark:#FFAB70>name</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"mu"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      scale_tril</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tfp.util.TransformedVariable(</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          tf.eye(dims, </span><span style=color:#e36209;--shiki-dark:#FFAB70>dtype</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tf.float32),</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>          tfp.bijectors.FillScaleTriL(),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>          name</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"raw_scale_tril"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span></code></pre></div><h1 id=第二句>第二句<a href=#第二句 class=heading-anchor-link aria-label="Link to 第二句"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>在获取了这个分布之后</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>prob  </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfp.distributions.Categorical(</span><span style=color:#e36209;--shiki-dark:#FFAB70>probs</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>prior)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> Categorical</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>distribution</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.</span><span style=color:#6f42c1;--shiki-dark:#B392F0>AutoCompositeTensorDistribution</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  """Categorical distribution over integers.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The Categorical distribution is parameterized by either probabilities or</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  log-probabilities of a set of `K` classes. It is defined over the integers</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  `{0, 1, ..., K-1}`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The Categorical distribution is closely related to the `OneHotCategorical` and</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  `Multinomial` distributions.  The Categorical distribution can be intuited as</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  generating samples according to `argmax{ OneHotCategorical(probs) }` itself</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  being identical to `argmax{ Multinomial(probs, total_count=1) }`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  #### Mathematical Details</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The probability mass function (pmf) is,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  ```none</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  pmf(k; pi) = prod_j pi_j**[k == j]</span></span>
<span class=line></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>Pitfalls</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The number of classes, `K`, must not exceed:</span></span>
<span class=line></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  - the largest integer representable by `self.dtype`, i.e.,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    `2**(mantissa_bits+1)` (IEEE 754),</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  - the maximum `Tensor` index, i.e., `2**31-1`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    In other words,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  ```python</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  K &#x3C;= min(2**31-1, {</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    tf.float16: 2**11,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    tf.float32: 2**24,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    tf.float64: 2**53 }[param.dtype])</span></span>
<span class=line></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  Note: This condition is validated only when `self.validate_args = True`.</span></span></code></pre></div><p>Categorical distribution是一种离散分布</p><p>又要补数学了</p><h2 id=categorical-distribution>Categorical distribution<a href=#categorical-distribution class=heading-anchor-link aria-label="Link to Categorical distribution"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>这里参考<a href=https://zhangzhenhu.github.io/blog/glm/source/%E6%A6%82%E7%8E%87%E5%9F%BA%E7%A1%80/content.html#id17 rel="nofollow noopener noreferrer external" target=_blank>这个</a></p><p>伯努利分布（Bernoulli distribution）是单个随机变量的一种分布，它只有两个可能的取值。</p><p>多努利分布（multinoulli distribution）或者范畴分布（categorical distribution）是单个随机变量的一种分布，它有 k 个可能的取值，不过 k 是有限的。例如人的血型。</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>dist </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> Categorical(</span><span style=color:#e36209;--shiki-dark:#FFAB70>probs</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>n </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1e4</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>empirical_prob </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tf.cast(</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tf.histogram_fixed_width(</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        dist.sample(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>int</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(n)),</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>        nbins</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>      dtype</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tf.float32) </span><span style=color:#d73a49;--shiki-dark:#F97583>/</span><span style=color:#24292e;--shiki-dark:#E1E4E8> n</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # ==> array([ 0.1005,  0.5037,  0.3958], dtype=float32)</span></span></code></pre></div><p>一个例子。</p><p>这里的prior是权重，也就是创建了一个范畴分布，概率是权重。</p><h1 id=第三句>第三句<a href=#第三句 class=heading-anchor-link aria-label="Link to 第三句"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>mix   </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfp.distributions.MixtureSameFamily(prob, dist)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>class</span><span style=color:#6f42c1;--shiki-dark:#B392F0> _MixtureSameFamily</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#6f42c1;--shiki-dark:#B392F0>distribution</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.</span><span style=color:#6f42c1;--shiki-dark:#B392F0>Distribution</span><span style=color:#24292e;--shiki-dark:#E1E4E8>):</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  """Mixture (same-family) distribution.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  The `MixtureSameFamily` distribution implements a (batch of) mixture</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  distribution where all components are from different parameterizations of the</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  same distribution type. It is parameterized by a `Categorical` 'selecting</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  distribution' (over `k` components) and a components distribution, i.e., a</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  `Distribution` with a rightmost batch shape (equal to `[k]`) which indexes</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>  each (batch of) component.</span></span></code></pre></div><p>例子</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> tfd </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfp.distributions</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D> ### Create a mixture of two scalar Gaussians:</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> gm </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tfd.MixtureSameFamily(</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>     mixture_distribution</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tfd.Categorical(</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>         probs</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.7</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]),</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>     components_distribution</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>tfd.Normal(</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>       loc</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>],       </span><span style=color:#6a737d;--shiki-dark:#6A737D># One for each component.</span></span>
<span class=line><span style=color:#e36209;--shiki-dark:#FFAB70>       scale</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))  </span><span style=color:#6a737d;--shiki-dark:#6A737D># And same here.</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> numpy </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>x </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> np.linspace(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>., </span><span style=color:#005cc5;--shiki-dark:#79B8FF>int</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1e4</span><span style=color:#24292e;--shiki-dark:#E1E4E8>), </span><span style=color:#e36209;--shiki-dark:#FFAB70>dtype</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>np.float32)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> matplotlib.pyplot </span><span style=color:#d73a49;--shiki-dark:#F97583>as</span><span style=color:#24292e;--shiki-dark:#E1E4E8> plt</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>plt.plot(x, gm.prob(x))</span><span style=color:#b31d28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic>;</span></span></code></pre></div><figure><img alt=image-20220213174110526 src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewin202202131741558.png><figcaption>image-20220213174110526</figcaption></figure><p>这里的这个prob是pdf pdf是概率密度函数，纵坐标是概率密度，而不是概率，cdf对应的纵坐标才是概率，总的积分面积是1</p><figure><img alt=preview src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/image/gamewin202202131756011.jpeg><figcaption>preview</figcaption></figure><p>对密度函数来说，某点，比如x=1的位置，这个x=1邻域的面积，才是这点的概率，如左图所示。当然，邻域宽度无穷小，所以每一点的概率是0，如果一个区域足够宽，它的概率值就显示出来了。</p><p>这个面积是1这回事我也差点不信，然后手动算了下</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>from</span><span style=color:#24292e;--shiki-dark:#E1E4E8> scipy </span><span style=color:#d73a49;--shiki-dark:#F97583>import</span><span style=color:#24292e;--shiki-dark:#E1E4E8> integrate</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>v, err </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> integrate.quad(gm.prob, </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#005cc5;--shiki-dark:#79B8FF>2</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#005cc5;--shiki-dark:#79B8FF>3</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>print</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(v)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=plaintext style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>0.9999778336488041</span></span></code></pre></div><p>确实是1</p><h1 id=下一句>下一句<a href=#下一句 class=heading-anchor-link aria-label="Link to 下一句"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>likelihood </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> mix.log_prob(y)</span></span></code></pre></div><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>def</span><span style=color:#6f42c1;--shiki-dark:#B392F0> log_prob</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(self, value, name</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'log_prob'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#24292e;--shiki-dark:#E1E4E8>kwargs):</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    """Log probability density/mass function.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    Args:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>      value: `float` or `double` `Tensor`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>      name: Python `str` prepended to names of ops created by this function.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>      **kwargs: Named arguments forwarded to subclass implementation.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    Returns:</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>      log_prob: a `Tensor` of shape `sample_shape(x) + self.batch_shape` with</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>        values of type `self.dtype`.</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF>    """</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>    return</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>._call_log_prob(value, name, </span><span style=color:#d73a49;--shiki-dark:#F97583>**</span><span style=color:#24292e;--shiki-dark:#E1E4E8>kwargs)</span></span></code></pre></div><p>我又不懂了 为啥likelihood是logpdf呢，查了查<a href=https://www.zhihu.com/question/54082000 rel="nofollow noopener noreferrer external" target=_blank>这个</a></p><p>先看似然函数的定义，他是在给定联合样本值X下关于（未知）参数<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>θ</mi></mrow><annotation encoding=application/x-tex>\theta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:.6944em class=strut></span><span style=margin-right:.02778em class="mord mathnormal">θ</span></span></span></span>的函数:</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>L</mi><mo stretchy=false>(</mo><mi>θ</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mi mathvariant=normal>∣</mi><mi>θ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>L(\theta|x)=f(x|\theta)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span class="mord mathnormal">L</span><span class=mopen>(</span><span style=margin-right:.02778em class="mord mathnormal">θ</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span style=margin-right:.2778em class=mspace></span><span class=mrel>=</span><span style=margin-right:.2778em class=mspace></span></span><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span style=margin-right:.10764em class="mord mathnormal">f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mord>∣</span><span style=margin-right:.02778em class="mord mathnormal">θ</span><span class=mclose>)</span></span></span></span></span><p>这里小x是指联合样本随机变量X取到的值，<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>θ</mi></mrow><annotation encoding=application/x-tex>\theta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:.6944em class=strut></span><span style=margin-right:.02778em class="mord mathnormal">θ</span></span></span></span>是指未知参数，它属于参数空间。</p><p>这里<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mi mathvariant=normal>∣</mi><mi>θ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>f(x|\theta)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span style=margin-right:.10764em class="mord mathnormal">f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mord>∣</span><span style=margin-right:.02778em class="mord mathnormal">θ</span><span class=mclose>)</span></span></span></span>是一个密度函数，特别的，他表示给定<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>θ</mi></mrow><annotation encoding=application/x-tex>\theta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:.6944em class=strut></span><span style=margin-right:.02778em class="mord mathnormal">θ</span></span></span></span>下关于样本联合值x的联合密度函数。</p><p>所以从定义上，似然函数和密度函数是完全不同的两个<strong>数学对象</strong>：前者是关于<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta">的函数，后者是关于<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7Bx%7D">的函数。所以这里的等号<img alt=[公式] src="https://www.zhihu.com/equation?tex=%3D"> 理解为<strong>函数值形式</strong>的相等，而不是两个函数本身是同一函数(根据函数相等的定义，函数相等当且仅当定义域相等并且对应关系相等)。</p><p>两者的联系则是</p><p>（1）如果<strong>x</strong>是离散的随机向量，那么其<strong>概率</strong>密度函数<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mi mathvariant=normal>∣</mi><mi>θ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>f(x|\theta)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span style=margin-right:.10764em class="mord mathnormal">f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mord>∣</span><span style=margin-right:.02778em class="mord mathnormal">θ</span><span class=mclose>)</span></span></span></span>可改写为<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mi>x</mi><mi mathvariant=normal>∣</mi><mi>θ</mi><mo stretchy=false>)</mo><mo>=</mo><msub><mi>P</mi><mi>θ</mi></msub><mo stretchy=false>(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>f(x|\theta)=P_{\theta}(X=x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span style=margin-right:.10764em class="mord mathnormal">f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mord>∣</span><span style=margin-right:.02778em class="mord mathnormal">θ</span><span class=mclose>)</span><span style=margin-right:.2778em class=mspace></span><span class=mrel>=</span><span style=margin-right:.2778em class=mspace></span></span><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span class=mord><span style=margin-right:.13889em class="mord mathnormal">P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span style=height:.3361em class=vlist><span style=top:-2.55em;margin-left:-.1389em;margin-right:.05em><span style=height:2.7em class=pstrut></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span style=margin-right:.02778em class="mord mathnormal mtight">θ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span style=height:.15em class=vlist><span></span></span></span></span></span></span><span class=mopen>(</span><span style=margin-right:.07847em class="mord mathnormal">X</span><span style=margin-right:.2778em class=mspace></span><span class=mrel>=</span><span style=margin-right:.2778em class=mspace></span></span><span class=base><span style=height:1em;vertical-align:-.25em class=strut></span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span>，即代表了在参数<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>θ</mi></mrow><annotation encoding=application/x-tex>\theta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span style=height:.6944em class=strut></span><span style=margin-right:.02778em class="mord mathnormal">θ</span></span></span></span>下随机向量<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7BX%7D">取到值<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7Bx%7D">的<strong>可能性</strong>；并且，<strong>如果</strong>我们发现</p><figure><img alt=[公式] src="https://www.zhihu.com/equation?tex=L(%5Ctheta_1+%7C+%5Ctextbf%7Bx%7D+)+%3D+%5Cmathbb%7BP%7D_%7B%5Ctheta_1%7D(%5Ctextbf%7BX%7D+%3D+%5Ctextbf%7Bx%7D)+%3E+%5Cmathbb%7BP%7D_%7B%5Ctheta_2%7D(%5Ctextbf%7BX%7D+%3D+%5Ctextbf%7Bx%7D)+%3D+L(%5Ctheta_2+%7C+%5Ctextbf%7Bx%7D)"><figcaption>[公式]</figcaption></figure><p>那么<strong>似然</strong>函数就反应出这样一个<strong>朴素推测</strong>：在参数<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta_1">下随机向量<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7BX%7D">取到值<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7Bx%7D">的<strong>可能性大于</strong> 在参数<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta_2">下随机向量<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7BX%7D">取到值<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7Bx%7D">的<strong>可能性</strong>。换句话说，我们更有理由相信(相对于<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta_2">来说)<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta_1"></p><p><strong>更有可能</strong>是真实值。这里的可能性由概率来刻画。</p><p>（2）如果<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7BX%7D">是连续的随机向量，那么其密度函数<img alt=[公式] src="https://www.zhihu.com/equation?tex=+f(%5Ctextbf%7Bx%7D+%7C+%5Ctheta)">本身（如果在<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7Bx%7D">连续的话）在<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7Bx%7D">处的<strong>概率</strong>为0，为了方便考虑一维情况：给定一个充分小<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Cepsilon+%3E+0">，那么随机变量<img alt=[公式] src="https://www.zhihu.com/equation?tex=X">取值在<img alt=[公式] src="https://www.zhihu.com/equation?tex=(x+-+%5Cepsilon%2C+x+%2B+%5Cepsilon)">区间内的<strong>概率</strong>即为</p><figure><img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BP%7D_%5Ctheta(x+-+%5Cepsilon+%3C+X+%3C+x+%2B+%5Cepsilon)+%3D+%5Cint_%7Bx+-+%5Cepsilon%7D%5E%7Bx+%2B+%5Cepsilon%7D+f(x+%7C+%5Ctheta)+dx+%5Capprox+2+%5Cepsilon+f(x+%7C+%5Ctheta)+%3D+2+%5Cepsilon+L(%5Ctheta+%7C+x)"><figcaption>[公式]</figcaption></figure><p>并且两个未知参数的情况下做比就能约掉<img alt=[公式] src="https://www.zhihu.com/equation?tex=2%5Cepsilon">，所以和离散情况下的理解一致，只是此时<strong>似然</strong>所表达的那种<strong>可能性</strong>和<strong>概率</strong><img alt=[公式] src="https://www.zhihu.com/equation?tex=f(x%7C%5Ctheta)+%3D+0">无关。</p><p>综上，<strong>概率</strong>(密度)表达给定<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta">下样本随机向量<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7BX%7D+%3D+%5Ctextbf%7Bx%7D">的<strong>可能性</strong>，而<strong>似然</strong>表达了给定样本<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctextbf%7BX%7D+%3D+%5Ctextbf%7Bx%7D">下参数<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta_1">(相对于另外的参数<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta_2">)为真实值的<strong>可能性</strong>。我们总是对随机变量的取值谈<strong>概率</strong>，而在非贝叶斯统计的角度下，参数是一个实数而非随机变量，所以我们一般不谈一个参数的<strong>概率</strong>。</p><p>最后我们再回到<img alt=[公式] src="https://www.zhihu.com/equation?tex=L(%5Ctheta+%7C+%5Ctextbf%7Bx%7D)+%3D+f(%5Ctextbf%7Bx%7D+%7C+%5Ctheta)">这个表达。首先我们严格记号，竖线<img alt=[公式] src="https://www.zhihu.com/equation?tex=%7C">表示条件概率)或者条件分布，分号<img alt=[公式] src="https://www.zhihu.com/equation?tex=%3B">表示把参数隔开。所以这个式子的严格书写方式是<img alt=[公式] src="https://www.zhihu.com/equation?tex=L(%5Ctheta+%7C+%5Ctextbf%7Bx%7D)+%3D+f(%5Ctextbf%7Bx%7D+%3B+%5Ctheta)">因为<img alt=[公式] src="https://www.zhihu.com/equation?tex=%5Ctheta">在右端只当作参数理解。</p><p>我没有看懂，说实话，先放这里吧</p><p>一些参考</p><p><a href=https://github.com/tensorflow/probability/blob/main/tensorflow_probability/python/distributions/mixture_same_family.py rel="nofollow noopener noreferrer external" target=_blank>https://github.com/tensorflow/probability/blob/main/tensorflow_probability/python/distributions/mixture_same_family.py</a></p><p><a href=https://lulaoshi.info/machine-learning/linear-model/maximum-likelihood-estimation rel="nofollow noopener noreferrer external" target=_blank>https://lulaoshi.info/machine-learning/linear-model/maximum-likelihood-estimation</a></p><p><a href=https://zhangzhenhu.github.io/blog/glm/source/%E6%A6%82%E7%8E%87%E5%9F%BA%E7%A1%80/content.html#id17 rel="nofollow noopener noreferrer external" target=_blank>https://zhangzhenhu.github.io/blog/glm/source/%E6%A6%82%E7%8E%87%E5%9F%BA%E7%A1%80/content.html#id17</a></p><h1 id=最后一句>最后一句<a href=#最后一句 class=heading-anchor-link aria-label="Link to 最后一句"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>tf.reduce_mean(</span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>likelihood) </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> tf.add_n([</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.] </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#005cc5;--shiki-dark:#79B8FF> self</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.model.losses)</span></span></code></pre></div><p>tf.reduce_mean是计算likelihood的平均值。</p><p>tf.add_n([p1, p2, p3…])函数是实现一个列表的元素的相加。就是输入的对象是一个列表，列表里的元素可以是向量，矩阵，等</p><p>self.model.losses 这个我就真的不是特别懂了，除了这里之外没找到有别的地方用过这个</p><h1 id=跑个debug康康>跑个debug康康<a href=#跑个debug康康 class=heading-anchor-link aria-label="Link to 跑个debug康康"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>我好像没有看到这个函数被调用</p><h2 id=mdn代码解析>MDN代码解析<a href=#mdn代码解析 class=heading-anchor-link aria-label="Link to MDN代码解析"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>默认模型参数为</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=python style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>param</span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8>{</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'LOO_CV'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'align'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'animate'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'avg_est'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'batch'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>128</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'benchmark'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'darktheme'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'data_loc'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'D:/Data/Insitu'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'dataset'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'all'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'epsilon'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.001</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8> </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'filename'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>,</span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'imputations'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'l2'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.001</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'lr'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0.001</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'model_lbl'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>''</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'model_loc'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Weights'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'n_hidden'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>100</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'n_iter'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10000</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'n_layers'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'n_mix'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>5</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'n_redraws'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>50</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'n_rounds'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>10</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'no_bagging'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'no_load'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'no_save'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'plot_loss'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span><span style=color:#032f62;--shiki-dark:#9ECBFF>'product'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'chl'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'sat_bands'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'save_data'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'save_stats'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'seed'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>42</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'sensor'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'sgli'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'silent'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'sim_loc'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'D:/Data/Simulated'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'subset'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF>''</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'threshold'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>None</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_all_ratio'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_auc'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_boosting'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_excl_Rrs'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_kbest'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_noise'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_ratio'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_sim'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'use_tchlfix'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>, </span></span>
<span class=line><span style=color:#032f62;--shiki-dark:#9ECBFF> 'verbose'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>:</span><span style=color:#005cc5;--shiki-dark:#79B8FF>False</span><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span></code></pre></div><p>里面有这么几个参数之前没了解过</p><p>batch是指从全部样本里取的一批数据。</p><p>神经网络这种通常要求大数据量的模型，把所有数据同时扔进模型里训练，计算量太大，内存会爆</p><p>一个样本跑一次的话，训练速度又太慢</p><p>所以一般找一个合适大小的样本量，可以并行计算加快训练速度，一次跑的数据量又不会过大</p><p>imputations是数据插补</p><p>‘l2’</p><div></div>.001, ‘lr’<div></div>.001,不解释了<p></p><p>剩下的都差不多</p><p>还是有一些写代码的细节，自己需要再开一篇</p><p>自己写代码的功底真的好差</p><div id=post-copyright></div><div class="mt-12.6 uno-decorative-line"></div><div class="flex flex-wrap gap-x-3 gap-y-3.2 no-heti"><a href=/tags/机器学习/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">机器学习 </span><span class="inline-block font-medium opacity-0" aria-hidden=true>机器学习 </span></a><a href=/tags/Inversion/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Inversion </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Inversion </span></a><a href="/tags/Deep Learning/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Deep Learning </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Deep Learning </span></a><a href=/tags/tensorflow/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">tensorflow </span><span class="inline-block font-medium opacity-0" aria-hidden=true>tensorflow</span></a></div></div></article></main><footer class="leading-1.25em font-navbar lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=/atom.xml/ class="hover:c-primary highlight-hover after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>RSS</a>&nbsp;/ <a href=https://github.com/lifeodyssey class="hover:c-primary highlight-hover after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:email@radishzz.cc class="hover:c-primary highlight-hover after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;</p><p>© 2025-2026 周大侠</p><p>Powered by <a href=https://astro.build/ class="hover:c-primary highlight-hover after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="hover:c-primary highlight-hover after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><div class="flex absolute gap-6 lg:bottom-[min(10.27rem+1.92vw,12rem)] lg:fixed lg:right-[max(5rem,calc(50vw-35rem))] lg:top-auto lg:w-14rem min-[823px]:max-lg:right-[calc(50vw-22rem)] right-7.25vw top-14.6"><a href=/posts/62469dc9.html.html/ class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" aria-label="Switch website language" id=language-switcher><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M19.18 21.1 12.4 1.89h-1.21L4.52 21.1l-2.53.2v.81h6.37v-.81l-2.83-.2 2.02-5.97h7.58l2.02 5.97-3.34.2v.81H22v-.81l-2.83-.2zM7.85 14.33l3.44-10.21 3.54 10.21z"/></svg> </a><button aria-label="Switch light/dark theme" class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" id=theme-toggle-button><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M12.06.61C5.66.61.46 5.71.46 12.11s5.1 11.5 11.6 11.5 11.5-5.1 11.5-11.5S18.46.61 12.06.61m0 21c-6.07 0-10.94-4.2-10.94-9.5s4.87-9.4 10.94-9.4S23 6.91 23 12.21s-4.88 9.4-10.94 9.4"/></svg></button></div><script>!function(){const e="oklch(96% 0.005 298)",t="oklch(22% 0.005 298)";function n(n){document.documentElement.classList.toggle("dark",n);const o=document.head.querySelector('meta[name="theme-color"]');o&&e&&t&&o.setAttribute("content",n?t:e),localStorage.setItem("theme",n?"dark":"light"),document.dispatchEvent(new Event("theme-changed"))}function o(){n(!document.documentElement.classList.contains("dark"))}document.addEventListener("click",(function(e){const t=e.target instanceof Element?e.target:null,n=t?.closest("#theme-toggle-button");if(!n)return;if(document.documentElement.classList.contains("reduce-motion"))return void o();document.documentElement.style.setProperty("view-transition-name","animation-theme-toggle"),document.documentElement.setAttribute("data-theme-changing",""),document.startViewTransition(o).finished.then((()=>{document.documentElement.style.removeProperty("view-transition-name"),document.documentElement.removeAttribute("data-theme-changing")}))}),{passive:!0}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{n(e.matches)}))}()</script><script type=module>const o={click:"tap",typing:"type"},l={[o.click]:.8,[o.typing]:.4},d=["#language-switcher","#theme-toggle-button"],f=[".el-input__inner",".el-textarea__inner","#wl-nick","#wl-mail","#wl-link","#wl-edit"],h=new Set(["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"]),p=d.join(","),g=f.join(",");function r(){return window.matchMedia("(max-width: 1023px)").matches}function w(){return document.head.querySelector('link[rel="sitemap"]')?.getAttribute("href")?.replace("/sitemap-index.xml","")||""}class y{audioContext=null;audioBuffers={[o.click]:[],[o.typing]:[]};initPromise=null;async fetchAndCacheSound(t,e){if(!this.audioContext)throw new Error("Audio context not initialized");const n=`${t}_0${e+1}`,i=await(await fetch(`${w()}/sounds/${n}.wav`)).arrayBuffer(),a=await this.audioContext.decodeAudioData(i);this.audioBuffers[t].push(a)}async preloadAllSounds(){const t=Object.values(o).flatMap((t=>Array.from({length:5},((e,n)=>this.fetchAndCacheSound(t,n)))));await Promise.allSettled(t)}async initialize(){return this.initPromise??=(async()=>{const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,await this.preloadAllSounds()})()}async playSound(t){try{if(await this.initialize(),!this.audioContext)return;"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=this.audioBuffers[t];if(0===e.length)return;const n=this.audioContext.createBufferSource();n.buffer=e[Math.floor(Math.random()*e.length)];const i=this.audioContext.createGain();i.gain.value=l[t],n.connect(i).connect(this.audioContext.destination),n.start(0)}catch(t){console.warn("Sound playback failed:",t)}}}const c=new y;function m(t){r()||!t.target?.closest(p)||c.playSound(o.click)}function x(t){r()||t.ctrlKey||t.altKey||t.metaKey||h.has(t.key)||!t.target?.closest(g)||c.playSound(o.typing)}document.addEventListener("click",m,{passive:!0}),document.addEventListener("keydown",x,{passive:!0})</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},o=new WeakMap;function r(){const e=document.querySelectorAll(".code-copy-button");0!==e.length&&e.forEach((e=>{e.innerHTML=s.copy}))}async function a(e){if(e.classList.contains("copy-success"))return;const t=e.parentElement?.querySelector("pre code"),n=t?.textContent??"";if(t&&n)try{await navigator.clipboard.writeText(n);const t=o.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const c=setTimeout((()=>{e.isConnected&&(e.innerHTML=s.copy,e.classList.remove("copy-success"),o.delete(e))}),1500);o.set(e,c)}catch(e){console.error("Failed to copy code",e)}}function l(e){const t=e.target instanceof Element&&e.target.closest(".code-copy-button");t&&a(t)}document.addEventListener("astro:page-load",r),document.addEventListener("click",l,{passive:!0}),r()</script><script type=module>async function p(t){const e=t.dataset.repo;if(!e)return;const o=t.getElementsByClassName("gc-owner-avatar")[0],n=t.getElementsByClassName("gc-repo-description")[0],s=t.getElementsByClassName("gc-stars-count")[0],a=t.getElementsByClassName("gc-forks-count")[0],r=t.getElementsByClassName("gc-license-info")[0];function c(t){const e=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1});o&&t.owner?.avatar_url&&(o.style.backgroundImage=`url(${t.owner.avatar_url})`),n&&(n.textContent=t.description??"No description"),s&&(s.textContent=e.format(t.stargazers_count??0)),a&&(a.textContent=e.format(t.forks_count??0)),r&&(r.textContent=t.license?.spdx_id??"No License")}const i=`github-repo-${e}`,m=sessionStorage.getItem(i);if(m){c(JSON.parse(m))}else try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok){if(n){const e=404===t.status?"Repository not found":"Failed to load repository data";n.textContent=e}return}const o=await t.json();sessionStorage.setItem(i,JSON.stringify(o)),c(o)}catch(t){console.error(`Failed to fetch ${e}:`,t)}}function f(){const t=document.getElementsByClassName("gc-container");0!==t.length&&Array.from(t).forEach((t=>{p(t)}))}document.addEventListener("astro:page-load",f),f()</script><script type=module src=/_astro/MediaEmbed.astro_astro_type_script_index_0_lang.wKrCMCCr.js></script><script type=module>const n={overlay:document.querySelector(".zoom-overlay"),zoomedImg:null,originalImg:null,createOverlay(){this.overlay&&this.overlay.isConnected||(this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-label","Image Viewer"),this.overlay.setAttribute("tabindex","-1"),Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",backgroundColor:"oklch(var(--un-preset-theme-colors-background) / 0.95)",opacity:"0",transition:"opacity 300ms cubic-bezier(0.4, 0, 0.2, 1)",cursor:"zoom-out",display:"none"}),document.body.appendChild(this.overlay))},zoomImg(e){if(!this.overlay)return;document.body.style.overflow="hidden";const t=e.getBoundingClientRect();this.originalImg=e,this.zoomedImg=e.cloneNode(),Object.assign(this.zoomedImg.style,{position:"fixed",top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",zIndex:"1000",cursor:"zoom-out"}),document.body.appendChild(this.zoomedImg),this.overlay.style.display="block",this.overlay.focus();const o=window.innerWidth,i=window.innerHeight,s=window.innerWidth<768?1:.8,l=Math.min(o*s/t.width,i*s/t.height),a=(-t.left+(o-t.width)/2)/l,n=(-t.top+(i-t.height)/2)/l;requestAnimationFrame((()=>{this.overlay&&(this.overlay.style.opacity="1"),this.zoomedImg&&(this.zoomedImg.style.transform=`scale(${l}) translate3d(${a}px, ${n}px, 0)`)}))},close(){!this.overlay||!this.zoomedImg||!this.originalImg||(this.zoomedImg.style.transform="",this.overlay.style.opacity="0",document.body.style.overflow="",setTimeout((()=>{this.zoomedImg&&this.zoomedImg.parentNode&&document.body.removeChild(this.zoomedImg),this.zoomedImg=null,this.overlay&&(this.overlay.style.display="none"),this.originalImg&&this.originalImg.focus(),this.originalImg=null}),300))},setupOverlay(){this.createOverlay(),this.zoomedImg=null,this.originalImg=null},handleClick(e){if(this.zoomedImg)return void this.close();const t=e.target;t instanceof HTMLImageElement&&t.complete&&t.naturalWidth>=100&&t.naturalHeight>=100&&this.zoomImg(t)},handleResize(){this.zoomedImg&&this.close()},init(){this.createOverlay(),document.addEventListener("astro:page-load",(()=>this.setupOverlay())),document.addEventListener("click",(e=>this.handleClick(e)),{passive:!0}),window.addEventListener("resize",(()=>this.handleResize()),{passive:!0})}};n.init()</script></body></html>
<!DOCTYPE html><html class="font-sans scroll-smooth" lang=zh-CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/favicon.svg rel=icon type=image/svg+xml><title>ç ´è§£ AWS Inspector ä¸ ECR çš„éšè—å…³è”ï¼šè§£å†³ Terraform ç®¡ç†çš„å¾ªç¯å›°å¢ƒ | ä¹”å…‹å”å”çš„åºŠè¾¹æ•…äº‹</title><meta content="æœ€è¿‘åœ¨è®¾ç½®AWS Inspectorçš„æ—¶å€™å‘ç°çš„ä¸€ä¸ªç¥å¥‡å¾ªç¯ã€‚ï¼ˆæ–‡ç« å†™äº2025å¹´3.13ï¼Œåç»­awså¯èƒ½æœ‰æ›´æ–°ï¼‰ AWS Inspectoræ˜¯AWSæ¨å‡ºçš„ä¸€ä¸ªä¾èµ–åŒ…æ¼æ´æ‰«æçš„æœåŠ¡ï¼Œæ‰«æçš„å¯¹è±¡åŒ…æ‹¬lambda, EC2å’ŒECR Image..." name=description><meta content=å‘¨å¤§ä¾  name=author><meta content="Astro v5.13.7" name=generator><meta content="oklch(96% 0.005 298)" name=theme-color><link href=/fonts/EarlySummer-VF-Split/EarlySummer-VF-Subset.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Black-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Snell-Bold-SF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/STIX-Italic-VF.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=https://lifeodyssey.github.io/posts/ca51402d.html.html rel=canonical><link href=/sitemap-index.xml rel=sitemap><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=https://lifeodyssey.github.io rel=alternate hreflang=zh><link href=https://lifeodyssey.github.io/en/ rel=alternate hreflang=en><link href=https://lifeodyssey.github.io/ja/ rel=alternate hreflang=ja><meta content=article property=og:type><meta content=https://lifeodyssey.github.io/posts/ca51402d.html.html property=og:url><meta content="ç ´è§£ AWS Inspector ä¸ ECR çš„éšè—å…³è”ï¼šè§£å†³ Terraform ç®¡ç†çš„å¾ªç¯å›°å¢ƒ | ä¹”å…‹å”å”çš„åºŠè¾¹æ•…äº‹" property=og:title><meta content="æœ€è¿‘åœ¨è®¾ç½®AWS Inspectorçš„æ—¶å€™å‘ç°çš„ä¸€ä¸ªç¥å¥‡å¾ªç¯ã€‚ï¼ˆæ–‡ç« å†™äº2025å¹´3.13ï¼Œåç»­awså¯èƒ½æœ‰æ›´æ–°ï¼‰ AWS Inspectoræ˜¯AWSæ¨å‡ºçš„ä¸€ä¸ªä¾èµ–åŒ…æ¼æ´æ‰«æçš„æœåŠ¡ï¼Œæ‰«æçš„å¯¹è±¡åŒ…æ‹¬lambda, EC2å’ŒECR Image..." property=og:description><meta content=https://lifeodyssey.github.io/og/ca51402d.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.1k2cUud7.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!!e&&"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n&&n.setAttribute("content",t?"oklch(22% 0.005 298)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t)}document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),e(),t()}()</script><link href=/_astro/_about_.Dzb1Me_E.css rel=stylesheet><link href=/_astro/_posts_slug_.CM85RmC-.css rel=stylesheet><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const tp={preserveBehavior:!1},ep=t=>{if("string"==typeof t)return[t,tp];const[e,n=tp]=t;return[e,{...tp,...n}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,e,r,o,i,a,s,c,d,p,l=t,u){function f(){u||(u=1,"/"==(s=(a.lib||"/~partytown/")+(a.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),o!=t?o.dispatchEvent(new CustomEvent("pt1",{detail:t})):(c=setTimeout(w,(null==a?void 0:a.fallbackTimeout)||1e4),e.addEventListener("pt0",h),i?y(1):r.serviceWorker?r.serviceWorker.register(s+(a.swPath||"partytown-sw.js"),{scope:s}).then((function(t){t.active?y():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&y()}))}),console.error):w())))}function y(n){p=e.createElement(n?"script":"iframe"),t._pttab=Date.now(),n||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=s+"partytown-"+(n?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),e.querySelector(a.sandboxParent||"body").appendChild(p)}function w(n,r){for(h(),o==t&&(a.forward||[]).map((function(e){const[n]=ep(e);delete t[n.split(".")[0]]})),n=0;n<d.length;n++)(r=e.createElement("script")).innerHTML=d[n].innerHTML,r.nonce=a.nonce,e.head.appendChild(r);p&&p.parentNode.removeChild(p)}function h(){clearTimeout(c)}a=t.partytown||{},o==t&&(a.forward||[]).map((function(e){const[r,{preserveBehavior:o}]=ep(e);l=t,r.split(".").map((function(e,r,i){var a;l=l[i[r]]=r+1<i.length?l[i[r]]||(a=i[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(o){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,i);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(i,arguments),n}})()}))})),"complete"==e.readyState?f():(t.addEventListener("DOMContentLoaded",f),t.addEventListener("load",f))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-ca51402d-zh}@layer astro{::view-transition-old(post-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-ca51402d-zh}@layer astro{::view-transition-old(time-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-ca51402d-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-wif6pdce-3]{view-transition-name:site-title-zh}@layer astro{::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(site-title-zh){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-wif6pdce-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-wif6pdce-3]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><body><div class="w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><header class="cjk:tracking-0.02em lg:uno-desktop-column lg:top-20 mb-10.8"><h2 class="c-secondary font-bold font-title lg:c-primary lg:mb-1.8 lg:mt-0 lg:text-9 mb-2.8 mt-3 text-5.375"><div class="inline-block box-content pr-1" data-astro-transition-scope=astro-wif6pdce-3 data-disable-theme-transition><a href=/ id=site-title-link>ä¹”å…‹å”å”çš„åºŠè¾¹æ•…äº‹</a></div></h2></header><nav aria-label="Site Navigation" class="hidden cjk:tracking-0.02em font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,12.5rem)] lg:text-4 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">æ–‡ç« </a></li><li><a href=/tags/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">æ ‡ç­¾</a></li><li><a href=/about/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">å…³äº</a></li><li><a href=/search/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Search</a></li></ul></nav><main class=mb-10><article class=heti><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function e(t){if(!(t.target instanceof Element?t.target:null)?.closest("#back-button"))return;if(window.history.length>1)return void window.history.back();const e=document.getElementById("site-title-link");e&&e.click()}document.addEventListener("click",e,{passive:!0})</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>ç ´è§£ AWS Inspector ä¸ ECR çš„éšè—å…³è”ï¼šè§£å†³ Terraform ç®¡ç†çš„å¾ªç¯å›°å¢ƒ</span></h1></div><div class="c-primary block font-time mb-17.2" data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition id=post-date><time datetime=2025-03-13>2025-03-13 </time><span class=ml-1.75>15 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="w-full h-12 relative" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>ç›®å½•</span><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24" class="ml-4 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center aspect-square hidden w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#1ç¥å¥‡çš„apiä¸ç•Œé¢ä¸åŒ¹é… class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>1.ç¥å¥‡çš„APIä¸ç•Œé¢ä¸åŒ¹é…</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#2inspectorä¸ecrçš„å…³è” class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>2.Inspectorä¸ECRçš„å…³è”</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#3-åˆ©ç”¨terraformæ—¶çš„ç¥å¥‡å¾ªç¯ class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>3. åˆ©ç”¨Terraformæ—¶çš„ç¥å¥‡å¾ªç¯</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#mermaid-å›¾å±•ç¤º-terraform-å‘¨æœŸè¡Œä¸º class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>Mermaid å›¾å±•ç¤º Terraform å‘¨æœŸè¡Œä¸º</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#4-potential-reason class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>4. Potential Reason</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#éªŒè¯æ‰‹åŠ¨é‡ç°å¾ªç¯ class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>éªŒè¯ï¼šæ‰‹åŠ¨é‡ç°å¾ªç¯</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#5-solution class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>5. solution</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜åŠ¿ class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜åŠ¿</a></li><li class=ml-4 data-astro-cid-v5otsao3><a href=#å®é™…åº”ç”¨æ•ˆæœ class="highlight-hover no-heti toc-links-h3" data-astro-cid-v5otsao3>å®é™…åº”ç”¨æ•ˆæœ</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#6-sum-up class="highlight-hover no-heti toc-links-h2" data-astro-cid-v5otsao3>6. Sum up</a></li></ul></nav></div></div><script type=module>let s=null,i=null;function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",c=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&c.set(e,t)}));let r=null;function l(t){t!==r&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),r=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}s=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=c.get(e);t&&l(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]}),Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>s?.observe(t)));const a=document.getElementById("post-copyright");a&&(i=new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),r=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}),i?.observe(a),n.length>0&&l(n[0]))}function m(){s?.disconnect(),i?.disconnect(),s=null,i=null}document.addEventListener("astro:after-swap",g),document.addEventListener("astro:before-swap",m),g()</script><div id=post-content><p>æœ€è¿‘åœ¨è®¾ç½®AWS Inspectorçš„æ—¶å€™å‘ç°çš„ä¸€ä¸ªç¥å¥‡å¾ªç¯ã€‚</p><p>ï¼ˆæ–‡ç« å†™äº2025å¹´3.13ï¼Œåç»­awså¯èƒ½æœ‰æ›´æ–°ï¼‰</p><h1 id=aws-inspectoråŠä¸šåŠ¡éœ€æ±‚ä»‹ç»>AWS InspectoråŠä¸šåŠ¡éœ€æ±‚ä»‹ç»<a href=#aws-inspectoråŠä¸šåŠ¡éœ€æ±‚ä»‹ç» class=heading-anchor-link aria-label="Link to AWS InspectoråŠä¸šåŠ¡éœ€æ±‚ä»‹ç»"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h1><p>AWS Inspectoræ˜¯AWSæ¨å‡ºçš„ä¸€ä¸ªä¾èµ–åŒ…æ¼æ´æ‰«æçš„æœåŠ¡ï¼Œæ‰«æçš„å¯¹è±¡åŒ…æ‹¬lambda, EC2å’ŒECR Imageã€‚å®˜æ–¹ä»‹ç»çš„å–ç‚¹ä¹‹ä¸€æ˜¯ä»–æœ‰è‡ªå·±çš„ä¸€ä¸ªæ¼æ´æ•°æ®åº“ï¼Œå¦‚æœä½ æŠŠscançš„é¢‘ç‡è®¾ç½®ä¸ºâ€CONTINUOUS_SCANâ€ï¼Œæ¯å½“æœ‰æ–°çš„æ¼æ´å‘å¸ƒæ—¶ï¼Œå°±ä¼šå¯¹å·²ç»æ‰«æè¿‡çš„imageå†è¿›è¡Œä¸€æ¬¡æ‰«æï¼Œè€Œä¸æ˜¯åªåœ¨æŠŠimageæ¨åˆ°ecræ—¶è¿›è¡Œä¸€æ¬¡æ‰«æã€‚</p><p>å¯¹äºimageï¼Œå®˜æ–¹å®šä»·æ˜¯initial scan 0.9åˆ€ä¸€æ¬¡ï¼Œrescan0.1åˆ€ä¸€æ¬¡ã€‚å¬èµ·æ¥å¾ˆä¸é”™æ˜¯ä¸æ˜¯ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºè¿™ä¸ªrescançš„é¢‘ç‡æ˜¯æ— æ³•è¿›è¡Œæ“æ§çš„ï¼Œæ¯”å¦‚ä½ çš„ä¸€ä¸ªimageæœ‰100ä¸ªä¾èµ–ï¼Œæ¯ä¸ªä¾èµ–ä¸€å¤©å‘ä¸€æ¬¡æ¼æ´æ›´æ–°ï¼Œé‚£ä¹ˆè¿™ä¸€å¤©ä¸€ä¸ªimageå°±è¦èŠ±10åˆ€ã€‚ä»¥æˆ‘è‡ªå·±çš„ECRä¸ºä¾‹ï¼Œ45ä¸ªimageï¼Œinspectorç»™æˆ‘ä¼°è®¡çš„æ¯æœˆè¦åœ¨è¿™ä¸Šé¢èŠ±çš„é’±å¤§æ¦‚è¦240å¤šåˆ€ã€‚è¿™æ˜¯ä¸å¯æ¥å—çš„ï¼Œäºæ˜¯å°±åœ¨æ¢ç´¢å¦‚ä½•æ‰èƒ½æ§åˆ¶aws inspectorçš„è¡Œä¸ºã€‚</p><h2 id=1ç¥å¥‡çš„apiä¸ç•Œé¢ä¸åŒ¹é…>1.ç¥å¥‡çš„APIä¸ç•Œé¢ä¸åŒ¹é…<a href=#1ç¥å¥‡çš„apiä¸ç•Œé¢ä¸åŒ¹é… class=heading-anchor-link aria-label="Link to 1.ç¥å¥‡çš„APIä¸ç•Œé¢ä¸åŒ¹é…"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>å…ˆå»æŸ¥çœ‹äº†[Terraformçš„æ–‡æ¡£](<a href=https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_registry_scanning_configuration rel="nofollow noopener noreferrer external" target=_blank>Terraform Registry</a>) <img alt="" src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/20250313150745.png></p><p>ä¸<a href=https://docs.aws.amazon.com/ja_jp/AmazonECR/latest/APIReference/API_RepositoryScanningConfiguration.html rel="nofollow noopener noreferrer external" target=_blank>AWSæ–‡æ¡£</a></p><p><img alt="" src=https://raw.githubusercontent.com/lifeodyssey/Figurebed/master/202503131509510.png></p><p>è¿™é‡Œéƒ½æœ‰manualè¿™ä¸ªé€‰é¡¹ï¼Œä½†æ˜¯åœ¨consolesä¸Šéƒ½çœ‹ä¸åˆ°æœ‰å“ªé‡Œèƒ½manualè§¦å‘ã€‚</p><p>æ€€ç€è¿™ä¸ªç–‘é—®ï¼Œæˆ‘å¼€å§‹å°è¯•åœ¨ç½‘é¡µä¸Šç†è§£Inspectorå’ŒECRçš„è¡Œä¸º</p><h2 id=2inspectorä¸ecrçš„å…³è”>2.Inspectorä¸ECRçš„å…³è”<a href=#2inspectorä¸ecrçš„å…³è” class=heading-anchor-link aria-label="Link to 2.Inspectorä¸ECRçš„å…³è”"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><pre class=mermaid>flowchart TD
    A[å¼€å§‹] --> B[ç›´æ¥æ¿€æ´»AWS Inspector]
    B --> C[Inspectorè‡ªåŠ¨é…ç½®]
    C --> D[æ‰«ææ‰€æœ‰èµ„æº]
    D --> E1[æ‰«æECRé•œåƒ]
    D --> E2[æ‰«æEC2å®ä¾‹]
    D --> E3[æ‰«æLambdaå‡½æ•°]
    E1 --> F[ç»“æŸï¼šå…¨é¢çš„å®‰å…¨æ‰«æè¦†ç›–]
    E2 --> F
    E3 --> F
</pre><p><strong>åœºæ™¯1åˆ†æ</strong>ï¼šå½“æˆ‘åœ¨AWSæ§åˆ¶å°ä¸­ç›´æ¥æ¿€æ´»InspectoræœåŠ¡æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨é…ç½®ä¸ºæ‰«ææ‰€æœ‰æ”¯æŒçš„èµ„æºç±»å‹ã€‚è¿™åŒ…æ‹¬ECRä¸­çš„å®¹å™¨é•œåƒã€EC2å®ä¾‹ä»¥åŠLambdaå‡½æ•°ã€‚è¿™æ˜¯æœ€ç›´æ¥çš„é…ç½®æ–¹å¼ï¼Œæä¾›äº†å…¨é¢çš„å®‰å…¨è¦†ç›–ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„æ‰«ææˆæœ¬ã€‚</p><pre class=mermaid>flowchart TD
    A[å¼€å§‹] --> B[åœç”¨AWS Inspector]
    B --> C[åœ¨ECRä¸­å¯ç”¨å¢å¼ºæ‰«æ]
    C --> D[Inspectorè‡ªåŠ¨åˆ›å»º]
    D --> E[ä»…æ‰«æECRé•œåƒ]
    E --> F[ç»“æŸï¼šä»…ECRé•œåƒè¢«æ‰«æ]
</pre><p><strong>åœºæ™¯2åˆ†æ</strong>ï¼šæœ‰è¶£çš„æ˜¯ï¼Œå¦‚æœæˆ‘å…ˆåœç”¨InspectoræœåŠ¡ï¼Œç„¶ååœ¨ECRé…ç½®ä¸­å¯ç”¨å¢å¼ºæ‰«æ(Enhanced Scan)ï¼ŒAWSä¼šè‡ªåŠ¨åˆ›å»ºInspectoræœåŠ¡å®ä¾‹ï¼Œä½†å®ƒåªé…ç½®ä¸ºæ‰«æECRé•œåƒï¼Œè€Œä¸åŒ…æ‹¬EC2æˆ–Lambdaã€‚è¿™ç§è¡Œä¸ºè¡¨æ˜ECRå¢å¼ºæ‰«æå®é™…ä¸Šä¾èµ–äºInspectoræœåŠ¡ã€‚</p><pre class=mermaid>flowchart TD
    A[å¼€å§‹] --> B[ç›´æ¥æ¿€æ´»AWS Inspector]
    B --> C[åœ¨ECRä¸­é€‰æ‹©åŸºç¡€æ‰«æ]
    C --> D[Inspectoré…ç½®æ›´æ–°]
    D --> E1[ç»§ç»­æ‰«æEC2å®ä¾‹]
    D --> E2[ç»§ç»­æ‰«æLambdaå‡½æ•°]
    D --> E3[åœæ­¢æ‰«æECRé•œåƒ]
    E1 --> F[ç»“æŸï¼šä»…EC2å’ŒLambdaè¢«æ‰«æ]
    E2 --> F
    E3 --> F
</pre><p><strong>åœºæ™¯3åˆ†æ</strong>ï¼šæœ€æœ‰è¶£çš„æ˜¯ç¬¬ä¸‰ç§æƒ…å†µã€‚å¦‚æœæˆ‘å…ˆæ¿€æ´»Inspectorï¼Œç„¶ååœ¨ECRä¸­å°†æ‰«æç±»å‹æ›´æ”¹ä¸ºåŸºç¡€æ‰«æ(Basic)ï¼ŒInspectorä¼šç»§ç»­æ‰«æEC2å’ŒLambdaèµ„æºï¼Œä½†ä¼šåœæ­¢å¯¹ECRé•œåƒçš„æ‰«æã€‚è¿™è¡¨æ˜ECRçš„æ‰«æè®¾ç½®å¯ä»¥é€‰æ‹©æ€§åœ°å¯ç”¨æˆ–ç¦ç”¨Inspectorå¯¹é•œåƒçš„æ‰«æï¼Œè€Œä¸å½±å“å…¶ä»–èµ„æºç±»å‹ã€‚</p><pre class=mermaid>flowchart TD
    A[å¼€å§‹Terraformå¾ªç¯] --> B[ç¬¬ä¸€æ¬¡åº”ç”¨]
    B --> C[Inspectorå­˜åœ¨\nECRåŸºç¡€æ‰«æå¯ç”¨\nä¸æ‰«æé•œåƒ]

    C --> D[ç¬¬äºŒæ¬¡åº”ç”¨]
    D --> E[Inspectoræ˜¾ç¤ºä¸å­˜åœ¨\néœ€è¦é‡æ–°åˆ›å»º]
    E --> F[Inspectoré‡æ–°åˆ›å»º\nECRå¢å¼ºæ‰«æå¯ç”¨\nå¼€å§‹æ‰«æé•œåƒ]

    F --> G[ç¬¬ä¸‰æ¬¡åº”ç”¨] 
    G --> C

    C -.å¾ªç¯å¼€å§‹.-> D
</pre><h2 id=3-åˆ©ç”¨terraformæ—¶çš„ç¥å¥‡å¾ªç¯>3. åˆ©ç”¨Terraformæ—¶çš„ç¥å¥‡å¾ªç¯<a href=#3-åˆ©ç”¨terraformæ—¶çš„ç¥å¥‡å¾ªç¯ class=heading-anchor-link aria-label="Link to 3. åˆ©ç”¨Terraformæ—¶çš„ç¥å¥‡å¾ªç¯"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>æ—¢ç„¶Inspectoræ˜¯æ¯æ¬¡æ‰«ææ‰æ”¶è´¹ï¼Œå¹¶ä¸”æœ‰Inspectorçš„æ—¶å€™æˆ‘ä»¬å¯ä»¥æŠŠECRè®¾ç½®ä¸ºbasicï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªæ–¹æ¡ˆæ˜¯ä¿ç•™Inspectorèµ„æºï¼ŒåŒæ—¶æŠŠECRè®¾ç½®ä¸ºbasicï¼Œç­‰åˆ°releaseçš„æ—¶å€™å¼€å¯ä¸€æ¬¡enhanced(å³Inspector)æ¥è¡¥æ¼æ´ã€‚</p><p>äºæ˜¯æˆ‘çš„ä»£ç æ˜¯è¿™ä¹ˆå†™çš„</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=terraform style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># è·å–å½“å‰ AWS è´¦æˆ· ID</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>data</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "aws_caller_identity"</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "current"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {}</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># AWS Inspector èµ„æºé…ç½®</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>resource</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "aws_inspector2_enabler"</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "this"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  account_ids</span><span style=color:#d73a49;--shiki-dark:#F97583>    =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [data</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>aws_caller_identity</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>current</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>account_id]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  resource_types</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"ECR"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>  lifecycle</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    prevent_destroy</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> true</span><span style=color:#6a737d;--shiki-dark:#6A737D>  # é˜²æ­¢èµ„æºè¢«é”€æ¯</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># ECR æ‰«æé…ç½®</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>resource</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "aws_ecr_registry_scanning_configuration"</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "configuration"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  scan_type</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>enable_scanning </span><span style=color:#d73a49;--shiki-dark:#F97583>?</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "ENHANCED"</span><span style=color:#d73a49;--shiki-dark:#F97583> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "BASIC"</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # å½“å¯ç”¨å¢å¼ºæ‰«ææ—¶ï¼Œæ·»åŠ ç‰¹å®šè§„åˆ™</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>  dynamic</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "rule"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    for_each</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>enable_scanning </span><span style=color:#d73a49;--shiki-dark:#F97583>?</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>:</span><span style=color:#24292e;--shiki-dark:#E1E4E8> []</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    content</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      scan_frequency</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "SCAN_ON_PUSH"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>      repository_filter</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        filter</span><span style=color:#d73a49;--shiki-dark:#F97583>      =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>scan_specific_repo </span><span style=color:#d73a49;--shiki-dark:#F97583>?</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "example/repo"</span><span style=color:#d73a49;--shiki-dark:#F97583> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "*"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        filter_type</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "WILDCARD"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  }</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # å½“ç¦ç”¨å¢å¼ºæ‰«ææ—¶ï¼Œæ·»åŠ é»˜è®¤è§„åˆ™</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>  dynamic</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "rule"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    for_each</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>enable_scanning </span><span style=color:#d73a49;--shiki-dark:#F97583>?</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [] </span><span style=color:#d73a49;--shiki-dark:#F97583>:</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    content</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      scan_frequency</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "SCAN_ON_PUSH"</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>      repository_filter</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        filter</span><span style=color:#d73a49;--shiki-dark:#F97583>      =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "*"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        filter_type</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "WILDCARD"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># å˜é‡å®šä¹‰</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>variable</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "enable_scanning"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  description</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "æ˜¯å¦å¯ç”¨å¢å¼ºæ‰«æ"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  type</span><span style=color:#d73a49;--shiki-dark:#F97583>        =</span><span style=color:#d73a49;--shiki-dark:#F97583> bool</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  default</span><span style=color:#d73a49;--shiki-dark:#F97583>     =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> false</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>variable</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "scan_specific_repo"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  description</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "æ˜¯å¦åªæ‰«æç‰¹å®šä»“åº“"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  type</span><span style=color:#d73a49;--shiki-dark:#F97583>        =</span><span style=color:#d73a49;--shiki-dark:#F97583> bool</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  default</span><span style=color:#d73a49;--shiki-dark:#F97583>     =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> false</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span></code></pre></div><p>ä½†æ˜¯åœ¨applyçš„æ—¶å€™å´äº§ç”Ÿäº†ç¥å¥‡çš„ç°è±¡</p><ol><li><strong>ç¬¬ä¸€æ¬¡ <code>apply</code></strong>ï¼šInspector èµ„æºå­˜åœ¨ï¼ŒECR è®¾ç½®ä¸ºåŸºæœ¬æ‰«æï¼ˆBASICï¼‰ï¼Œä¸€åˆ‡çœ‹èµ·æ¥æ­£å¸¸ã€‚</li><li><strong>ç¬¬äºŒæ¬¡ <code>apply</code></strong>ï¼šTerraform çªç„¶è¯´ Inspector ä¸å­˜åœ¨ï¼Œéœ€è¦é‡æ–°åˆ›å»ºã€‚åˆ›å»ºåï¼ŒECR å˜æˆäº†å¢å¼ºæ‰«æï¼ˆENHANCEDï¼‰ã€‚</li><li><strong>ç¬¬ä¸‰æ¬¡ <code>apply</code></strong>ï¼šåˆå›åˆ°ç¬¬ä¸€æ¬¡çš„çŠ¶æ€ï¼ŒInspector å­˜åœ¨ï¼ŒECR å˜å›åŸºæœ¬æ‰«æï¼ˆBASICï¼‰ã€‚</li></ol><p>è¿™å¾ªç¯ç®€ç›´åƒä¸ªâ€œæ­»å¾ªç¯â€ï¼Œè®©æˆ‘å®Œå…¨æ‘¸ä¸ç€å¤´è„‘ã€‚æ˜æ˜ä»£ç æ²¡æ”¹ï¼ŒçŠ¶æ€å´ä¸€ç›´åœ¨è·³æ¥è·³å»ï¼ŒTerraform ä½ æ˜¯æƒ³å¹²å•¥ï¼Ÿ</p><h3 id=mermaid-å›¾å±•ç¤º-terraform-å‘¨æœŸè¡Œä¸º>Mermaid å›¾å±•ç¤º Terraform å‘¨æœŸè¡Œä¸º<a href=#mermaid-å›¾å±•ç¤º-terraform-å‘¨æœŸè¡Œä¸º class=heading-anchor-link aria-label="Link to Mermaid å›¾å±•ç¤º Terraform å‘¨æœŸè¡Œä¸º"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>ä¸ºäº†æŠŠè¿™ä¸ªå¾ªç¯ç°è±¡è®²æ¸…æ¥šï¼Œæˆ‘ç”¨ Mermaid ç”»äº†ä¸ªæµç¨‹å›¾ï¼Œç›´è§‚å±•ç¤º Terraform åœ¨å¤šæ¬¡ <code>apply</code> æ—¶çš„çŠ¶æ€å˜åŒ–ï¼š</p><pre class=mermaid>graph TD
    A[Terraform apply 1] --> B[Inspector exist, ECR basic scan]
    B --> C[Terraform apply 2]
    C --> D[Inspector do not exist, recreate]
    D --> E[ECR enhanced scann]
    E --> F[Terraform apply 3]
    F --> B
</pre><p>ä»å›¾é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒçŠ¶æ€åœ¨ Bï¼ˆç¬¬ä¸€æ¬¡ï¼‰å’Œ Eï¼ˆç¬¬äºŒæ¬¡ï¼‰ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œç¬¬ä¸‰æ¬¡åˆå›åˆ° Bï¼Œå½¢æˆäº†é—­ç¯ã€‚è¿™è®©æˆ‘æ„Ÿè§‰ Terraform åƒæ˜¯ä¸­äº†ä»€ä¹ˆâ€œçŠ¶æ€è¯…å’’â€ã€‚</p><h2 id=4-potential-reason>4. Potential Reason<a href=#4-potential-reason class=heading-anchor-link aria-label="Link to 4. Potential Reason"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>ç”±æ­¤ï¼Œæˆ‘çŒœæµ‹ECRçš„configurationå’ŒInspectorä¹‹é—´å¹¶æ²¡æœ‰è¢«åˆ†ç¦»çš„å¾ˆå¥½ï¼Œå­˜åœ¨ä¸€äº›èƒŒåçš„å…³è”ã€‚</p><p><strong>ECR æ‰«æé…ç½®å’Œ Inspector çŠ¶æ€ä¹‹é—´å­˜åœ¨æŸç§éšå«çš„ä¾èµ–å…³ç³»</strong>ï¼Œè€Œä¸” AWS å¯èƒ½ä¼šåœ¨æŸäº›æ¡ä»¶ä¸‹è‡ªåŠ¨ç®¡ç† Inspector çš„ç”Ÿå‘½å‘¨æœŸã€‚å…·ä½“æ¥è¯´ï¼š</p><ol><li><p><strong>ç¬¬ä¸€æ¬¡ apply</strong>ï¼šInspector å­˜åœ¨ï¼ŒECR è®¾ç½®ä¸ºåŸºæœ¬æ‰«æ(BASIC)ã€‚ä½†ç”±äº ECR ç”¨çš„æ˜¯åŸºæœ¬æ‰«æï¼ŒåŒæ—¶æˆ‘ä»¬åˆæ²¡æœ‰ä¸º EC2 å’Œ Lambda å¼€å¯æ‰«æï¼Œè¿™ç§æƒ…å†µä¸‹ Inspector å˜å¾—â€æ— äº‹å¯åšâ€ï¼Œ<strong>AWS å¯èƒ½ä¼šåœ¨åå°è‡ªåŠ¨é”€æ¯å®ƒ</strong>ã€‚</p></li><li><p><strong>ç¬¬äºŒæ¬¡ apply</strong>ï¼šTerraform æ£€æŸ¥æ—¶å‘ç° AWS ä¸Š Inspector å·²ä¸å­˜åœ¨ï¼ˆè¢« AWS è‡ªå·±å¹²æ‰äº†ï¼‰ï¼Œä½† Terraform çŠ¶æ€æ–‡ä»¶ä¸­å®ƒè¿˜åœ¨ï¼Œè¿™å°±å¯¼è‡´äº†çŠ¶æ€ä¸ä¸€è‡´ã€‚äºæ˜¯ Terraform é‡æ–°åˆ›å»º Inspectorï¼Œè€Œåˆ›å»ºåï¼Œ<strong>æ–°çš„ Inspector ä¼šè‡ªåŠ¨å°† ECR æ‰«ææ¨¡å¼è®¾ä¸ºå¢å¼ºæ‰«æ(ENHANCED)</strong>ã€‚</p></li><li><p><strong>ç¬¬ä¸‰æ¬¡ apply</strong>ï¼šInspector ç¡®å®å­˜åœ¨ï¼Œä½† ECR è¢«è®¾ç½®æˆäº†å¢å¼ºæ‰«æï¼Œè€Œæˆ‘ä»¬çš„ä»£ç è¦æ±‚å®ƒæ˜¯åŸºæœ¬æ‰«æã€‚æ‰€ä»¥ Terraform æ‰§è¡Œæ—¶åªä¼šä¿®æ”¹ ECR çš„æ‰«æç±»å‹ï¼ˆä»å¢å¼ºå˜ä¸ºåŸºæœ¬ï¼‰ï¼Œ<strong>ä¸ä¼šé”€æ¯ Inspector èµ„æº</strong>ã€‚ç„¶åï¼Œæˆ‘ä»¬å›åˆ°äº†ç¬¬ä¸€æ­¥çš„çŠ¶æ€ï¼Œå¾ªç¯å¼€å§‹â€¦</p></li></ol><p>å°±åƒæ˜¯ AWS å’Œ Terraform åœ¨ç©ä¸€ä¸ªâ€ä½ åˆ›æˆ‘åˆ ï¼Œä½ åˆ æˆ‘åˆ›â€çš„æ¸¸æˆï¼Œè€Œæˆ‘ä»¬å°±è¢«å›°åœ¨è¿™ä¸ªå¥‡æ€ªçš„å¾ªç¯ä¸­ã€‚</p><h3 id=éªŒè¯æ‰‹åŠ¨é‡ç°å¾ªç¯>éªŒè¯ï¼šæ‰‹åŠ¨é‡ç°å¾ªç¯<a href=#éªŒè¯æ‰‹åŠ¨é‡ç°å¾ªç¯ class=heading-anchor-link aria-label="Link to éªŒè¯ï¼šæ‰‹åŠ¨é‡ç°å¾ªç¯"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>ä¸ºäº†éªŒè¯æˆ‘çš„çŒœæµ‹ï¼Œæˆ‘å†³å®šæ‰‹åŠ¨åœ¨ AWS æ§åˆ¶å°ä¸Šé‡ç°è¿™ä¸ªè¿‡ç¨‹ï¼š</p><ol><li>é¦–å…ˆåœ¨æ§åˆ¶å°ä¸Šå¯ç”¨ Inspectorï¼Œç„¶åå°† ECR è®¾ç½®ä¸ºåŸºæœ¬æ‰«æ(BASIC)</li><li>ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè§‚å¯Ÿåˆ° <strong>Inspector è¢«è‡ªåŠ¨ç¦ç”¨äº†</strong>ï¼è¿™è¯å®äº†æˆ‘çš„ç¬¬ä¸€ä¸ªçŒœæµ‹ï¼šåœ¨æ²¡æœ‰å¼€å¯å…¶ä»–èµ„æºæ‰«æçš„æƒ…å†µä¸‹ï¼Œçº¯ BASIC æ¨¡å¼ä¼šå¯¼è‡´ Inspector è‡ªåŠ¨è¢«ç¦ç”¨</li><li>ç„¶åï¼Œæˆ‘åœ¨è¿™ç§çŠ¶æ€ä¸‹ç›´æ¥æ‰‹åŠ¨å¯ç”¨ Inspector</li><li>ç»“æœç¥å¥‡çš„äº‹æƒ…å‘ç”Ÿäº†ï¼š<strong>ECR çš„æ‰«ææ¨¡å¼è‡ªåŠ¨ä» BASIC å˜æˆäº† ENHANCED</strong>ï¼è¿™éªŒè¯äº†æˆ‘çš„ç¬¬äºŒä¸ªçŒœæµ‹</li></ol><pre class=mermaid>graph TD
    A[å¼€å¯ Inspector] --> B[è®¾ç½® ECR ä¸º BASIC]
    B -->|ç­‰å¾…ä¸€æ®µæ—¶é—´| C[Inspector è‡ªåŠ¨è¢«ç¦ç”¨]
    C -->|æ‰‹åŠ¨é‡æ–°å¼€å¯ Inspector| D[ECR è‡ªåŠ¨å˜ä¸º ENHANCED]
    D -->|è®¾ç½® ECR ä¸º BASIC| B
</pre><p>è¿™å®Œå…¨å°è¯äº† Terraform å¾ªç¯çš„æ ¹æœ¬åŸå› ï¼ç°åœ¨è¿™ä¸ªç°è±¡è§£é‡Šå¾—é€šäº†ï¼š<strong>AWS åœ¨åå°æœ‰ä¸€å¥—è‡ªå·±çš„é€»è¾‘ï¼Œä¼šæ ¹æ® ECR æ‰«æé…ç½®è‡ªåŠ¨ç®¡ç† Inspector çš„çŠ¶æ€ï¼Œåä¹‹äº¦ç„¶</strong>ã€‚è€Œ Terraform å¹¶ä¸çŸ¥é“è¿™äº›éšå«çš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰§è¡Œæ—¶éƒ½åœ¨è¯•å›¾ç»´æŠ¤ä¸€ä¸ªæ³¨å®šä¼šè¢«æ‰“ç ´çš„å¹³è¡¡ã€‚</p><p>å¯¹äº Inspector å’Œ ECR çš„æ¡ˆä¾‹ï¼Œæˆ‘æ¨æµ‹ï¼š</p><ul><li>AWS Inspector å¯èƒ½è®¤ä¸ºï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•â€å¢å¼ºâ€æ‰«æä»»åŠ¡ï¼Œå®ƒå°±æ²¡æœ‰å­˜åœ¨çš„å¿…è¦</li><li>åŒæ ·ï¼Œå½“ Inspector è¢«æ¿€æ´»æ—¶ï¼Œå®ƒå¯èƒ½é»˜è®¤å°† ECR æ‰«æè®¾ä¸ºå¢å¼ºæ¨¡å¼ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ‰§è¡Œå…¶åŠŸèƒ½</li></ul><p>ä½†è¿™ç§â€è‡ªä½œä¸»å¼ â€çš„è¡Œä¸ºå¯¹äºä½¿ç”¨å£°æ˜å¼é…ç½®ç®¡ç†çš„ç”¨æˆ·æ¥è¯´ç®€ç›´æ˜¯å™©æ¢¦ï¼Œå› ä¸ºæˆ‘ä»¬æœŸæœ›çš„æ˜¯å¯é¢„æµ‹ã€ç¨³å®šçš„çŠ¶æ€ç®¡ç†ã€‚</p><h2 id=5-solution>5. solution<a href=#5-solution class=heading-anchor-link aria-label="Link to 5. solution"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>æ—¢ç„¶ä¸¤ä¸ªçŠ¶æ€ç›´æ¥ä¼šæœ‰å…³è”ï¼Œé‚£å°±åªç•™ä¸€ä¸ªæ¥ç®¡ç†èµ„æºï¼Œè¿™æ˜¯æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚äºæ˜¯æˆ‘çš„ä»£ç å˜æˆäº†è¿™æ ·</p><div class=code-block-wrapper><button aria-label="Copy code" class=code-copy-button type=button></button><pre class="astro-code astro-code-themes github-dark github-light" data-copy-button-added=true data-language=terraform style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># ğŸš« è­¦å‘Š: ä¸è¦æ‰‹åŠ¨å¯ç”¨ Inspector!</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 1. å¯ç”¨ Inspector ä¼šå¯¼è‡´å¯¹æ‰€æœ‰èµ„æºè¿›è¡Œæ‰«æï¼Œäº§ç”Ÿæ„å¤–è´¹ç”¨</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 2. æ‰‹åŠ¨æ¿€æ´»å¯èƒ½å¯¼è‡´ä¸ Terraform ç®¡ç†çš„çŠ¶æ€ä¸ä¸€è‡´</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># resource "aws_inspector2_enabler" "this" {</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#   account_ids    = [local.account_id]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#   resource_types = ["ECR"]</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#   lifecycle {</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#     prevent_destroy = true</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>#   }</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># }</span></span>
<span class=line></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>locals</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # æ ¹æ®å˜é‡å†³å®šæ‰«æç±»å‹</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  scan_type</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>enable_enhanced_scanning </span><span style=color:#d73a49;--shiki-dark:#F97583>?</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "ENHANCED"</span><span style=color:#d73a49;--shiki-dark:#F97583> :</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "BASIC"</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D>  # å¦‚æœå¯ç”¨å¢å¼ºæ‰«æï¼Œåˆ™æ‰«æç‰¹å®šä»“åº“ï¼Œå¦åˆ™æ‰«æå…¨éƒ¨</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  scan_repositories</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>enable_enhanced_scanning </span><span style=color:#d73a49;--shiki-dark:#F97583>?</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    [</span><span style=color:#d73a49;--shiki-dark:#F97583>for</span><span style=color:#24292e;--shiki-dark:#E1E4E8> repo </span><span style=color:#d73a49;--shiki-dark:#F97583>in</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>repositories_to_scan </span><span style=color:#d73a49;--shiki-dark:#F97583>:</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "</span><span style=color:#d73a49;--shiki-dark:#F97583>${</span><span style=color:#24292e;--shiki-dark:#E1E4E8>var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>registry_prefix</span><span style=color:#d73a49;--shiki-dark:#F97583>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>/</span><span style=color:#d73a49;--shiki-dark:#F97583>${</span><span style=color:#24292e;--shiki-dark:#E1E4E8>repo</span><span style=color:#d73a49;--shiki-dark:#F97583>}</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] </span><span style=color:#d73a49;--shiki-dark:#F97583>:</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"*"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># åªç®¡ç† ECR æ‰«æé…ç½®</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>resource</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "aws_ecr_registry_scanning_configuration"</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "configuration"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  scan_type</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> local</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>scan_type</span></span>
<span class=line></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>  dynamic</span><span style=color:#005cc5;--shiki-dark:#79B8FF> "rule"</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    for_each</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> local</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>scan_repositories</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>    content</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      scan_frequency</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> var</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>scan_frequency</span></span>
<span class=line><span style=color:#6f42c1;--shiki-dark:#B392F0>      repository_filter</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        filter</span><span style=color:#d73a49;--shiki-dark:#F97583>      =</span><span style=color:#24292e;--shiki-dark:#E1E4E8> rule</span><span style=color:#d73a49;--shiki-dark:#F97583>.</span><span style=color:#24292e;--shiki-dark:#E1E4E8>value</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        filter_type</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "WILDCARD"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>      }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>    }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  }</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span></code></pre></div><p>æˆ‘çš„è§£å†³æ–¹æ¡ˆåŸºäºä¸€ä¸ªå…³é”®æ´å¯Ÿï¼š<strong>é—®é¢˜çš„æ ¹æºä¸æ˜¯ ECR é…ç½®ï¼Œè€Œæ˜¯ Terraform è¯•å›¾ç®¡ç† Inspector èµ„æº</strong>ã€‚é€šè¿‡é‡‡å–ä»¥ä¸‹ç­–ç•¥ï¼Œæˆ‘æˆåŠŸæ‰“ç ´äº†å¾ªç¯ï¼š</p><ol><li><p><strong>å®Œå…¨æ³¨é‡Šæ‰ Inspector èµ„æº</strong>ï¼šä¸å†å°è¯•ç®¡ç† <code>aws_inspector2_enabler</code>ï¼Œé¿å…äº†ä¸ AWS è‡ªåŠ¨è¡Œä¸ºçš„å†²çªã€‚</p></li><li><p><strong>ä¸“æ³¨äºç®¡ç† ECR æ‰«æé…ç½®</strong>ï¼šåªé€šè¿‡ <code>aws_ecr_registry_scanning_configuration</code> èµ„æºæ¥æ§åˆ¶æ‰«æè¡Œä¸ºã€‚</p></li><li><p><strong>åŠ¨æ€è®¾ç½®æ‰«æèŒƒå›´</strong>ï¼š</p><ul><li>å½“è®¾ç½®ä¸º BASIC æ‰«ææ—¶ï¼Œä½¿ç”¨é€šé…ç¬¦ <code>"*"</code> è¦†ç›–æ‰€æœ‰ä»“åº“</li><li>å½“è®¾ç½®ä¸º ENHANCED æ‰«ææ—¶ï¼Œå¯ä»¥ç²¾ç¡®æŒ‡å®šéœ€è¦æ‰«æçš„ä»“åº“åˆ—è¡¨</li></ul></li><li><p><strong>æ¸…æ™°çš„è­¦å‘Šæ³¨é‡Š</strong>ï¼šæé†’å›¢é˜Ÿæˆå‘˜ä¸è¦æ‰‹åŠ¨å¯ç”¨ Inspectorï¼Œé¿å…å†æ¬¡é™·å…¥çŠ¶æ€é—®é¢˜ã€‚</p></li></ol><h3 id=è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜åŠ¿>è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜åŠ¿<a href=#è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜åŠ¿ class=heading-anchor-link aria-label="Link to è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜åŠ¿"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><ol><li><p><strong>ç¨³å®šå¯é </strong>ï¼šæ²¡æœ‰äº†çŠ¶æ€å¾ªç¯ï¼ŒTerraform çš„è¡Œä¸ºå˜å¾—å¯é¢„æµ‹ã€‚</p></li><li><p><strong>ä¿æŒçµæ´»æ€§</strong>ï¼šä»ç„¶å¯ä»¥é€šè¿‡å˜é‡æ§åˆ¶æ˜¯å¦å¯ç”¨å¢å¼ºæ‰«æã€‚</p></li><li><p><strong>æˆæœ¬æ§åˆ¶</strong>ï¼šé€šè¿‡ç²¾ç¡®æŒ‡å®šéœ€è¦å¢å¼ºæ‰«æçš„ä»“åº“ï¼Œé¿å…ä¸å¿…è¦çš„å¼€é”€ã€‚</p></li><li><p><strong>æ— éœ€æ‹…å¿ƒ Inspector çŠ¶æ€</strong>ï¼šè®© AWS è‡ªè¡Œç®¡ç† Inspector çš„åˆ›å»ºå’Œé”€æ¯ï¼Œä¸å†å°è¯•å¹²é¢„è¿™ä¸ªè¿‡ç¨‹ã€‚</p></li></ol><h3 id=å®é™…åº”ç”¨æ•ˆæœ>å®é™…åº”ç”¨æ•ˆæœ<a href=#å®é™…åº”ç”¨æ•ˆæœ class=heading-anchor-link aria-label="Link to å®é™…åº”ç”¨æ•ˆæœ"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h3><p>åœ¨å®æ–½è¿™ä¸ªæ–¹æ¡ˆåï¼Œæˆ‘å‘ç° Terraform çš„è¡Œä¸ºå˜å¾—æå…¶ç¨³å®šã€‚æ— è®ºè¿è¡Œå¤šå°‘æ¬¡ <code>apply</code>ï¼ŒçŠ¶æ€éƒ½ä¿æŒä¸€è‡´ï¼Œä¸å†æœ‰ä»»ä½•å¥‡æ€ªçš„å¾ªç¯æˆ–æ¼‚ç§»ã€‚</p><p>å½“æˆ‘å°† <code>enable_enhanced_scanning</code> è®¾ä¸º <code>false</code> æ—¶ï¼Œæ‰«æç±»å‹å˜ä¸º BASICï¼ŒAWS ä¼šè‡ªåŠ¨åœç”¨ Inspectorï¼ˆå› ä¸ºæ²¡æœ‰ä½¿ç”¨å®ƒçš„å¿…è¦ï¼‰ã€‚å½“æˆ‘å°†å…¶è®¾ä¸º <code>true</code> æ—¶ï¼ŒAWS ä¼šè‡ªåŠ¨åˆ›å»º Inspector å¹¶å¼€å§‹å¯¹æŒ‡å®šçš„ä»“åº“è¿›è¡Œå¢å¼ºæ‰«æã€‚</p><p>è¿™ç§æ–¹å¼ä¸ AWS çš„å†…éƒ¨é€»è¾‘å®Œç¾å¥‘åˆï¼Œä¸å†è¯•å›¾å¯¹æŠ— AWS çš„è‡ªåŠ¨è¡Œä¸ºï¼Œè€Œæ˜¯é¡ºåº”å®ƒï¼Œè®©ç³»ç»Ÿè‡ªç„¶è¿è¡Œã€‚</p><h2 id=6-sum-up>6. Sum up<a href=#6-sum-up class=heading-anchor-link aria-label="Link to 6. Sum up"><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>è¿™ä¸ªå‘ç°è®©æˆ‘æ„è¯†åˆ°ï¼Œ<strong>AWS æœåŠ¡é—´å¯èƒ½å­˜åœ¨å¤§é‡æˆ‘ä»¬ä¸äº†è§£çš„éšæ€§å…³è”å’Œè‡ªåŠ¨è¡Œä¸º</strong>ã€‚è¿™äº›â€å¹•åè¡Œä¸ºâ€ä¸ä¸€å®šåœ¨æ–‡æ¡£ä¸­å†™å¾—å¾ˆæ¸…æ¥šï¼Œä½†ä¼šæå¤§åœ°å½±å“æˆ‘ä»¬çš„åŸºç¡€è®¾æ–½ç®¡ç†ã€‚ç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨ Terraform è¿™ç±» IaC å·¥å…·æ—¶ï¼Œè¿™äº›éšæ€§ä¾èµ–ä¼šå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ã€å¾ªç¯å˜æ›´ç­‰é—®é¢˜ã€‚</p><div id=post-copyright></div><div class="mt-12.6 uno-decorative-line"></div><div class="no-heti flex flex-wrap gap-x-3 gap-y-3.2"><a href=/tags/AWS/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">AWS </span><span class="inline-block font-medium opacity-0" aria-hidden=true>AWS </span></a><a href=/tags/DevOps/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">DevOps </span><span class="inline-block font-medium opacity-0" aria-hidden=true>DevOps </span></a><a href="/tags/Software Engineering/" class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">Software Engineering </span><span class="inline-block font-medium opacity-0" aria-hidden=true>Software Engineering</span></a></div></div></article></main><footer class="leading-1.25em font-navbar lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=/atom.xml/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>RSS</a>&nbsp;/ <a href=https://github.com/lifeodyssey class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:email@radishzz.cc class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;</p><p>Â© 2025-2026 å‘¨å¤§ä¾ </p><p>Powered by <a href=https://astro.build/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><div class="flex absolute gap-6 lg:bottom-[min(10.27rem+1.92vw,12rem)] lg:fixed lg:right-[max(5rem,calc(50vw-35rem))] lg:top-auto lg:w-14rem min-[823px]:max-lg:right-[calc(50vw-22rem)] right-7.25vw top-14.6"><a href=/posts/ca51402d.html.html/ class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" aria-label="Switch website language" id=language-switcher><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M19.18 21.1 12.4 1.89h-1.21L4.52 21.1l-2.53.2v.81h6.37v-.81l-2.83-.2 2.02-5.97h7.58l2.02 5.97-3.34.2v.81H22v-.81l-2.83-.2zM7.85 14.33l3.44-10.21 3.54 10.21z"/></svg> </a><button aria-label="Switch light/dark theme" class="hover:c-primary active:scale-90 aspect-square c-secondary w-4" id=theme-toggle-button><svg aria-hidden=true fill=currentColor viewBox="0 0 24 24"><path d="M12.06.61C5.66.61.46 5.71.46 12.11s5.1 11.5 11.6 11.5 11.5-5.1 11.5-11.5S18.46.61 12.06.61m0 21c-6.07 0-10.94-4.2-10.94-9.5s4.87-9.4 10.94-9.4S23 6.91 23 12.21s-4.88 9.4-10.94 9.4"/></svg></button></div><script>!function(){const e="oklch(96% 0.005 298)",t="oklch(22% 0.005 298)";function n(n){document.documentElement.classList.toggle("dark",n);const o=document.head.querySelector('meta[name="theme-color"]');o&&e&&t&&o.setAttribute("content",n?t:e),localStorage.setItem("theme",n?"dark":"light"),document.dispatchEvent(new Event("theme-changed"))}function o(){n(!document.documentElement.classList.contains("dark"))}document.addEventListener("click",(function(e){const t=e.target instanceof Element?e.target:null,n=t?.closest("#theme-toggle-button");if(!n)return;if(document.documentElement.classList.contains("reduce-motion"))return void o();document.documentElement.style.setProperty("view-transition-name","animation-theme-toggle"),document.documentElement.setAttribute("data-theme-changing",""),document.startViewTransition(o).finished.then((()=>{document.documentElement.style.removeProperty("view-transition-name"),document.documentElement.removeAttribute("data-theme-changing")}))}),{passive:!0}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{n(e.matches)}))}()</script><script type=module>const o={click:"tap",typing:"type"},l={[o.click]:.8,[o.typing]:.4},d=["#language-switcher","#theme-toggle-button"],f=[".el-input__inner",".el-textarea__inner","#wl-nick","#wl-mail","#wl-link","#wl-edit"],h=new Set(["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"]),p=d.join(","),g=f.join(",");function r(){return window.matchMedia("(max-width: 1023px)").matches}function w(){return document.head.querySelector('link[rel="sitemap"]')?.getAttribute("href")?.replace("/sitemap-index.xml","")||""}class y{audioContext=null;audioBuffers={[o.click]:[],[o.typing]:[]};initPromise=null;async fetchAndCacheSound(t,e){if(!this.audioContext)throw new Error("Audio context not initialized");const n=`${t}_0${e+1}`,i=await(await fetch(`${w()}/sounds/${n}.wav`)).arrayBuffer(),a=await this.audioContext.decodeAudioData(i);this.audioBuffers[t].push(a)}async preloadAllSounds(){const t=Object.values(o).flatMap((t=>Array.from({length:5},((e,n)=>this.fetchAndCacheSound(t,n)))));await Promise.allSettled(t)}async initialize(){return this.initPromise??=(async()=>{const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,await this.preloadAllSounds()})()}async playSound(t){try{if(await this.initialize(),!this.audioContext)return;"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=this.audioBuffers[t];if(0===e.length)return;const n=this.audioContext.createBufferSource();n.buffer=e[Math.floor(Math.random()*e.length)];const i=this.audioContext.createGain();i.gain.value=l[t],n.connect(i).connect(this.audioContext.destination),n.start(0)}catch(t){console.warn("Sound playback failed:",t)}}}const c=new y;function m(t){r()||!t.target?.closest(p)||c.playSound(o.click)}function x(t){r()||t.ctrlKey||t.altKey||t.metaKey||h.has(t.key)||!t.target?.closest(g)||c.playSound(o.typing)}document.addEventListener("click",m,{passive:!0}),document.addEventListener("keydown",x,{passive:!0})</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},o=new WeakMap;function r(){const e=document.querySelectorAll(".code-copy-button");0!==e.length&&e.forEach((e=>{e.innerHTML=s.copy}))}async function a(e){if(e.classList.contains("copy-success"))return;const t=e.parentElement?.querySelector("pre code"),n=t?.textContent??"";if(t&&n)try{await navigator.clipboard.writeText(n);const t=o.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const c=setTimeout((()=>{e.isConnected&&(e.innerHTML=s.copy,e.classList.remove("copy-success"),o.delete(e))}),1500);o.set(e,c)}catch(e){console.error("Failed to copy code",e)}}function l(e){const t=e.target instanceof Element&&e.target.closest(".code-copy-button");t&&a(t)}document.addEventListener("astro:page-load",r),document.addEventListener("click",l,{passive:!0}),r()</script><script type=module>async function p(t){const e=t.dataset.repo;if(!e)return;const o=t.getElementsByClassName("gc-owner-avatar")[0],n=t.getElementsByClassName("gc-repo-description")[0],s=t.getElementsByClassName("gc-stars-count")[0],a=t.getElementsByClassName("gc-forks-count")[0],r=t.getElementsByClassName("gc-license-info")[0];function c(t){const e=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1});o&&t.owner?.avatar_url&&(o.style.backgroundImage=`url(${t.owner.avatar_url})`),n&&(n.textContent=t.description??"No description"),s&&(s.textContent=e.format(t.stargazers_count??0)),a&&(a.textContent=e.format(t.forks_count??0)),r&&(r.textContent=t.license?.spdx_id??"No License")}const i=`github-repo-${e}`,m=sessionStorage.getItem(i);if(m){c(JSON.parse(m))}else try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok){if(n){const e=404===t.status?"Repository not found":"Failed to load repository data";n.textContent=e}return}const o=await t.json();sessionStorage.setItem(i,JSON.stringify(o)),c(o)}catch(t){console.error(`Failed to fetch ${e}:`,t)}}function f(){const t=document.getElementsByClassName("gc-container");0!==t.length&&Array.from(t).forEach((t=>{p(t)}))}document.addEventListener("astro:page-load",f),f()</script><script type=module src=/_astro/MediaEmbed.astro_astro_type_script_index_0_lang.wKrCMCCr.js></script><script type=module>const n={overlay:document.querySelector(".zoom-overlay"),zoomedImg:null,originalImg:null,createOverlay(){this.overlay&&this.overlay.isConnected||(this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-modal","true"),this.overlay.setAttribute("aria-label","Image Viewer"),this.overlay.setAttribute("tabindex","-1"),Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",zIndex:"999",backgroundColor:"oklch(var(--un-preset-theme-colors-background) / 0.95)",opacity:"0",transition:"opacity 300ms cubic-bezier(0.4, 0, 0.2, 1)",cursor:"zoom-out",display:"none"}),document.body.appendChild(this.overlay))},zoomImg(e){if(!this.overlay)return;document.body.style.overflow="hidden";const t=e.getBoundingClientRect();this.originalImg=e,this.zoomedImg=e.cloneNode(),Object.assign(this.zoomedImg.style,{position:"fixed",top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",zIndex:"1000",cursor:"zoom-out"}),document.body.appendChild(this.zoomedImg),this.overlay.style.display="block",this.overlay.focus();const o=window.innerWidth,i=window.innerHeight,s=window.innerWidth<768?1:.8,l=Math.min(o*s/t.width,i*s/t.height),a=(-t.left+(o-t.width)/2)/l,n=(-t.top+(i-t.height)/2)/l;requestAnimationFrame((()=>{this.overlay&&(this.overlay.style.opacity="1"),this.zoomedImg&&(this.zoomedImg.style.transform=`scale(${l}) translate3d(${a}px, ${n}px, 0)`)}))},close(){!this.overlay||!this.zoomedImg||!this.originalImg||(this.zoomedImg.style.transform="",this.overlay.style.opacity="0",document.body.style.overflow="",setTimeout((()=>{this.zoomedImg&&this.zoomedImg.parentNode&&document.body.removeChild(this.zoomedImg),this.zoomedImg=null,this.overlay&&(this.overlay.style.display="none"),this.originalImg&&this.originalImg.focus(),this.originalImg=null}),300))},setupOverlay(){this.createOverlay(),this.zoomedImg=null,this.originalImg=null},handleClick(e){if(this.zoomedImg)return void this.close();const t=e.target;t instanceof HTMLImageElement&&t.complete&&t.naturalWidth>=100&&t.naturalHeight>=100&&this.zoomImg(t)},handleResize(){this.zoomedImg&&this.close()},init(){this.createOverlay(),document.addEventListener("astro:page-load",(()=>this.setupOverlay())),document.addEventListener("click",(e=>this.handleClick(e)),{passive:!0}),window.addEventListener("resize",(()=>this.handleResize()),{passive:!0})}};n.init()</script></body></html>
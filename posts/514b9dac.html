<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.0.0-rc1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lifeodyssey.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.16.0","exturl":true,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":"max"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="之前一直想方设法跨过去的事情今天终于要开始搞了">
<meta property="og:type" content="article">
<meta property="og:title" content="py6s">
<meta property="og:url" content="https://lifeodyssey.github.io/posts/514b9dac.html">
<meta property="og:site_name" content="乔克叔叔的床边故事">
<meta property="og:description" content="之前一直想方设法跨过去的事情今天终于要开始搞了">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://lifeodyssey.github.io/posts/Users/zhenjia/AppData/Roaming/Typora/typora-user-images/image-20211216174336134.png">
<meta property="og:image" content="https://lifeodyssey.github.io/posts/Users/zhenjia/AppData/Roaming/Typora/typora-user-images/image-20211217174759219.png">
<meta property="og:image" content="https://blog.rtwilson.com/wp-content/uploads/2019/09/image-1569879583877.png">
<meta property="article:published_time" content="2021-12-10T07:04:43.000Z">
<meta property="article:modified_time" content="2023-05-14T14:34:39.284Z">
<meta property="article:author" content="周大侠">
<meta property="article:tag" content="Remote Sensing">
<meta property="article:tag" content="大气校正">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lifeodyssey.github.io/posts/Users/zhenjia/AppData/Roaming/Typora/typora-user-images/image-20211216174336134.png">


<link rel="canonical" href="https://lifeodyssey.github.io/posts/514b9dac.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://lifeodyssey.github.io/posts/514b9dac.html","path":"posts/514b9dac.html","title":"py6s"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>py6s | 乔克叔叔的床边故事</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135697820-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135697820-1","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="乔克叔叔的床边故事" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">乔克叔叔的床边故事</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#s%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">6S介绍</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">周大侠</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">153</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">93</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lifeodyssey"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnpoZW5qaWF6aG91MDEyN0BnbWFpbC5jb20=" title="E-Mail → mailto:zhenjiazhou0127@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL1poZW5qaWFfWmhvdQ==" title="Researchgate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Zhenjia_Zhou"><i class="fa fa-researchgate fa-fw"></i>Researchgate</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luLyVFNiU4QyVBRiVFNCVCRCVCMy0lRTUlOTElQTgtODMyNmI0MTU1Lw==" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;%E6%8C%AF%E4%BD%B3-%E5%91%A8-8326b4155&#x2F;"><i class="fa fa-Linkedin fa-fw"></i>Linkedin</span>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lifeodyssey.github.io/posts/514b9dac.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="周大侠">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乔克叔叔的床边故事">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="py6s | 乔克叔叔的床边故事">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          py6s
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-12-10 15:04:43" itemprop="dateCreated datePublished" datetime="2021-12-10T15:04:43+08:00">2021-12-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-14 22:34:39" itemprop="dateModified" datetime="2023-05-14T22:34:39+08:00">2023-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>1.7k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>6 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>之前一直想方设法跨过去的事情今天终于要开始搞了</p>
<span id="more"></span>
<h1 id="s介绍">6S介绍</h1>
<p>我今天终于才弄明白6到底是怎么做大气校正的</p>
<p>6S的全名是Second Simulation of a Satellite Signal in the Solar Spectrum vector code，所以他不是通过输入的遥感影像来算出来的，而是在选定一个大气环境下，通过辐射传输模拟算出来辐亮度值，然后把观测得到的辐亮度值减去这个算出来的。</p>
<p>而不是像水色里的步骤一样，通过各种假设和经验计算出来辐亮度，再减去辐亮度</p>
<p>然后再来搞清楚一下我要弄的东西</p>
<p>我这里要复现的是High-frequency observation of floating algae from AHI on Himawari-8这篇文章</p>
<blockquote>
<p>The calibration parameters were applied to raw counts to produce the top-of-atmosphere radiance (<span class="math inline">\(L_{TOA}\)</span>) and reflectance (<span class="math inline">\(R_{TOA}\)</span>), and then (<span class="math inline">\(R_{TOA}\)</span>) was converted to Rayleigh-corrected reflectance(<span class="math inline">\(R_{rc}\)</span>) following Hu et al. (2004): <span class="math display">\[
R_{TOA}=\pi L_{TOA}/(F_0cos(\theta_0))\\
R_{rc}=R_{TOA}-R_r
\]</span> where <span class="math inline">\(F_0\)</span> is the extraterrestrial solar irradiance, <span class="math inline">\(θ_0\)</span> is sun zenith angle; <span class="math inline">\(R_r\)</span> is Rayleigh reflectance estimated with the 6S model (Vermote et al.,1997) modified for AHI. The modification was simply to apply the spectral response function of all bands of AHI into the original 6S model. The required inputs to the 6S model, for example, barometric pressure, were obtained from ECMWF (https://apps.ecmwf.int/datasets/data/interim-full-daily/levtype=sfc/).</p>
</blockquote>
<p>一个个来</p>
<p>首先是从0级数据到TOA.</p>
<p>在<span class="exturl" data-url="aHR0cHM6Ly93d3cuZW9yYy5qYXhhLmpwL3B0cmVlL3VzZXJndWlkZS5odG1s">这个<i class="fa fa-external-link-alt"></i></span>页面看到从1级数据开始就是albedo了，所以还是要从0级数据开始</p>
<p>问题是转换公式是什么呢。</p>
<p>于是我又去看了看他提到的那篇hu2004，但是没找到</p>
<p>回头又看了眼他前面说的那句</p>
<blockquote>
<p>containing all the necessary metadata for calibration and projection parameters in the header section, with the raw binary data stored in the main HSD block.</p>
</blockquote>
<p>哦那就不用管了，为了确认我打开<span class="exturl" data-url="aHR0cHM6Ly93d3cuZGF0YS5qbWEuZ28uanAvbXNjd2ViL2VuL2hpbWF3YXJpODkvc3BhY2Vfc2VnbWVudC9oc2Rfc2FtcGxlL0hTX0RfdXNlcnNfZ3VpZGVfZW5fdjEzLnBkZg==">这个页面<i class="fa fa-external-link-alt"></i></span>看了眼</p>
<figure>
<img src="/posts/Users/zhenjia/AppData/Roaming/Typora/typora-user-images/image-20211216174336134.png" alt><figcaption>image-20211216174336134</figcaption>
</figure>
<p>然后还有一个这个</p>
<figure>
<img src="/posts/Users/zhenjia/AppData/Roaming/Typora/typora-user-images/image-20211217174759219.png" alt><figcaption>image-20211217174759219</figcaption>
</figure>
<p>问题来了，这一步算出来的是albedo，但是我要用的是reflectance，这俩一样吗？</p>
<p>我查了<span class="exturl" data-url="aHR0cHM6Ly9naXMuc3RhY2tleGNoYW5nZS5jb20vcXVlc3Rpb25zLzM2NzI2L2RpZmZlcmVuY2UtYmV0d2Vlbi1hbGJlZG8tYW5kLXN1cmZhY2UtcmVmbGVjdGFuY2U=">这个<i class="fa fa-external-link-alt"></i></span>回答，没看懂，后来想想，去查单位呗</p>
<p>Radiance的单位是<span class="math inline">\(Wm^{-2}\mu m^{-1}sr^{-1}\)</span>,pi和那个cos都是没有单位的</p>
<p>翻到了一篇<span class="exturl" data-url="aHR0cHM6Ly9hc2xvcHVicy5vbmxpbmVsaWJyYXJ5LndpbGV5LmNvbS9kb2kvcGRmLzEwLjQzMTkvbG8uMTk5MC4zNS44LjE2NTc=">古老的文献<i class="fa fa-external-link-alt"></i></span>，里面给出的单位是</p>
<p><span class="math inline">\(W m^{-2} nm^{-1}\)</span></p>
<p>因为是band averaged（spectral mean）所以有个nm-1正常，和irradiance的单位就差了个这个</p>
<p>所以那个最终的单位是 <span class="math display">\[
\frac{Wm^{-2}\mu m^{-1}sr^{-1}}{W m^{-2} nm^{-1}} \\
=sr^{-1}
\]</span> 对我来说差一个角度值，这个角度值只能是Cos(theta0)来的</p>
<p>我就很费解，这个cos(theta0)是从哪儿提供的角度呢</p>
<p>所以这个肯定是不一样。</p>
<p>最后在发邮件问了他们的工作人员之后，终于得到了这个数值。</p>
<p>在<span class="exturl" data-url="aHR0cHM6Ly93d3cuZGF0YS5qbWEuZ28uanAvbXNjd2ViL2RhdGEvbW9uaXRvcmluZy9nc2ljcy92aXMvdGVjaGluZm9fdmlzdmljYWwuaHRtbA==">这个<i class="fa fa-external-link-alt"></i></span>页面，算出来的单位也是对的</p>
<p>##　6s</p>
<blockquote>
<p>Rr is Rayleigh reflectance estimated with the 6S mode</p>
</blockquote>
<p>在用咕咕噜搜了半天之后，终于找到作者本人写的怎么算的文章了，在<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnJ0d2lsc29uLmNvbS9jYWxjdWxhdGluZy1yYXlsZWlnaC1yZWZsZWN0YW5jZS11c2luZy1weTZzLw==">这里<i class="fa fa-external-link-alt"></i></span>。</p>
<p>（百度和bing完全搜不到这篇文章，国内还把bing给禁了，那不就是拿百度给民众喂屎）</p>
<p>以下是对原文的翻译+自我理解</p>
<p>首先我们要理解，什么是瑞利反射。</p>
<p>瑞利反射是单独由大其中的分子造成的反射，而6s并不能单独计算这一项，她能计算的是所有的反射率，是地表+气溶胶+各种分子。</p>
<p>所以想计算瑞利反射，我们需要取消掉其他所有的计算，这意味着我们得到的反射率只包含瑞利反射。</p>
<p>代码是这样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Py6S <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = SixS()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Standard altitude settings for the sensor</span></span><br><span class="line"><span class="comment"># and target</span></span><br><span class="line">s.altitudes.set_sensor_satellite_level()</span><br><span class="line">s.altitudes.set_target_sea_level()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Wavelength of 0.5nm</span></span><br><span class="line">s.wavelength = Wavelength(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># turn off the ground reflectance</span></span><br><span class="line">s.ground_reflectance = GroundReflectance.HomogeneousLambertian(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># turn off the aerosol scattering</span></span><br><span class="line"></span><br><span class="line">s.aero_profile = AeroProfile.PredefinedType(AeroProfile.NoAerosols)</span><br><span class="line"><span class="comment"># turn off the atmospheric absorption by gases</span></span><br><span class="line">s.atmos_profile = AtmosProfile.PredefinedType(AtmosProfile.NoGaseousAbsorption)</span><br><span class="line"><span class="comment"># then run the simulation and look the output</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.outputs.fulltext)</span><br><span class="line"></span><br><span class="line">Rc= s.outputs.apparent_reflectance</span><br></pre></td></tr></table></figure>
<p>这样，虽然最后计算出来的东西叫apparent reflectance，但是因为我们把瑞利反射外所有的反射都去掉了，所以这个apparent reflectance就是最终的Rayleigh reflectance。</p>
<p>除此之外，还有一些有意思的东西。</p>
<p>第一，我们其实不需要把地面的反射率设为0，如果我们把地面反射率设为其他的东西，比如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.ground_reflectance = GroundReflectance.HomogeneousLambertian(GroundReflectance.GreenVegetation)</span><br></pre></td></tr></table></figure>
<p>将会得到一些不一样的数值，这个数值叫做atmospheric intrinsic reflectance，这是直接来自大气的反射率（在本例中只是来自瑞利散射，但在正常情况下，这也包括气溶胶散射）。这可以作为s.output.urgeric_intrinsic_reflectance进行访问。</p>
<p>还有一件事，只是为了表明Py6S中的瑞利反射率的行为方式与我们所了解的物理学知识相一致......我们可以编写一点代码，提取不同波长的瑞利反射率并绘制成图--我们希望有一条指数递减的曲线，显示低波长的高瑞利反射率，反之亦然。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Py6S <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">s = SixS()</span><br><span class="line"></span><br><span class="line">s.altitudes.set_sensor_satellite_level()</span><br><span class="line">s.altitudes.set_target_sea_level()</span><br><span class="line">s.aero_profile = AeroProfile.PredefinedType(AeroProfile.NoAerosols)</span><br><span class="line">s.atmos_profile = AtmosProfile.PredefinedType(AtmosProfile.NoGaseousAbsorption)</span><br><span class="line"></span><br><span class="line">wavelengths = np.arange(<span class="number">0.3</span>, <span class="number">1.0</span>, <span class="number">0.05</span>)</span><br><span class="line">results = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> wv <span class="keyword">in</span> wavelengths:</span><br><span class="line">    s.wavelength = Wavelength(wv)</span><br><span class="line">    s.run()</span><br><span class="line"></span><br><span class="line">    results.append(&#123;<span class="string">&#x27;wavelength&#x27;</span>: wv,</span><br><span class="line">                   <span class="string">&#x27;rayleigh_refl&#x27;</span>: s.outputs.atmospheric_intrinsic_reflectance&#125;)</span><br><span class="line"></span><br><span class="line">results = pd.DataFrame(results)</span><br><span class="line"></span><br><span class="line">results.plot(x=<span class="string">&#x27;wavelength&#x27;</span>, y=<span class="string">&#x27;rayleigh_refl&#x27;</span>, style=<span class="string">&#x27;x-&#x27;</span>, label=<span class="string">&#x27;Rayleigh Reflectance&#x27;</span>, grid=<span class="literal">True</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Wavelength ($\mu m$)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Rayleigh Reflectance (no units)&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>这个图是</p>
<figure>
<img src="https://blog.rtwilson.com/wp-content/uploads/2019/09/image-1569879583877.png" alt><figcaption>file</figcaption>
</figure>
<p>在这一大块代码中没有什么特别革命性的东西--我们只是结合了我之前演示的代码，然后在各种波长中循环，为每个波长运行模型。</p>
<p>我们存储模型结果的方式值得简单解释一下，因为这是我经常使用的一种模式。每次运行模型，都会有一个新的dict被添加到一个列表中--这个dict有我们感兴趣的各种参数（在这里只是波长）和我们感兴趣的各种结果（在这里只是Rayleigh反射率）的条目。循环结束后，我们可以简单地将这个dict列表传递给pd.DataFrame()，然后得到一个漂亮的pandas DataFrame - 准备好显示、绘制或进一步分析。</p>
<p>其他的一些设置</p>
<p>瑞利反射率将根据视角和太阳角的不同而变化。你可以通过s.geometry = Geometry.User()手动设置，然后设置s.geometry.solar_z, solar_a等。或者你可以通过使用Geometry.User.from_time_and_location()来半自动地设置，它将根据位置和时间自动设置太阳角，并允许你手动设置视图角度。</p>
<p>至于大气压力等等，它实际上是作为设置海拔高度的一部分而配置的。你可以在高度方面设置高度，也可以在压力方面设置高度--见https://py6s.readthedocs.io/en/latest/params.html#Py6S.Altitudes.set_target_pressure，如果你有任何进一步的问题，请随时询问。</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>周大侠
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://lifeodyssey.github.io/posts/514b9dac.html" title="py6s">https://lifeodyssey.github.io/posts/514b9dac.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9lbg=="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Remote-Sensing/" rel="tag"># Remote Sensing</a>
              <a href="/tags/%E5%A4%A7%E6%B0%94%E6%A0%A1%E6%AD%A3/" rel="tag"># 大气校正</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/f157bdd2.html" rel="prev" title="ocean color data download script">
                  <i class="fa fa-chevron-left"></i> ocean color data download script
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/d464ecc8.html" rel="next" title="FY4A数据处理">
                  FY4A数据处理 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2016 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">周大侠</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">248k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">15:01</span>
  </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpZmVvZHlzc2V5" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":"forest","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.4.3/mermaid.min.js","integrity":"sha256-e0o3JYsdjqKajf9eOe22FhioYSz9WofRY4dLKo3F6do="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>




  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
